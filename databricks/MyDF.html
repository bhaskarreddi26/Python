<!DOCTYPE html>
<html>
<head>
  <meta name="databricks-html-version" content="1">
<title>MyDF - Databricks</title>

<meta charset="utf-8">
<meta name="google" content="notranslate">
<meta name="robots" content="nofollow">
<meta http-equiv="Content-Language" content="en">
<meta http-equiv="Content-Type" content="text/html; charset=UTF8">

<link rel="stylesheet" type="text/css" href="https://databricks-prod-cloudfront.cloud.databricks.com/static/bc1c85971ad864da65b19d4f80abe81e111e7bfd8db9cac8f69dc1d94b874689/css/main.css">
<link rel="stylesheet" href="https://databricks-prod-cloudfront.cloud.databricks.com/static/bc1c85971ad864da65b19d4f80abe81e111e7bfd8db9cac8f69dc1d94b874689/css/print.css" media="print">
<link rel="icon" type="image/png" href="https://databricks-prod-cloudfront.cloud.databricks.com/static/bc1c85971ad864da65b19d4f80abe81e111e7bfd8db9cac8f69dc1d94b874689/img/favicon.ico"/>
<script>window.settings = {"enableNotebookNotifications":true,"enableSshKeyUI":false,"defaultInteractivePricePerDBU":0.4,"enableClusterMetricsUI":true,"enableOnDemandClusterType":true,"enableAutoCompleteAsYouType":[],"devTierName":"Community Edition","enableJobsPrefetching":true,"workspaceFeaturedLinks":[{"linkURI":"https://docs.databricks.com/index.html","displayName":"Documentation","icon":"question"},{"linkURI":"https://docs.databricks.com/release-notes/product/index.html","displayName":"Release Notes","icon":"code"},{"linkURI":"https://docs.databricks.com/spark/latest/training/index.html","displayName":"Training & Tutorials","icon":"graduation-cap"}],"enableReservoirTableUI":false,"enableClearStateFeature":true,"dbcForumURL":"http://forums.databricks.com/","enableProtoClusterInfoDeltaPublisher":true,"enableAttachExistingCluster":true,"resetJobListOnConnect":true,"serverlessDefaultSparkVersion":"latest-stable-scala2.11","maxCustomTags":45,"serverlessDefaultMaxWorkers":20,"enableInstanceProfilesUIInJobs":true,"nodeInfo":{"node_types":[{"support_ssh":false,"spark_heap_memory":4800,"instance_type_id":"r3.2xlarge","spark_core_oversubscription_factor":8.0,"node_type_id":"dev-tier-node","description":"Community Optimized","support_cluster_tags":false,"container_memory_mb":6000,"node_instance_type":{"instance_type_id":"r3.2xlarge","provider":"AWS","local_disk_size_gb":160,"compute_units":26.0,"number_of_ips":14,"local_disks":1,"reserved_compute_units":3.64,"gpus":0,"memory_mb":62464,"num_cores":8,"local_disk_type":"AHCI","max_attachable_disks":0,"supported_disk_types":[{"ebs_volume_type":"GENERAL_PURPOSE_SSD"},{"ebs_volume_type":"THROUGHPUT_OPTIMIZED_HDD"}],"reserved_memory_mb":4800},"memory_mb":6144,"is_hidden":false,"category":"Community Edition","num_cores":0.88,"support_port_forwarding":false,"support_ebs_volumes":false,"is_deprecated":false}],"default_node_type_id":"dev-tier-node"},"sqlAclsDisabledMap":{"spark.databricks.acl.enabled":"false","spark.databricks.acl.sqlOnly":"false"},"enableDatabaseSupportClusterChoice":true,"enableClusterAcls":true,"notebookRevisionVisibilityHorizon":999999,"serverlessClusterProductName":"Serverless Pool","showS3TableImportOption":true,"maxEbsVolumesPerInstance":10,"enableRStudioUI":false,"isAdmin":true,"deltaProcessingBatchSize":1000,"timerUpdateQueueLength":100,"sqlAclsEnabledMap":{"spark.databricks.acl.enabled":"true","spark.databricks.acl.sqlOnly":"true"},"enableLargeResultDownload":true,"maxElasticDiskCapacityGB":5000,"serverlessDefaultMinWorkers":2,"zoneInfos":[{"id":"us-west-2c","isDefault":true},{"id":"us-west-2b","isDefault":false},{"id":"us-west-2a","isDefault":false}],"enableCustomSpotPricingUIByTier":false,"serverlessClustersEnabled":false,"enableSentryLogging":false,"enableFindAndReplace":true,"disallowUrlImportExceptFromDocs":false,"defaultStandardClusterModel":{"cluster_name":"","node_type_id":"dev-tier-node","spark_version":"3.5.x-scala2.11","num_workers":0,"aws_attributes":{"first_on_demand":0,"availability":"ON_DEMAND","zone_id":"us-west-2c","spot_bid_price_percent":100},"autotermination_minutes":120,"default_tags":{"Vendor":"Databricks","Creator":"bhaskar.reddi@gmail.com","ClusterName":null,"ClusterId":"<Generated after creation>"}},"enableEBSVolumesUIForJobs":true,"enablePublishNotebooks":true,"enableBitbucketCloud":true,"createTableInNotebookS3Link":{"url":"https://docs.databricks.com/_static/notebooks/data-import/s3.html","displayName":"S3","workspaceFileName":"S3 Example"},"sanitizeHtmlResult":true,"enableJobAclsConfig":false,"enableFullTextSearch":false,"enableElasticSparkUI":false,"enableNewClustersCreate":true,"clusters":true,"allowRunOnPendingClusters":true,"useAutoscalingByDefault":false,"enableAzureToolbar":false,"fileStoreBase":"FileStore","enableEmailInAzure":false,"enableRLibraries":true,"enableTableAclsConfig":false,"enableSshKeyUIInJobs":true,"enableDetachAndAttachSubMenu":true,"configurableSparkOptionsSpec":[{"keyPattern":"spark\\.kryo(\\.[^\\.]+)+","valuePattern":".*","keyPatternDisplay":"spark.kryo.*","valuePatternDisplay":"*","description":"Configuration options for Kryo serialization"},{"keyPattern":"spark\\.io\\.compression\\.codec","valuePattern":"(lzf|snappy|org\\.apache\\.spark\\.io\\.LZFCompressionCodec|org\\.apache\\.spark\\.io\\.SnappyCompressionCodec)","keyPatternDisplay":"spark.io.compression.codec","valuePatternDisplay":"snappy|lzf","description":"The codec used to compress internal data such as RDD partitions, broadcast variables and shuffle outputs."},{"keyPattern":"spark\\.serializer","valuePattern":"(org\\.apache\\.spark\\.serializer\\.JavaSerializer|org\\.apache\\.spark\\.serializer\\.KryoSerializer)","keyPatternDisplay":"spark.serializer","valuePatternDisplay":"org.apache.spark.serializer.JavaSerializer|org.apache.spark.serializer.KryoSerializer","description":"Class to use for serializing objects that will be sent over the network or need to be cached in serialized form."},{"keyPattern":"spark\\.rdd\\.compress","valuePattern":"(true|false)","keyPatternDisplay":"spark.rdd.compress","valuePatternDisplay":"true|false","description":"Whether to compress serialized RDD partitions (e.g. for StorageLevel.MEMORY_ONLY_SER). Can save substantial space at the cost of some extra CPU time."},{"keyPattern":"spark\\.speculation","valuePattern":"(true|false)","keyPatternDisplay":"spark.speculation","valuePatternDisplay":"true|false","description":"Whether to use speculation (recommended off for streaming)"},{"keyPattern":"spark\\.es(\\.[^\\.]+)+","valuePattern":".*","keyPatternDisplay":"spark.es.*","valuePatternDisplay":"*","description":"Configuration options for ElasticSearch"},{"keyPattern":"es(\\.([^\\.]+))+","valuePattern":".*","keyPatternDisplay":"es.*","valuePatternDisplay":"*","description":"Configuration options for ElasticSearch"},{"keyPattern":"spark\\.(storage|shuffle)\\.memoryFraction","valuePattern":"0?\\.0*([1-9])([0-9])*","keyPatternDisplay":"spark.(storage|shuffle).memoryFraction","valuePatternDisplay":"(0.0,1.0)","description":"Fraction of Java heap to use for Spark's shuffle or storage"},{"keyPattern":"spark\\.streaming\\.backpressure\\.enabled","valuePattern":"(true|false)","keyPatternDisplay":"spark.streaming.backpressure.enabled","valuePatternDisplay":"true|false","description":"Enables or disables Spark Streaming's internal backpressure mechanism (since 1.5). This enables the Spark Streaming to control the receiving rate based on the current batch scheduling delays and processing times so that the system receives only as fast as the system can process. Internally, this dynamically sets the maximum receiving rate of receivers. This rate is upper bounded by the values `spark.streaming.receiver.maxRate` and `spark.streaming.kafka.maxRatePerPartition` if they are set."},{"keyPattern":"spark\\.streaming\\.receiver\\.maxRate","valuePattern":"^([0-9]{1,})$","keyPatternDisplay":"spark.streaming.receiver.maxRate","valuePatternDisplay":"numeric","description":"Maximum rate (number of records per second) at which each receiver will receive data. Effectively, each stream will consume at most this number of records per second. Setting this configuration to 0 or a negative number will put no limit on the rate. See the deployment guide in the Spark Streaming programing guide for mode details."},{"keyPattern":"spark\\.streaming\\.kafka\\.maxRatePerPartition","valuePattern":"^([0-9]{1,})$","keyPatternDisplay":"spark.streaming.kafka.maxRatePerPartition","valuePatternDisplay":"numeric","description":"Maximum rate (number of records per second) at which data will be read from each Kafka partition when using the Kafka direct stream API introduced in Spark 1.3. See the Kafka Integration guide for more details."},{"keyPattern":"spark\\.streaming\\.kafka\\.maxRetries","valuePattern":"^([0-9]{1,})$","keyPatternDisplay":"spark.streaming.kafka.maxRetries","valuePatternDisplay":"numeric","description":"Maximum number of consecutive retries the driver will make in order to find the latest offsets on the leader of each partition (a default value of 1 means that the driver will make a maximum of 2 attempts). Only applies to the Kafka direct stream API introduced in Spark 1.3."},{"keyPattern":"spark\\.streaming\\.ui\\.retainedBatches","valuePattern":"^([0-9]{1,})$","keyPatternDisplay":"spark.streaming.ui.retainedBatches","valuePatternDisplay":"numeric","description":"How many batches the Spark Streaming UI and status APIs remember before garbage collecting."}],"enableReactNotebookComments":true,"enableAdminPasswordReset":false,"checkBeforeAddingAadUser":false,"enableResetPassword":true,"maxClusterTagValueLength":255,"enableJobsSparkUpgrade":true,"createTableInNotebookDBFSLink":{"url":"https://docs.databricks.com/_static/notebooks/data-import/dbfs.html","displayName":"DBFS","workspaceFileName":"DBFS Example"},"perClusterAutoterminationEnabled":false,"enableNotebookCommandNumbers":true,"allowStyleInSanitizedHtml":true,"sparkVersions":[{"key":"1.6.3-db2-hadoop2-scala2.10","displayName":"Spark 1.6.3-db2 (Hadoop 2, Scala 2.10)","packageLabel":"spark-image-aba860a0ffce4f3471fb14aefdcb1d768ac66a53a5ad884c48745ef98aeb9d67","upgradable":true,"deprecated":false,"customerVisible":true,"capabilities":[]},{"key":"3.3.x-gpu-scala2.11","displayName":"3.3 (includes Apache Spark 2.2.0, GPU, Scala 2.11)","packageLabel":"spark-image-86b4917bb6586289ca64e65f64fd23678c297274be6cd6aa6aa01d7b91fed29c","upgradable":true,"deprecated":false,"customerVisible":true,"capabilities":[]},{"key":"2.1.1-db5-scala2.11","displayName":"Spark 2.1.1-db5 (Scala 2.11)","packageLabel":"spark-image-08d9fc1551087e0876236f19640c4a83116b1649f15137427d21c9056656e80e","upgradable":true,"deprecated":false,"customerVisible":false,"capabilities":["SUPPORTS_END_TO_END_ENCRYPTION"]},{"key":"1.6.x-ubuntu15.10","displayName":"Spark 1.6.x (Hadoop 1)","packageLabel":"spark-image-8cea23fb9094e174bf5815d79009f4a8e383eb86cf2909cf6c6434ed8da2a16a","upgradable":true,"deprecated":false,"customerVisible":false,"capabilities":[]},{"key":"3.3.x-scala2.10","displayName":"3.3 (includes Apache Spark 2.2.0, Scala 2.10)","packageLabel":"spark-image-d7df74e188103a4093ff4467dbf0d32886366c984097f6997e0cd87d0f6b2fa5","upgradable":true,"deprecated":false,"customerVisible":true,"capabilities":[]},{"key":"1.4.x-ubuntu15.10","displayName":"Spark 1.4.1 (Hadoop 1, deprecated)","packageLabel":"spark-image-f710650fb8aaade8e4e812368ea87c45cd8cd0b5e6894ca6c94f3354e8daa6dc","upgradable":true,"deprecated":false,"customerVisible":false,"capabilities":[]},{"key":"2.2.x-scala2.11","displayName":"3.0 (includes Apache Spark 2.2.0, Scala 2.11)","packageLabel":"spark-image-67ab3a06d1e83d5b60df7063245eb419a2e9fe329aeeb7e7d9713332c669bb17","upgradable":true,"deprecated":false,"customerVisible":false,"capabilities":["SUPPORTS_END_TO_END_ENCRYPTION"]},{"key":"2.1.1-db6-scala2.10","displayName":"Spark 2.1.1-db6 (Scala 2.10)","packageLabel":"spark-image-177f3f02a6a3432d30068332dc857b9161345bdd2ee8a2d2de05bb05cb4b0f4c","upgradable":true,"deprecated":false,"customerVisible":true,"capabilities":["SUPPORTS_END_TO_END_ENCRYPTION"]},{"key":"2.1.0-db2-scala2.11","displayName":"Spark 2.1.0-db2 (Scala 2.11)","packageLabel":"spark-image-267c4490a3ab8a39acdbbd9f1d36f6decdecebf013e30dd677faff50f1d9cf8b","upgradable":true,"deprecated":false,"customerVisible":false,"capabilities":[]},{"key":"4.0.x-scala2.11","displayName":"4.0 beta (Scala 2.11)","packageLabel":"spark-image-806e2bf6ff456b3832d8f4a8da22564cd3dcb6bbb7da2a910fbdc95597ac2fe6","upgradable":true,"deprecated":false,"customerVisible":true,"capabilities":["SUPPORTS_END_TO_END_ENCRYPTION","SUPPORTS_TABLE_ACLS"]},{"key":"2.1.x-gpu-scala2.11","displayName":"Spark 2.1 (Auto-updating, GPU, Scala 2.11 experimental)","packageLabel":"spark-image-d613235f93e0f29838beb2079a958c02a192ed67a502192bc67a8a5f2fb37f35","upgradable":true,"deprecated":false,"customerVisible":true,"capabilities":[]},{"key":"2.0.0-ubuntu15.10-scala2.10","displayName":"Spark 2.0.0 (Scala 2.10)","packageLabel":"spark-image-073c1b52ace74f251fae2680624a0d8d184a8b57096d1c21c5ce56c29be6a37a","upgradable":true,"deprecated":true,"customerVisible":false,"capabilities":[]},{"key":"latest-stable-gpu-scala2.11","displayName":"Latest stable (3.5 LTS, GPU, Scala 2.11)","packageLabel":"spark-image-71e2fd18fdbbb732d6adec03e171846687b6ec85a572e5931e8a9ed9b62e7c32","upgradable":true,"deprecated":false,"customerVisible":false,"capabilities":[]},{"key":"3.4.x-scala2.11","displayName":"3.4 (includes Apache Spark 2.2.0, Scala 2.11)","packageLabel":"spark-image-a5615cb1adf0d2305f2b93188c6720174ec3e782d100fcbfa96ff870392861df","upgradable":true,"deprecated":false,"customerVisible":true,"capabilities":["SUPPORTS_END_TO_END_ENCRYPTION"]},{"key":"2.0.2-db3-scala2.10","displayName":"Spark 2.0.2-db3 (Scala 2.10)","packageLabel":"spark-image-584091dedb690de20e8cf22d9e02fdcce1281edda99eedb441a418d50e28088f","upgradable":true,"deprecated":false,"customerVisible":false,"capabilities":[]},{"key":"3.2.x-scala2.10","displayName":"3.2 (includes Apache Spark 2.2.0, Scala 2.10)","packageLabel":"spark-image-557788bea0eea16bbf7a8ba13ace07e64dd7fc86270bd5cea086097fe886431f","upgradable":true,"deprecated":false,"customerVisible":true,"capabilities":[]},{"key":"latest-experimental-scala2.10","displayName":"Latest experimental (Scala 2.10)","packageLabel":"spark-image-ec81b6840af02ee2321dd8dfe2587437bbcddf024d4ae287f326a98fac406a6c","upgradable":true,"deprecated":false,"customerVisible":false,"capabilities":["SUPPORTS_END_TO_END_ENCRYPTION"]},{"key":"4.0.x-gpu-scala2.11","displayName":"4.0 beta (GPU, Scala 2.11)","packageLabel":"spark-image-26215c96fc1e7eb1a4657d345beb878d79cea7de1363a3ea12a2904dd17eaa18","upgradable":true,"deprecated":false,"customerVisible":true,"capabilities":[]},{"key":"2.1.0-db1-scala2.11","displayName":"Spark 2.1.0-db1 (Scala 2.11)","packageLabel":"spark-image-e8ad5b72cf0f899dcf2b4720c1f572ab0e87a311d6113b943b4e1d4a7edb77eb","upgradable":true,"deprecated":true,"customerVisible":false,"capabilities":[]},{"key":"2.1.1-db4-scala2.11","displayName":"Spark 2.1.1-db4 (Scala 2.11)","packageLabel":"spark-image-52bca0ca866e3f4243d3820a783abf3b9b3b553edf234abef14b892657ceaca9","upgradable":true,"deprecated":false,"customerVisible":true,"capabilities":["SUPPORTS_END_TO_END_ENCRYPTION"]},{"key":"latest-rc-scala2.11","displayName":"Latest RC (4.0, Scala 2.11)","packageLabel":"spark-image-806e2bf6ff456b3832d8f4a8da22564cd3dcb6bbb7da2a910fbdc95597ac2fe6","upgradable":true,"deprecated":false,"customerVisible":false,"capabilities":["SUPPORTS_END_TO_END_ENCRYPTION","SUPPORTS_TABLE_ACLS"]},{"key":"latest-stable-scala2.11","displayName":"Latest stable (3.5 LTS, Scala 2.11)","packageLabel":"spark-image-4f5f9fb3a7177ac43f84a20f819e8ad76833e356707ed0b79812a2f837ac0a06","upgradable":true,"deprecated":false,"customerVisible":false,"capabilities":["SUPPORTS_END_TO_END_ENCRYPTION","SUPPORTS_TABLE_ACLS"]},{"key":"2.1.0-db2-scala2.10","displayName":"Spark 2.1.0-db2 (Scala 2.10)","packageLabel":"spark-image-a2ca4f6b58c95f78dca91b1340305ab3fe32673bd894da2fa8e1dc8a9f8d0478","upgradable":true,"deprecated":false,"customerVisible":false,"capabilities":[]},{"key":"1.6.x-ubuntu15.10-hadoop1","displayName":"Spark 1.6.x (Hadoop 1)","packageLabel":"spark-image-8cea23fb9094e174bf5815d79009f4a8e383eb86cf2909cf6c6434ed8da2a16a","upgradable":true,"deprecated":false,"customerVisible":false,"capabilities":[]},{"key":"2.0.2-db4-scala2.11","displayName":"Spark 2.0.2-db4 (Scala 2.11)","packageLabel":"spark-image-7dbc7583e8271765b8a1508cb9e832768e35489bbde2c4c790bc6766aee2fd7f","upgradable":true,"deprecated":false,"customerVisible":true,"capabilities":[]},{"key":"1.6.1-ubuntu15.10-hadoop1","displayName":"Spark 1.6.1 (Hadoop 1)","packageLabel":"spark-image-21d1cac181b7b8856dd1b4214a3a734f95b5289089349db9d9c926cb87d843db","upgradable":true,"deprecated":true,"customerVisible":false,"capabilities":[]},{"key":"2.0.x-gpu-scala2.11","displayName":"Spark 2.0 (Auto-updating, GPU, Scala 2.11 experimental)","packageLabel":"spark-image-968b89f1d0ec32e1ee4dacd04838cae25ef44370a441224177a37980d539d83a","upgradable":true,"deprecated":false,"customerVisible":true,"capabilities":[]},{"key":"1.6.2-ubuntu15.10-hadoop1","displayName":"Spark 1.6.2 (Hadoop 1)","packageLabel":"spark-image-8cea23fb9094e174bf5815d79009f4a8e383eb86cf2909cf6c6434ed8da2a16a","upgradable":true,"deprecated":true,"customerVisible":false,"capabilities":[]},{"key":"next-major-version-scala2.11","displayName":"Next major version (4.0 snapshot, Scala 2.11)","packageLabel":"spark-image-d6dcf1e5cebb0329df081e7ecd2f3dc93ab96106049cdc80979bb27197d240c1","upgradable":true,"deprecated":false,"customerVisible":false,"capabilities":["SUPPORTS_END_TO_END_ENCRYPTION","SUPPORTS_TABLE_ACLS"]},{"key":"1.6.3-db1-hadoop2-scala2.10","displayName":"Spark 1.6.3-db1 (Hadoop 2, Scala 2.10)","packageLabel":"spark-image-eaa8d9b990015a14e032fb2e2e15be0b8d5af9627cd01d855df728b67969d5d9","upgradable":true,"deprecated":false,"customerVisible":false,"capabilities":[]},{"key":"1.6.3-db2-hadoop1-scala2.10","displayName":"Spark 1.6.3-db2 (Hadoop 1, Scala 2.10)","packageLabel":"spark-image-14112ea0645bea94333a571a150819ce85573cf5541167d905b7e6588645cf3b","upgradable":true,"deprecated":false,"customerVisible":true,"capabilities":[]},{"key":"3.5.x-scala2.10","displayName":"3.5 LTS (includes Apache Spark 2.2.1, Scala 2.10)","packageLabel":"spark-image-fff24a42ff1d42290166196e45860557b34d4af8a5e6e794857bd999865393fb","upgradable":true,"deprecated":false,"customerVisible":true,"capabilities":["SUPPORTS_END_TO_END_ENCRYPTION","SUPPORTS_TABLE_ACLS"]},{"key":"1.6.2-ubuntu15.10-hadoop2","displayName":"Spark 1.6.2 (Hadoop 2)","packageLabel":"spark-image-161245e66d887cd775e23286a54bab0b146143e1289f25bd1732beac454a1561","upgradable":true,"deprecated":true,"customerVisible":false,"capabilities":[]},{"key":"1.6.1-ubuntu15.10-hadoop2","displayName":"Spark 1.6.1 (Hadoop 2)","packageLabel":"spark-image-4cafdf8bc6cba8edad12f441e3b3f0a8ea27da35c896bc8290e16b41fd15496a","upgradable":true,"deprecated":true,"customerVisible":false,"capabilities":[]},{"key":"2.0.2-db2-scala2.10","displayName":"Spark 2.0.2-db2 (Scala 2.10)","packageLabel":"spark-image-36d48f22cca7a907538e07df71847dd22aaf84a852c2eeea2dcefe24c681602f","upgradable":true,"deprecated":true,"customerVisible":false,"capabilities":[]},{"key":"2.0.x-ubuntu15.10-scala2.11","displayName":"Spark 2.0 (Ubuntu 15.10, Scala 2.11, deprecated)","packageLabel":"spark-image-8e1c50d626a52eac5a6c8129e09ae206ba9890f4523775f77af4ad6d99a64c44","upgradable":true,"deprecated":true,"customerVisible":false,"capabilities":[]},{"key":"2.0.x-scala2.10","displayName":"Spark 2.0 (Auto-updating, Scala 2.10)","packageLabel":"spark-image-859e88079f97f58d50e25163b39a1943d1eeac0b6939c5a65faba986477e311a","upgradable":true,"deprecated":false,"customerVisible":true,"capabilities":[]},{"key":"2.1.1-db4-scala2.10","displayName":"Spark 2.1.1-db4 (Scala 2.10)","packageLabel":"spark-image-c7c0224de396cd1563addc1ae4bca6ba823780b6babe6c3729ddf73008f29ba4","upgradable":true,"deprecated":false,"customerVisible":true,"capabilities":["SUPPORTS_END_TO_END_ENCRYPTION"]},{"key":"latest-rc-scala2.10","displayName":"Latest RC (Scala 2.10)","packageLabel":"spark-image-ec81b6840af02ee2321dd8dfe2587437bbcddf024d4ae287f326a98fac406a6c","upgradable":true,"deprecated":false,"customerVisible":false,"capabilities":["SUPPORTS_END_TO_END_ENCRYPTION"]},{"key":"latest-stable-scala2.10","displayName":"Latest stable (3.5 LTS, Scala 2.10)","packageLabel":"spark-image-fff24a42ff1d42290166196e45860557b34d4af8a5e6e794857bd999865393fb","upgradable":true,"deprecated":false,"customerVisible":false,"capabilities":["SUPPORTS_END_TO_END_ENCRYPTION","SUPPORTS_TABLE_ACLS"]},{"key":"2.0.2-db1-scala2.11","displayName":"Spark 2.0.2-db1 (Scala 2.11)","packageLabel":"spark-image-c2d623f03dd44097493c01aa54a941fc31978ebe6d759b36c75b716b2ff6ab9c","upgradable":true,"deprecated":true,"customerVisible":false,"capabilities":[]},{"key":"2.0.2-db4-scala2.10","displayName":"Spark 2.0.2-db4 (Scala 2.10)","packageLabel":"spark-image-859e88079f97f58d50e25163b39a1943d1eeac0b6939c5a65faba986477e311a","upgradable":true,"deprecated":false,"customerVisible":true,"capabilities":[]},{"key":"2.1.1-db5-scala2.10","displayName":"Spark 2.1.1-db5 (Scala 2.10)","packageLabel":"spark-image-74133df2c13950431298d1cab3e865c191d83ac33648a8590495c52fc644c654","upgradable":true,"deprecated":false,"customerVisible":false,"capabilities":["SUPPORTS_END_TO_END_ENCRYPTION"]},{"key":"3.4.x-gpu-scala2.11","displayName":"3.4 (includes Apache Spark 2.2.0, GPU, Scala 2.11)","packageLabel":"spark-image-613a129fcaa93423a4de06407c9f93e341ed5c6b02d69179d2703c8bb47e2b99","upgradable":true,"deprecated":false,"customerVisible":true,"capabilities":[]},{"key":"1.5.x-ubuntu15.10","displayName":"Spark 1.5.2 (Hadoop 1, deprecated)","packageLabel":"spark-image-c9d2a8abf41f157a4acc6d52bc721090346f6fea2de356f3a66e388f54481698","upgradable":true,"deprecated":false,"customerVisible":false,"capabilities":[]},{"key":"latest-experimental-gpu-scala2.11","displayName":"Latest experimental (4.1 snapshot, GPU, Scala 2.11)","packageLabel":"spark-image-dd98d38d8ee4c19720515230e2b52f26f492d0c94b32c9406f1e7a3f259c1779","upgradable":true,"deprecated":false,"customerVisible":false,"capabilities":[]},{"key":"2.2.x-scala2.10","displayName":"3.0 (includes Apache Spark 2.2.0, Scala 2.10)","packageLabel":"spark-image-d549f2d4a523994ecdf37e531b51d5ec7d8be51534bb0ca5322eaad28ba8f557","upgradable":true,"deprecated":false,"customerVisible":false,"capabilities":["SUPPORTS_END_TO_END_ENCRYPTION"]},{"key":"3.0.x-scala2.11","displayName":"3.0 (includes Apache Spark 2.2.0, Scala 2.11)","packageLabel":"spark-image-67ab3a06d1e83d5b60df7063245eb419a2e9fe329aeeb7e7d9713332c669bb17","upgradable":true,"deprecated":false,"customerVisible":false,"capabilities":["SUPPORTS_END_TO_END_ENCRYPTION"]},{"key":"2.0.x-scala2.11","displayName":"Spark 2.0 (Auto-updating, Scala 2.11)","packageLabel":"spark-image-7dbc7583e8271765b8a1508cb9e832768e35489bbde2c4c790bc6766aee2fd7f","upgradable":true,"deprecated":false,"customerVisible":true,"capabilities":[]},{"key":"2.1.x-scala2.10","displayName":"Spark 2.1 (Auto-updating, Scala 2.10)","packageLabel":"spark-image-177f3f02a6a3432d30068332dc857b9161345bdd2ee8a2d2de05bb05cb4b0f4c","upgradable":true,"deprecated":false,"customerVisible":true,"capabilities":["SUPPORTS_END_TO_END_ENCRYPTION"]},{"key":"3.1.x-scala2.11","displayName":"3.1 (includes Apache Spark 2.2.0, Scala 2.11)","packageLabel":"spark-image-241fa8b78ee6343242b1756b18076270894385ff40a81172a6fb5eadf66155d3","upgradable":true,"deprecated":false,"customerVisible":false,"capabilities":[]},{"key":"2.1.0-db3-scala2.10","displayName":"Spark 2.1.0-db3 (Scala 2.10)","packageLabel":"spark-image-25a17d070af155f10c4232dcc6248e36a2eb48c24f8d4fc00f34041b86bd1626","upgradable":true,"deprecated":false,"customerVisible":false,"capabilities":["SUPPORTS_END_TO_END_ENCRYPTION"]},{"key":"2.0.2-db2-scala2.11","displayName":"Spark 2.0.2-db2 (Scala 2.11)","packageLabel":"spark-image-4fa852ba378e97815083b96c9cada7b962a513ec23554a5fc849f7f1dd8c065a","upgradable":true,"deprecated":true,"customerVisible":false,"capabilities":[]},{"key":"3.1.x-scala2.10","displayName":"3.1 (includes Apache Spark 2.2.0, Scala 2.10)","packageLabel":"spark-image-7efac6b9a8f2da59cb4f6d0caac46cfcb3f1ebf64c8073498c42d0360f846714","upgradable":true,"deprecated":false,"customerVisible":false,"capabilities":[]},{"key":"3.3.x-scala2.11","displayName":"3.3 (includes Apache Spark 2.2.0, Scala 2.11)","packageLabel":"spark-image-0badc3d8dfc8cddd55795d02c0b31c76330cfe687d588414f91278197fbc9416","upgradable":true,"deprecated":false,"customerVisible":true,"capabilities":[]},{"key":"next-major-version-gpu-scala2.11","displayName":"Next major version (4.0 snapshot, GPU, Scala 2.11)","packageLabel":"spark-image-fe0b3ec2ae0caa7f2187ebf3a63f7003c29e7d4902f57140fca733452006f27d","upgradable":true,"deprecated":false,"customerVisible":false,"capabilities":[]},{"key":"3.5.x-gpu-scala2.11","displayName":"3.5 LTS (includes Apache Spark 2.2.1, GPU, Scala 2.11)","packageLabel":"spark-image-71e2fd18fdbbb732d6adec03e171846687b6ec85a572e5931e8a9ed9b62e7c32","upgradable":true,"deprecated":false,"customerVisible":true,"capabilities":[]},{"key":"1.3.x-ubuntu15.10","displayName":"Spark 1.3.0 (Hadoop 1, deprecated)","packageLabel":"spark-image-40d2842670bc3dc178b14042501847d76171437ccf70613fa397a7a24c48b912","upgradable":true,"deprecated":false,"customerVisible":false,"capabilities":[]},{"key":"2.0.1-db1-scala2.11","displayName":"Spark 2.0.1-db1 (Scala 2.11)","packageLabel":"spark-image-10ab19f634bbfdb860446c326a9f76dc25bfa87de6403b980566279142a289ea","upgradable":true,"deprecated":true,"customerVisible":false,"capabilities":[]},{"key":"2.0.2-db3-scala2.11","displayName":"Spark 2.0.2-db3 (Scala 2.11)","packageLabel":"spark-image-7fd7aaa89d55692e429115ae7eac3b1a1dc4de705d50510995f34306b39c2397","upgradable":true,"deprecated":false,"customerVisible":false,"capabilities":[]},{"key":"2.1.1-db6-scala2.11","displayName":"Spark 2.1.1-db6 (Scala 2.11)","packageLabel":"spark-image-fdad9ef557700d7a8b6bde86feccbcc3c71d1acdc838b0fd299bd19956b1076e","upgradable":true,"deprecated":false,"customerVisible":true,"capabilities":["SUPPORTS_END_TO_END_ENCRYPTION"]},{"key":"1.6.3-db1-hadoop1-scala2.10","displayName":"Spark 1.6.3-db1 (Hadoop 1, Scala 2.10)","packageLabel":"spark-image-d50af1032799546b8ccbeeb76889a20c819ebc2a0e68ea20920cb30d3895d3ae","upgradable":true,"deprecated":false,"customerVisible":false,"capabilities":[]},{"key":"2.0.2-db1-scala2.10","displayName":"Spark 2.0.2-db1 (Scala 2.10)","packageLabel":"spark-image-654bdd6e9bad70079491987d853b4b7abf3b736fff099701501acaabe0e75c41","upgradable":true,"deprecated":true,"customerVisible":false,"capabilities":[]},{"key":"2.0.x-ubuntu15.10","displayName":"Spark 2.0 (Ubuntu 15.10, Scala 2.10, deprecated)","packageLabel":"spark-image-a659f3909d51b38d297b20532fc807ecf708cfb7440ce9b090c406ab0c1e4b7e","upgradable":true,"deprecated":true,"customerVisible":false,"capabilities":[]},{"key":"3.5.x-scala2.11","displayName":"3.5 LTS (includes Apache Spark 2.2.1, Scala 2.11)","packageLabel":"spark-image-4f5f9fb3a7177ac43f84a20f819e8ad76833e356707ed0b79812a2f837ac0a06","upgradable":true,"deprecated":false,"customerVisible":true,"capabilities":["SUPPORTS_END_TO_END_ENCRYPTION","SUPPORTS_TABLE_ACLS"]},{"key":"latest-experimental-scala2.11","displayName":"Latest experimental (4.1 snapshot, Scala 2.11)","packageLabel":"spark-image-98ea8c54b4bd5547e01ab9e32730370749d1f5a25d92904e134b74cc4931e3ef","upgradable":true,"deprecated":false,"customerVisible":false,"capabilities":["SUPPORTS_END_TO_END_ENCRYPTION","SUPPORTS_TABLE_ACLS"]},{"key":"3.2.x-scala2.11","displayName":"3.2 (includes Apache Spark 2.2.0, Scala 2.11)","packageLabel":"spark-image-5537926238bc55cb6cd76ee0f0789511349abead3781c4780721a845f34b5d4e","upgradable":true,"deprecated":false,"customerVisible":true,"capabilities":[]},{"key":"2.0.1-db1-scala2.10","displayName":"Spark 2.0.1-db1 (Scala 2.10)","packageLabel":"spark-image-5a13c2db3091986a4e7363006cc185c5b1108c7761ef5d0218506cf2e6643840","upgradable":true,"deprecated":true,"customerVisible":false,"capabilities":[]},{"key":"2.1.x-scala2.11","displayName":"Spark 2.1 (Auto-updating, Scala 2.11)","packageLabel":"spark-image-fdad9ef557700d7a8b6bde86feccbcc3c71d1acdc838b0fd299bd19956b1076e","upgradable":true,"deprecated":false,"customerVisible":true,"capabilities":["SUPPORTS_END_TO_END_ENCRYPTION"]},{"key":"2.1.0-db1-scala2.10","displayName":"Spark 2.1.0-db1 (Scala 2.10)","packageLabel":"spark-image-f0ab82a5deb7908e0d159e9af066ba05fb56e1edb35bdad41b7ad2fd62a9b546","upgradable":true,"deprecated":true,"customerVisible":false,"capabilities":[]},{"key":"3.0.x-scala2.10","displayName":"3.0 (includes Apache Spark 2.2.0, Scala 2.10)","packageLabel":"spark-image-d549f2d4a523994ecdf37e531b51d5ec7d8be51534bb0ca5322eaad28ba8f557","upgradable":true,"deprecated":false,"customerVisible":false,"capabilities":["SUPPORTS_END_TO_END_ENCRYPTION"]},{"key":"1.6.0-ubuntu15.10","displayName":"Spark 1.6.0 (Hadoop 1)","packageLabel":"spark-image-10ef758029b8c7e19cd7f4fb52fff9180d75db92ca071bd94c47f3c1171a7cb5","upgradable":true,"deprecated":true,"customerVisible":false,"capabilities":[]},{"key":"1.6.x-ubuntu15.10-hadoop2","displayName":"Spark 1.6.x (Hadoop 2)","packageLabel":"spark-image-161245e66d887cd775e23286a54bab0b146143e1289f25bd1732beac454a1561","upgradable":true,"deprecated":false,"customerVisible":false,"capabilities":[]},{"key":"2.0.0-ubuntu15.10-scala2.11","displayName":"Spark 2.0.0 (Scala 2.11)","packageLabel":"spark-image-b4ec141e751f201399f8358a82efee202560f7ed05e1a04a2ae8778f6324b909","upgradable":true,"deprecated":true,"customerVisible":false,"capabilities":[]},{"key":"2.1.0-db3-scala2.11","displayName":"Spark 2.1.0-db3 (Scala 2.11)","packageLabel":"spark-image-ccbc6b73f158e2001fc1fb8c827bfdde425d8bd6d65cb7b3269784c28bb72c16","upgradable":true,"deprecated":false,"customerVisible":false,"capabilities":["SUPPORTS_END_TO_END_ENCRYPTION"]},{"key":"latest-rc-gpu-scala2.11","displayName":"Latest RC (4.0 GPU, Scala 2.11)","packageLabel":"spark-image-26215c96fc1e7eb1a4657d345beb878d79cea7de1363a3ea12a2904dd17eaa18","upgradable":true,"deprecated":false,"customerVisible":false,"capabilities":[]},{"key":"3.4.x-scala2.10","displayName":"3.4 (includes Apache Spark 2.2.0, Scala 2.10)","packageLabel":"spark-image-b768d65de82a89fbfabff8ec1d2f279ced527c0ec05e83c3ae0c206d2e97edc0","upgradable":true,"deprecated":false,"customerVisible":true,"capabilities":["SUPPORTS_END_TO_END_ENCRYPTION"]}],"enablePresentationMode":false,"enableClearStateAndRunAll":true,"enableTableAclsByTier":false,"enableRestrictedClusterCreation":true,"enableFeedback":true,"enableClusterAutoScaling":false,"enableUserVisibleDefaultTags":true,"defaultNumWorkers":0,"serverContinuationTimeoutMillis":10000,"jobsUnreachableThresholdMillis":60000,"driverStderrFilePrefix":"stderr","enableNotebookRefresh":false,"createTableInNotebookImportedFileLink":{"url":"https://docs.databricks.com/_static/notebooks/data-import/imported-file.html","displayName":"Imported File","workspaceFileName":"Imported File Example"},"accountsOwnerUrl":"https://accounts.cloud.databricks.com/registration.html#login","tableAclsDisabledMap":{"spark.databricks.acl.dfAclsEnabled":"false"},"driverStdoutFilePrefix":"stdout","showDbuPricing":true,"databricksDocsBaseHostname":"docs.databricks.com","defaultNodeTypeToPricingUnitsMap":{"r3.2xlarge":2,"i3.4xlarge":4,"class-node":1,"m4.2xlarge":1.5,"r4.xlarge":1,"m4.4xlarge":3,"Standard_DS5_v2":3,"Standard_D2s_v3":0.5,"Standard_DS14":4,"r4.16xlarge":16,"Standard_DS11":0.5,"Standard_D64s_v3":12,"p2.8xlarge":16,"m4.10xlarge":8,"Standard_D8s_v3":1.5,"Standard_E32s_v3":8,"Standard_DS3":0.75,"Standard_DS2_v2":0.5,"r3.8xlarge":8,"r4.4xlarge":4,"dev-tier-node":1,"Standard_L8s":2,"Standard_E4s_v3":1,"Standard_D3_v2":0.75,"Standard_DS15_v2":5,"Standard_D16s_v3":3,"Standard_D5_v2":3,"Standard_E8s_v3":2,"c3.8xlarge":4,"Standard_E2s_v3":0.5,"Standard_DS3_v2":0.75,"r3.4xlarge":4,"Standard_DS4":1.5,"i2.4xlarge":6,"m4.xlarge":0.75,"r4.8xlarge":8,"Standard_H16":4,"Standard_DS14_v2":4,"r4.large":0.5,"Standard_DS12":1,"development-node":1,"i2.2xlarge":3,"g2.8xlarge":6,"i3.large":0.75,"memory-optimized":1,"m4.large":0.4,"Standard_F4s":0.5,"p2.16xlarge":24,"i3.8xlarge":8,"Standard_D32s_v3":6,"i3.16xlarge":16,"Standard_DS12_v2":1,"Standard_L32s":8,"Standard_D4s_v3":0.75,"Standard_DS13":2,"Standard_DS11_v2":0.5,"Standard_DS13_v2":2,"c3.2xlarge":1,"Standard_L4s":1,"Standard_F16s":2,"c4.2xlarge":1,"Standard_L16s":4,"i2.xlarge":1.5,"Standard_DS2":0.5,"compute-optimized":1,"c4.4xlarge":2,"Standard_D2_v2":0.5,"i3.2xlarge":2,"Standard_E16s_v3":4,"Standard_F8s":1,"c3.4xlarge":2,"g2.2xlarge":1.5,"p2.xlarge":2,"m4.16xlarge":12,"Standard_DS4_v2":1.5,"c4.8xlarge":4,"i3.xlarge":1,"r3.xlarge":1,"r4.2xlarge":2,"i2.8xlarge":12},"tableFilesBaseFolder":"/tables","enableSparkDocsSearch":true,"sparkHistoryServerEnabled":true,"enableClusterAppsUIOnServerless":false,"enableEBSVolumesUI":false,"homePageWelcomeMessage":"Welcome to ","metastoreServiceRowLimit":1000000,"enableIPythonImportExport":true,"enableClusterTagsUIForJobs":true,"enableClusterTagsUI":false,"enableNotebookHistoryDiffing":true,"branch":"2.64.930","accountsLimit":3,"enableSparkEnvironmentVariables":true,"enableX509Authentication":false,"useAADLogin":false,"enableStructuredStreamingNbOptimizations":true,"enableNotebookGitBranching":true,"local":false,"enableNotebookLazyRenderWrapper":false,"enableClusterAutoScalingForJobs":true,"enableStrongPassword":false,"showReleaseNote":true,"displayDefaultContainerMemoryGB":6,"broadenedEditPermission":false,"enableNotebookCommandMode":true,"disableS3TableImport":false,"enableArrayParamsEdit":true,"deploymentMode":"production","useSpotForWorkers":true,"removePasswordInAccountSettings":false,"preferStartTerminatedCluster":false,"enableUserInviteWorkflow":true,"createTableConnectorOptionLinks":[{"url":"https://docs.databricks.com/_static/notebooks/redshift.html","displayName":"Amazon Redshift","workspaceFileName":"Amazon Redshift Example"},{"url":"https://docs.databricks.com/_static/notebooks/structured-streaming-kinesis.html","displayName":"Amazon Kinesis","workspaceFileName":"Amazon Kinesis Example"},{"url":"https://docs.databricks.com/_static/notebooks/data-import/jdbc.html","displayName":"JDBC","workspaceFileName":"JDBC Example"},{"url":"https://docs.databricks.com/_static/notebooks/cassandra.html","displayName":"Cassandra","workspaceFileName":"Cassandra Example"},{"url":"https://docs.databricks.com/_static/notebooks/structured-streaming-etl-kafka.html","displayName":"Kafka","workspaceFileName":"Kafka Example"},{"url":"https://docs.databricks.com/_static/notebooks/redis.html","displayName":"Redis","workspaceFileName":"Redis Example"},{"url":"https://docs.databricks.com/_static/notebooks/elasticsearch.html","displayName":"Elasticsearch","workspaceFileName":"Elasticsearch Example"}],"enableStaticNotebooks":true,"sandboxForUrlSandboxFrame":"allow-scripts allow-popups allow-popups-to-escape-sandbox allow-forms","enableCssTransitions":true,"serverlessEnableElasticDisk":true,"minClusterTagKeyLength":1,"showHomepageFeaturedLinks":true,"pricingURL":"https://databricks.com/product/pricing","enableClusterEdit":true,"enableClusterAclsConfig":false,"useTempS3UrlForTableUpload":false,"notifyLastLogin":false,"enableSshKeyUIByTier":false,"enableCreateClusterOnAttach":true,"defaultAutomatedPricePerDBU":0.2,"enableNotebookGitVersioning":true,"defaultMinWorkers":2,"files":"files/","feedbackEmail":"feedback@databricks.com","enableDriverLogsUI":true,"defaultMaxWorkers":8,"enableWorkspaceAclsConfig":false,"serverlessRunPythonAsLowPrivilegeUser":false,"dropzoneMaxFileSize":2047,"enableNewClustersList":true,"enableNewDashboardViews":true,"enableJobListPermissionFilter":false,"driverLog4jFilePrefix":"log4j","enableSingleSignOn":true,"enableMavenLibraries":true,"displayRowLimit":1000,"deltaProcessingAsyncEnabled":true,"enableSparkEnvironmentVariablesUI":false,"defaultSparkVersion":{"key":"3.5.x-scala2.11","displayName":"3.5 LTS (includes Apache Spark 2.2.1, Scala 2.11)","packageLabel":"spark-image-4f5f9fb3a7177ac43f84a20f819e8ad76833e356707ed0b79812a2f837ac0a06","upgradable":true,"deprecated":false,"customerVisible":true,"capabilities":["SUPPORTS_END_TO_END_ENCRYPTION","SUPPORTS_TABLE_ACLS"]},"deprecatedEnableStructuredDataAcls":false,"enableCustomSpotPricing":false,"enableMountAclsConfig":false,"defaultAutoterminationMin":120,"useDevTierHomePage":true,"disableExportNotebook":false,"enableClusterClone":true,"enableNotebookLineNumbers":true,"enablePublishHub":false,"notebookHubUrl":"http://hub.dev.databricks.com/","showSqlEndpoints":false,"enableNotebookDatasetInfoView":true,"defaultTagKeys":{"CLUSTER_NAME":"ClusterName","VENDOR":"Vendor","CLUSTER_TYPE":"ResourceClass","CREATOR":"Creator","CLUSTER_ID":"ClusterId"},"enableClusterAclsByTier":false,"databricksDocsBaseUrl":"https://docs.databricks.com/","azurePortalLink":"https://portal.azure.com","cloud":"AWS","customSparkVersionPrefix":"custom:","disallowAddingAdmins":true,"enableSparkConfUI":true,"featureTier":"DEVELOPER_BASIC_TIER","mavenCentralSearchEndpoint":"http://search.maven.org/solrsearch/select","defaultServerlessClusterModel":{"cluster_name":"","node_type_id":"i3.2xlarge","spark_version":"latest-stable-scala2.11","num_workers":null,"enable_jdbc_auto_start":true,"custom_tags":{"ResourceClass":"Serverless"},"autoscale":{"min_workers":2,"max_workers":20},"spark_conf":{"spark.databricks.cluster.profile":"serverless","spark.databricks.repl.allowedLanguages":"sql,python","spark.databricks.acl.enabled":"false","spark.databricks.acl.sqlOnly":"false"},"aws_attributes":{"ebs_volume_count":null,"availability":"ON_DEMAND","first_on_demand":1,"ebs_volume_type":null,"spot_bid_price_percent":100,"zone_id":"us-west-2c","ebs_volume_size":null},"autotermination_minutes":0,"enable_elastic_disk":false,"default_tags":{"Vendor":"Databricks","Creator":"bhaskar.reddi@gmail.com","ClusterName":null,"ClusterId":"<Generated after creation>"}},"enableOrgSwitcherUI":true,"bitbucketCloudBaseApiV2Url":"https://api.bitbucket.org/2.0","clustersLimit":1,"enableJdbcImport":true,"enableClusterAppsUIOnNormalClusters":false,"enableElasticDisk":false,"logfiles":"logfiles/","enableRelativeNotebookLinks":true,"enableMultiSelect":true,"homePageLogo":"login/databricks_logoTM_rgb_TM.svg","enableWebappSharding":true,"enableNotebookParamsEdit":true,"enableClusterDeltaUpdates":true,"enableSingleSignOnLogin":false,"separateTableForJobClusters":true,"ebsVolumeSizeLimitGB":{"GENERAL_PURPOSE_SSD":[100,4096],"THROUGHPUT_OPTIMIZED_HDD":[500,4096]},"enableMountAcls":false,"requireEmailUserName":true,"dbcFeedbackURL":"mailto:feedback@databricks.com","enableMountAclService":true,"showVersion":true,"serverlessClustersByDefault":false,"enableWorkspaceAcls":false,"maxClusterTagKeyLength":127,"gitHash":"","clusterTagReservedPrefixes":[],"tableAclsEnabledMap":{"spark.databricks.acl.dfAclsEnabled":"true"},"showWorkspaceFeaturedLinks":true,"signupUrl":"https://databricks.com/try-databricks","databricksDocsNotebookPathPrefix":"^https://docs\\.databricks\\.com/_static/notebooks/.+$","serverlessAttachEbsVolumesByDefault":false,"enableTokensConfig":false,"allowFeedbackForumAccess":true,"enableImportFromUrl":true,"allowDisplayHtmlByUrl":true,"enableTokens":false,"enableMiniClusters":true,"enableNewJobList":true,"enableDebugUI":false,"enableStreamingMetricsDashboard":true,"allowNonAdminUsers":true,"enableSingleSignOnByTier":false,"enableJobsRetryOnTimeout":true,"loginLogo":"/login/databricks_logoTM_rgb_TM.svg","useStandardTierUpgradeTooltips":true,"staticNotebookResourceUrl":"https://databricks-prod-cloudfront.cloud.databricks.com/static/bc1c85971ad864da65b19d4f80abe81e111e7bfd8db9cac8f69dc1d94b874689/","enableSpotClusterType":true,"enableSparkPackages":true,"checkAadUserInWorkspaceTenant":false,"dynamicSparkVersions":true,"useIframeForHtmlResult":false,"enableClusterTagsUIByTier":false,"enableNotebookHistoryUI":true,"addWhitespaceAfterLastNotebookCell":true,"enableClusterLoggingUI":true,"enableDatabaseDropdownInTableUI":true,"showDebugCounters":false,"enableInstanceProfilesUI":false,"enableFolderHtmlExport":true,"homepageFeaturedLinks":[{"linkURI":"https://docs.databricks.com/_static/notebooks/gentle-introduction-to-apache-spark.html","displayName":"Introduction to Apache Spark on Databricks","icon":"img/home/Python_icon.svg"},{"linkURI":"https://docs.databricks.com/_static/notebooks/databricks-for-data-scientists.html","displayName":"Databricks for Data Scientists","icon":"img/home/Scala_icon.svg"},{"linkURI":"https://docs.databricks.com/_static/notebooks/structured-streaming-python.html","displayName":"Introduction to Structured Streaming","icon":"img/home/Python_icon.svg"}],"enableClusterStart":false,"maxImportFileVersion":5,"enableEBSVolumesUIByTier":false,"enableTableAclService":true,"removeSubCommandCodeWhenExport":true,"upgradeURL":"https://accounts.cloud.databricks.com/registration.html#login","maxAutoterminationMinutes":10000,"showResultsFromExternalSearchEngine":true,"autoterminateClustersByDefault":true,"notebookLoadingBackground":"#fff","sshContainerForwardedPort":2200,"enableServerAutoComplete":true,"enableStaticHtmlImport":true,"enableInstanceProfilesByTier":false,"showForgotPasswordLink":true,"defaultMemoryPerContainerMB":6000,"enablePresenceUI":true,"minAutoterminationMinutes":10,"accounts":true,"useOnDemandClustersByDefault":true,"useFramedStaticNotebooks":false,"enableNewProgressReportUI":true,"enableAutoCreateUserUI":true,"defaultCoresPerContainer":4,"showTerminationReason":true,"enableNewClustersGet":true,"showPricePerDBU":false,"showSqlProxyUI":true,"enableNotebookErrorHighlighting":true};</script>
<script>var __DATABRICKS_NOTEBOOK_MODEL = {"version":"NotebookV1","origId":620808971867608,"name":"MyDF","language":"python","commands":[{"version":"CommandV1","origId":620808971867609,"guid":"b0251d65-80df-4861-94a7-390cdac107eb","subtype":"command","commandType":"auto","position":1.0,"command":"wb = spark.read.json('/FileStore/tables/world_bank.json')","commandVersion":0,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\"></div>","arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[{"name":"wb","typeStr":"pyspark.sql.dataframe.DataFrame","schema":{"fields":[{"metadata":{},"name":"_id","nullable":true,"type":{"fields":[{"metadata":{},"name":"$oid","nullable":true,"type":"string"}],"type":"struct"}},{"metadata":{},"name":"approvalfy","nullable":true,"type":"string"},{"metadata":{},"name":"board_approval_month","nullable":true,"type":"string"},{"metadata":{},"name":"boardapprovaldate","nullable":true,"type":"string"},{"metadata":{},"name":"borrower","nullable":true,"type":"string"},{"metadata":{},"name":"closingdate","nullable":true,"type":"string"},{"metadata":{},"name":"country_namecode","nullable":true,"type":"string"},{"metadata":{},"name":"countrycode","nullable":true,"type":"string"},{"metadata":{},"name":"countryname","nullable":true,"type":"string"},{"metadata":{},"name":"countryshortname","nullable":true,"type":"string"},{"metadata":{},"name":"docty","nullable":true,"type":"string"},{"metadata":{},"name":"envassesmentcategorycode","nullable":true,"type":"string"},{"metadata":{},"name":"grantamt","nullable":true,"type":"long"},{"metadata":{},"name":"ibrdcommamt","nullable":true,"type":"long"},{"metadata":{},"name":"id","nullable":true,"type":"string"},{"metadata":{},"name":"idacommamt","nullable":true,"type":"long"},{"metadata":{},"name":"impagency","nullable":true,"type":"string"},{"metadata":{},"name":"lendinginstr","nullable":true,"type":"string"},{"metadata":{},"name":"lendinginstrtype","nullable":true,"type":"string"},{"metadata":{},"name":"lendprojectcost","nullable":true,"type":"long"},{"metadata":{},"name":"majorsector_percent","nullable":true,"type":{"containsNull":true,"elementType":{"fields":[{"metadata":{},"name":"Name","nullable":true,"type":"string"},{"metadata":{},"name":"Percent","nullable":true,"type":"long"}],"type":"struct"},"type":"array"}},{"metadata":{},"name":"mjsector_namecode","nullable":true,"type":{"containsNull":true,"elementType":{"fields":[{"metadata":{},"name":"code","nullable":true,"type":"string"},{"metadata":{},"name":"name","nullable":true,"type":"string"}],"type":"struct"},"type":"array"}},{"metadata":{},"name":"mjtheme","nullable":true,"type":{"containsNull":true,"elementType":"string","type":"array"}},{"metadata":{},"name":"mjtheme_namecode","nullable":true,"type":{"containsNull":true,"elementType":{"fields":[{"metadata":{},"name":"code","nullable":true,"type":"string"},{"metadata":{},"name":"name","nullable":true,"type":"string"}],"type":"struct"},"type":"array"}},{"metadata":{},"name":"mjthemecode","nullable":true,"type":"string"},{"metadata":{},"name":"prodline","nullable":true,"type":"string"},{"metadata":{},"name":"prodlinetext","nullable":true,"type":"string"},{"metadata":{},"name":"productlinetype","nullable":true,"type":"string"},{"metadata":{},"name":"project_abstract","nullable":true,"type":{"fields":[{"metadata":{},"name":"cdata","nullable":true,"type":"string"}],"type":"struct"}},{"metadata":{},"name":"project_name","nullable":true,"type":"string"},{"metadata":{},"name":"projectdocs","nullable":true,"type":{"containsNull":true,"elementType":{"fields":[{"metadata":{},"name":"DocDate","nullable":true,"type":"string"},{"metadata":{},"name":"DocType","nullable":true,"type":"string"},{"metadata":{},"name":"DocTypeDesc","nullable":true,"type":"string"},{"metadata":{},"name":"DocURL","nullable":true,"type":"string"},{"metadata":{},"name":"EntityID","nullable":true,"type":"string"}],"type":"struct"},"type":"array"}},{"metadata":{},"name":"projectfinancialtype","nullable":true,"type":"string"},{"metadata":{},"name":"projectstatusdisplay","nullable":true,"type":"string"},{"metadata":{},"name":"regionname","nullable":true,"type":"string"},{"metadata":{},"name":"sector","nullable":true,"type":{"containsNull":true,"elementType":{"fields":[{"metadata":{},"name":"Name","nullable":true,"type":"string"}],"type":"struct"},"type":"array"}},{"metadata":{},"name":"sector1","nullable":true,"type":{"fields":[{"metadata":{},"name":"Name","nullable":true,"type":"string"},{"metadata":{},"name":"Percent","nullable":true,"type":"long"}],"type":"struct"}},{"metadata":{},"name":"sector2","nullable":true,"type":{"fields":[{"metadata":{},"name":"Name","nullable":true,"type":"string"},{"metadata":{},"name":"Percent","nullable":true,"type":"long"}],"type":"struct"}},{"metadata":{},"name":"sector3","nullable":true,"type":{"fields":[{"metadata":{},"name":"Name","nullable":true,"type":"string"},{"metadata":{},"name":"Percent","nullable":true,"type":"long"}],"type":"struct"}},{"metadata":{},"name":"sector4","nullable":true,"type":{"fields":[{"metadata":{},"name":"Name","nullable":true,"type":"string"},{"metadata":{},"name":"Percent","nullable":true,"type":"long"}],"type":"struct"}},{"metadata":{},"name":"sector_namecode","nullable":true,"type":{"containsNull":true,"elementType":{"fields":[{"metadata":{},"name":"code","nullable":true,"type":"string"},{"metadata":{},"name":"name","nullable":true,"type":"string"}],"type":"struct"},"type":"array"}},{"metadata":{},"name":"sectorcode","nullable":true,"type":"string"},{"metadata":{},"name":"source","nullable":true,"type":"string"},{"metadata":{},"name":"status","nullable":true,"type":"string"},{"metadata":{},"name":"supplementprojectflg","nullable":true,"type":"string"},{"metadata":{},"name":"theme1","nullable":true,"type":{"fields":[{"metadata":{},"name":"Name","nullable":true,"type":"string"},{"metadata":{},"name":"Percent","nullable":true,"type":"long"}],"type":"struct"}},{"metadata":{},"name":"theme_namecode","nullable":true,"type":{"containsNull":true,"elementType":{"fields":[{"metadata":{},"name":"code","nullable":true,"type":"string"},{"metadata":{},"name":"name","nullable":true,"type":"string"}],"type":"struct"},"type":"array"}},{"metadata":{},"name":"themecode","nullable":true,"type":"string"},{"metadata":{},"name":"totalamt","nullable":true,"type":"long"},{"metadata":{},"name":"totalcommamt","nullable":true,"type":"long"},{"metadata":{},"name":"url","nullable":true,"type":"string"}],"type":"struct"},"tableIdentifier":null}]},"errorSummary":null,"error":null,"workflows":[],"startTime":1511424611392,"submitTime":1511424611379,"finishTime":1511424611931,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"d8cdf881-6f5a-4049-b4ba-8b575ca212bb"},{"version":"CommandV1","origId":620808971867611,"guid":"4fbaa06b-561f-4d18-8b7c-9d9a6c853ff5","subtype":"command","commandType":"auto","position":2.0,"command":"wb.show(2)","commandVersion":0,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\">+--------------------+----------+--------------------+--------------------+--------------------+--------------------+--------------------+-----------+--------------------+----------------+--------------------+------------------------+--------+-----------+-------+----------+--------------------+--------------------+----------------+---------------+--------------------+--------------------+--------------------+--------------------+-----------+--------+--------------------+---------------+--------------------+--------------------+--------------------+--------------------+--------------------+--------------------+--------------------+--------------------+--------------------+--------------------+--------------------+--------------------+-----------+------+------+--------------------+--------------------+--------------------+---------+---------+------------+--------------------+\n|                 _id|approvalfy|board_approval_month|   boardapprovaldate|            borrower|         closingdate|    country_namecode|countrycode|         countryname|countryshortname|               docty|envassesmentcategorycode|grantamt|ibrdcommamt|     id|idacommamt|           impagency|        lendinginstr|lendinginstrtype|lendprojectcost| majorsector_percent|   mjsector_namecode|             mjtheme|    mjtheme_namecode|mjthemecode|prodline|        prodlinetext|productlinetype|    project_abstract|        project_name|         projectdocs|projectfinancialtype|projectstatusdisplay|          regionname|              sector|             sector1|             sector2|             sector3|             sector4|     sector_namecode| sectorcode|source|status|supplementprojectflg|              theme1|      theme_namecode|themecode| totalamt|totalcommamt|                 url|\n+--------------------+----------+--------------------+--------------------+--------------------+--------------------+--------------------+-----------+--------------------+----------------+--------------------+------------------------+--------+-----------+-------+----------+--------------------+--------------------+----------------+---------------+--------------------+--------------------+--------------------+--------------------+-----------+--------+--------------------+---------------+--------------------+--------------------+--------------------+--------------------+--------------------+--------------------+--------------------+--------------------+--------------------+--------------------+--------------------+--------------------+-----------+------+------+--------------------+--------------------+--------------------+---------+---------+------------+--------------------+\n|[52b213b38594d8a2...|      1999|            November|2013-11-12T00:00:00Z|FEDERAL DEMOCRATI...|2018-07-07T00:00:00Z|Federal Democrati...|         ET|Federal Democrati...|        Ethiopia|Project Informati...|                       C|       0|          0|P129828| 130000000|MINISTRY OF EDUCA...|Investment Projec...|              IN|      550000000|[[Education,46], ...|[[EX,Education], ...| [Human development]|[[8,Human develop...|       8,11|      PE|            IBRD/IDA|              L|[The development ...|Ethiopia General ...|[[28-AUG-2013,PID...|                 IDA|              Active|              Africa|[[Primary educati...|[Primary educatio...|[Secondary educat...|[Public administr...|[Tertiary educati...|[[EP,Primary educ...|ET,BS,ES,EP|  IBRD|Active|                   N|[Education for al...|[[65,Education fo...|       65|130000000|   130000000|http://www.worldb...|\n|[52b213b38594d8a2...|      2015|            November|2013-11-04T00:00:00Z|GOVERNMENT OF TUN...|                null|Republic of Tunis...|         TN| Republic of Tunisia|         Tunisia|Project Informati...|                       C| 4700000|          0|P144674|         0| MINISTRY OF FINANCE|Specific Investme...|              IN|        5700000|[[Public Administ...|[[BX,Public Admin...|[Economic managem...|[[1,Economic mana...|        1,6|      RE|Recipient Execute...|              L|                null|TN: DTF Social Pr...|[[29-MAR-2013,PID...|               OTHER|              Active|Middle East and N...|[[Public administ...|[Public administr...|[General public a...|                null|                null|[[BS,Public admin...|      BZ,BS|  IBRD|Active|                   N|[Other economic m...|[[24,Other econom...|    54,24|        0|     4700000|http://www.worldb...|\n+--------------------+----------+--------------------+--------------------+--------------------+--------------------+--------------------+-----------+--------------------+----------------+--------------------+------------------------+--------+-----------+-------+----------+--------------------+--------------------+----------------+---------------+--------------------+--------------------+--------------------+--------------------+-----------+--------+--------------------+---------------+--------------------+--------------------+--------------------+--------------------+--------------------+--------------------+--------------------+--------------------+--------------------+--------------------+--------------------+--------------------+-----------+------+------+--------------------+--------------------+--------------------+---------+---------+------------+--------------------+\nonly showing top 2 rows\n\n</div>","arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[]},"errorSummary":null,"error":null,"workflows":[],"startTime":1511424062464,"submitTime":1511424062451,"finishTime":1511424062944,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"535ae948-c918-436d-a2b1-6ba104889d5d"},{"version":"CommandV1","origId":620808971867612,"guid":"fe0a3eb0-3a58-45de-b235-6e34a01cac51","subtype":"command","commandType":"auto","position":3.0,"command":"wb.printSchema()","commandVersion":0,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\">root\n |-- _id: struct (nullable = true)\n |    |-- $oid: string (nullable = true)\n |-- approvalfy: string (nullable = true)\n |-- board_approval_month: string (nullable = true)\n |-- boardapprovaldate: string (nullable = true)\n |-- borrower: string (nullable = true)\n |-- closingdate: string (nullable = true)\n |-- country_namecode: string (nullable = true)\n |-- countrycode: string (nullable = true)\n |-- countryname: string (nullable = true)\n |-- countryshortname: string (nullable = true)\n |-- docty: string (nullable = true)\n |-- envassesmentcategorycode: string (nullable = true)\n |-- grantamt: long (nullable = true)\n |-- ibrdcommamt: long (nullable = true)\n |-- id: string (nullable = true)\n |-- idacommamt: long (nullable = true)\n |-- impagency: string (nullable = true)\n |-- lendinginstr: string (nullable = true)\n |-- lendinginstrtype: string (nullable = true)\n |-- lendprojectcost: long (nullable = true)\n |-- majorsector_percent: array (nullable = true)\n |    |-- element: struct (containsNull = true)\n |    |    |-- Name: string (nullable = true)\n |    |    |-- Percent: long (nullable = true)\n |-- mjsector_namecode: array (nullable = true)\n |    |-- element: struct (containsNull = true)\n |    |    |-- code: string (nullable = true)\n |    |    |-- name: string (nullable = true)\n |-- mjtheme: array (nullable = true)\n |    |-- element: string (containsNull = true)\n |-- mjtheme_namecode: array (nullable = true)\n |    |-- element: struct (containsNull = true)\n |    |    |-- code: string (nullable = true)\n |    |    |-- name: string (nullable = true)\n |-- mjthemecode: string (nullable = true)\n |-- prodline: string (nullable = true)\n |-- prodlinetext: string (nullable = true)\n |-- productlinetype: string (nullable = true)\n |-- project_abstract: struct (nullable = true)\n |    |-- cdata: string (nullable = true)\n |-- project_name: string (nullable = true)\n |-- projectdocs: array (nullable = true)\n |    |-- element: struct (containsNull = true)\n |    |    |-- DocDate: string (nullable = true)\n |    |    |-- DocType: string (nullable = true)\n |    |    |-- DocTypeDesc: string (nullable = true)\n |    |    |-- DocURL: string (nullable = true)\n |    |    |-- EntityID: string (nullable = true)\n |-- projectfinancialtype: string (nullable = true)\n |-- projectstatusdisplay: string (nullable = true)\n |-- regionname: string (nullable = true)\n |-- sector: array (nullable = true)\n |    |-- element: struct (containsNull = true)\n |    |    |-- Name: string (nullable = true)\n |-- sector1: struct (nullable = true)\n |    |-- Name: string (nullable = true)\n |    |-- Percent: long (nullable = true)\n |-- sector2: struct (nullable = true)\n |    |-- Name: string (nullable = true)\n |    |-- Percent: long (nullable = true)\n |-- sector3: struct (nullable = true)\n |    |-- Name: string (nullable = true)\n |    |-- Percent: long (nullable = true)\n |-- sector4: struct (nullable = true)\n |    |-- Name: string (nullable = true)\n |    |-- Percent: long (nullable = true)\n |-- sector_namecode: array (nullable = true)\n |    |-- element: struct (containsNull = true)\n |    |    |-- code: string (nullable = true)\n |    |    |-- name: string (nullable = true)\n |-- sectorcode: string (nullable = true)\n |-- source: string (nullable = true)\n |-- status: string (nullable = true)\n |-- supplementprojectflg: string (nullable = true)\n |-- theme1: struct (nullable = true)\n |    |-- Name: string (nullable = true)\n |    |-- Percent: long (nullable = true)\n |-- theme_namecode: array (nullable = true)\n |    |-- element: struct (containsNull = true)\n |    |    |-- code: string (nullable = true)\n |    |    |-- name: string (nullable = true)\n |-- themecode: string (nullable = true)\n |-- totalamt: long (nullable = true)\n |-- totalcommamt: long (nullable = true)\n |-- url: string (nullable = true)\n\n</div>","arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[]},"errorSummary":null,"error":null,"workflows":[],"startTime":1511424068257,"submitTime":1511424068246,"finishTime":1511424068331,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"8c56180f-95e4-46e0-86d1-19a783e7a127"},{"version":"CommandV1","origId":620808971867613,"guid":"bfdfa36b-c03c-47ce-9130-a7c84516b37b","subtype":"command","commandType":"auto","position":4.0,"command":"wb.createOrReplaceTempView('world_bank')","commandVersion":0,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\"></div>","arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[]},"errorSummary":null,"error":null,"workflows":[],"startTime":1511424072670,"submitTime":1511424072658,"finishTime":1511424072797,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"8585c4ee-f67c-4c20-94a5-6448902b5e0f"},{"version":"CommandV1","origId":620808971867614,"guid":"d4e15c2e-68c8-41de-866a-d15468fdd432","subtype":"command","commandType":"auto","position":5.0,"command":"df1 = spark.sql(\"select countryshortname from world_bank\")\ndf1.show(2)","commandVersion":0,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\">+----------------+\n|countryshortname|\n+----------------+\n|        Ethiopia|\n|         Tunisia|\n+----------------+\nonly showing top 2 rows\n\n</div>","arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[{"name":"df1","typeStr":"pyspark.sql.dataframe.DataFrame","schema":{"fields":[{"metadata":{},"name":"countryshortname","nullable":true,"type":"string"}],"type":"struct"},"tableIdentifier":null}]},"errorSummary":"<span class=\"ansired\">AnalysisException</span>: u&quot;cannot resolve &apos;&#96;country_namecoder&#96;&apos; given input columns: [world_bank.url, world_bank.sector2, world_bank.projectstatusdisplay, world_bank.impagency, world_bank.status, world_bank.totalamt, world_bank.totalcommamt, world_bank.supplementprojectflg, world_bank._id, world_bank.lendinginstrtype, world_bank.sector, world_bank.lendprojectcost, world_bank.sector4, world_bank.closingdate, world_bank.projectdocs, world_bank.sector_namecode, world_bank.theme_namecode, world_bank.id, world_bank.countrycode, world_bank.productlinetype, world_bank.sector3, world_bank.majorsector_percent, world_bank.themecode, world_bank.grantamt, world_bank.sector1, world_bank.project_abstract, world_bank.project_name, world_bank.mjthemecode, world_bank.borrower, world_bank.ibrdcommamt, world_bank.mjsector_namecode, world_bank.prodlinetext, world_bank.mjtheme_namecode, world_bank.boardapprovaldate, world_bank.board_approval_month, world_bank.mjtheme, world_bank.source, world_bank.theme1, world_bank.regionname, world_bank.projectfinancialtype, world_bank.docty, world_bank.countryname, world_bank.country_namecode, world_bank.sectorcode, world_bank.lendinginstr, world_bank.approvalfy, world_bank.countryshortname, world_bank.prodline, world_bank.envassesmentcategorycode, world_bank.idacommamt]; line 1 pos 7;\\n&apos;Project [&apos;country_namecoder]\\n+- SubqueryAlias world_bank\\n   +- Relation[_id#2101,approvalfy#2102,board_approval_month#2103,boardapprovaldate#2104,borrower#2105,closingdate#2106,country_namecode#2107,countrycode#2108,countryname#2109,countryshortname#2110,docty#2111,envassesmentcategorycode#2112,grantamt#2113L,ibrdcommamt#2114L,id#2115,idacommamt#2116L,impagency#2117,lendinginstr#2118,lendinginstrtype#2119,lendprojectcost#2120L,majorsector_percent#2121,mjsector_namecode#2122,mjtheme#2123,mjtheme_namecode#2124,... 26 more fields] json\\n&quot;","error":"<div class=\"ansiout\"><span class=\"ansired\">---------------------------------------------------------------------------</span>\n<span class=\"ansired\">AnalysisException</span>                         Traceback (most recent call last)\n<span class=\"ansigreen\">&lt;command-620808971867614&gt;</span> in <span class=\"ansicyan\">&lt;module&gt;</span><span class=\"ansiblue\">()</span>\n<span class=\"ansigreen\">----&gt; 1</span><span class=\"ansiyellow\"> </span>df1 <span class=\"ansiyellow\">=</span> spark<span class=\"ansiyellow\">.</span>sql<span class=\"ansiyellow\">(</span><span class=\"ansiblue\">&quot;select country_namecoder from world_bank&quot;</span><span class=\"ansiyellow\">)</span><span class=\"ansiyellow\"></span>\n<span class=\"ansigreen\">      2</span> df1<span class=\"ansiyellow\">.</span>show<span class=\"ansiyellow\">(</span><span class=\"ansicyan\">2</span><span class=\"ansiyellow\">)</span><span class=\"ansiyellow\"></span>\n\n<span class=\"ansigreen\">/databricks/spark/python/pyspark/sql/session.pyc</span> in <span class=\"ansicyan\">sql</span><span class=\"ansiblue\">(self, sqlQuery)</span>\n<span class=\"ansigreen\">    554</span>         <span class=\"ansiyellow\">[</span>Row<span class=\"ansiyellow\">(</span>f1<span class=\"ansiyellow\">=</span><span class=\"ansicyan\">1</span><span class=\"ansiyellow\">,</span> f2<span class=\"ansiyellow\">=</span><span class=\"ansiblue\">u&apos;row1&apos;</span><span class=\"ansiyellow\">)</span><span class=\"ansiyellow\">,</span> Row<span class=\"ansiyellow\">(</span>f1<span class=\"ansiyellow\">=</span><span class=\"ansicyan\">2</span><span class=\"ansiyellow\">,</span> f2<span class=\"ansiyellow\">=</span><span class=\"ansiblue\">u&apos;row2&apos;</span><span class=\"ansiyellow\">)</span><span class=\"ansiyellow\">,</span> Row<span class=\"ansiyellow\">(</span>f1<span class=\"ansiyellow\">=</span><span class=\"ansicyan\">3</span><span class=\"ansiyellow\">,</span> f2<span class=\"ansiyellow\">=</span><span class=\"ansiblue\">u&apos;row3&apos;</span><span class=\"ansiyellow\">)</span><span class=\"ansiyellow\">]</span><span class=\"ansiyellow\"></span>\n<span class=\"ansigreen\">    555</span>         &quot;&quot;&quot;\n<span class=\"ansigreen\">--&gt; 556</span><span class=\"ansiyellow\">         </span><span class=\"ansigreen\">return</span> DataFrame<span class=\"ansiyellow\">(</span>self<span class=\"ansiyellow\">.</span>_jsparkSession<span class=\"ansiyellow\">.</span>sql<span class=\"ansiyellow\">(</span>sqlQuery<span class=\"ansiyellow\">)</span><span class=\"ansiyellow\">,</span> self<span class=\"ansiyellow\">.</span>_wrapped<span class=\"ansiyellow\">)</span><span class=\"ansiyellow\"></span>\n<span class=\"ansigreen\">    557</span> <span class=\"ansiyellow\"></span>\n<span class=\"ansigreen\">    558</span>     <span class=\"ansiyellow\">@</span>since<span class=\"ansiyellow\">(</span><span class=\"ansicyan\">2.0</span><span class=\"ansiyellow\">)</span><span class=\"ansiyellow\"></span>\n\n<span class=\"ansigreen\">/databricks/spark/python/lib/py4j-0.10.4-src.zip/py4j/java_gateway.py</span> in <span class=\"ansicyan\">__call__</span><span class=\"ansiblue\">(self, *args)</span>\n<span class=\"ansigreen\">   1131</span>         answer <span class=\"ansiyellow\">=</span> self<span class=\"ansiyellow\">.</span>gateway_client<span class=\"ansiyellow\">.</span>send_command<span class=\"ansiyellow\">(</span>command<span class=\"ansiyellow\">)</span><span class=\"ansiyellow\"></span>\n<span class=\"ansigreen\">   1132</span>         return_value = get_return_value(\n<span class=\"ansigreen\">-&gt; 1133</span><span class=\"ansiyellow\">             answer, self.gateway_client, self.target_id, self.name)\n</span><span class=\"ansigreen\">   1134</span> <span class=\"ansiyellow\"></span>\n<span class=\"ansigreen\">   1135</span>         <span class=\"ansigreen\">for</span> temp_arg <span class=\"ansigreen\">in</span> temp_args<span class=\"ansiyellow\">:</span><span class=\"ansiyellow\"></span>\n\n<span class=\"ansigreen\">/databricks/spark/python/pyspark/sql/utils.pyc</span> in <span class=\"ansicyan\">deco</span><span class=\"ansiblue\">(*a, **kw)</span>\n<span class=\"ansigreen\">     67</span>                                              e.java_exception.getStackTrace()))\n<span class=\"ansigreen\">     68</span>             <span class=\"ansigreen\">if</span> s<span class=\"ansiyellow\">.</span>startswith<span class=\"ansiyellow\">(</span><span class=\"ansiblue\">&apos;org.apache.spark.sql.AnalysisException: &apos;</span><span class=\"ansiyellow\">)</span><span class=\"ansiyellow\">:</span><span class=\"ansiyellow\"></span>\n<span class=\"ansigreen\">---&gt; 69</span><span class=\"ansiyellow\">                 </span><span class=\"ansigreen\">raise</span> AnalysisException<span class=\"ansiyellow\">(</span>s<span class=\"ansiyellow\">.</span>split<span class=\"ansiyellow\">(</span><span class=\"ansiblue\">&apos;: &apos;</span><span class=\"ansiyellow\">,</span> <span class=\"ansicyan\">1</span><span class=\"ansiyellow\">)</span><span class=\"ansiyellow\">[</span><span class=\"ansicyan\">1</span><span class=\"ansiyellow\">]</span><span class=\"ansiyellow\">,</span> stackTrace<span class=\"ansiyellow\">)</span><span class=\"ansiyellow\"></span>\n<span class=\"ansigreen\">     70</span>             <span class=\"ansigreen\">if</span> s<span class=\"ansiyellow\">.</span>startswith<span class=\"ansiyellow\">(</span><span class=\"ansiblue\">&apos;org.apache.spark.sql.catalyst.analysis&apos;</span><span class=\"ansiyellow\">)</span><span class=\"ansiyellow\">:</span><span class=\"ansiyellow\"></span>\n<span class=\"ansigreen\">     71</span>                 <span class=\"ansigreen\">raise</span> AnalysisException<span class=\"ansiyellow\">(</span>s<span class=\"ansiyellow\">.</span>split<span class=\"ansiyellow\">(</span><span class=\"ansiblue\">&apos;: &apos;</span><span class=\"ansiyellow\">,</span> <span class=\"ansicyan\">1</span><span class=\"ansiyellow\">)</span><span class=\"ansiyellow\">[</span><span class=\"ansicyan\">1</span><span class=\"ansiyellow\">]</span><span class=\"ansiyellow\">,</span> stackTrace<span class=\"ansiyellow\">)</span><span class=\"ansiyellow\"></span>\n\n<span class=\"ansired\">AnalysisException</span>: u&quot;cannot resolve &apos;&#96;country_namecoder&#96;&apos; given input columns: [world_bank.url, world_bank.sector2, world_bank.projectstatusdisplay, world_bank.impagency, world_bank.status, world_bank.totalamt, world_bank.totalcommamt, world_bank.supplementprojectflg, world_bank._id, world_bank.lendinginstrtype, world_bank.sector, world_bank.lendprojectcost, world_bank.sector4, world_bank.closingdate, world_bank.projectdocs, world_bank.sector_namecode, world_bank.theme_namecode, world_bank.id, world_bank.countrycode, world_bank.productlinetype, world_bank.sector3, world_bank.majorsector_percent, world_bank.themecode, world_bank.grantamt, world_bank.sector1, world_bank.project_abstract, world_bank.project_name, world_bank.mjthemecode, world_bank.borrower, world_bank.ibrdcommamt, world_bank.mjsector_namecode, world_bank.prodlinetext, world_bank.mjtheme_namecode, world_bank.boardapprovaldate, world_bank.board_approval_month, world_bank.mjtheme, world_bank.source, world_bank.theme1, world_bank.regionname, world_bank.projectfinancialtype, world_bank.docty, world_bank.countryname, world_bank.country_namecode, world_bank.sectorcode, world_bank.lendinginstr, world_bank.approvalfy, world_bank.countryshortname, world_bank.prodline, world_bank.envassesmentcategorycode, world_bank.idacommamt]; line 1 pos 7;\\n&apos;Project [&apos;country_namecoder]\\n+- SubqueryAlias world_bank\\n   +- Relation[_id#2101,approvalfy#2102,board_approval_month#2103,boardapprovaldate#2104,borrower#2105,closingdate#2106,country_namecode#2107,countrycode#2108,countryname#2109,countryshortname#2110,docty#2111,envassesmentcategorycode#2112,grantamt#2113L,ibrdcommamt#2114L,id#2115,idacommamt#2116L,impagency#2117,lendinginstr#2118,lendinginstrtype#2119,lendprojectcost#2120L,majorsector_percent#2121,mjsector_namecode#2122,mjtheme#2123,mjtheme_namecode#2124,... 26 more fields] json\\n&quot;</div>","workflows":[],"startTime":1511425172610,"submitTime":1511425172602,"finishTime":1511425173138,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"2e4ed34f-ab94-4138-aefa-25613249b1ec"},{"version":"CommandV1","origId":620808971867615,"guid":"c1791196-8f06-41e5-8a21-de2486ae7a48","subtype":"command","commandType":"auto","position":6.0,"command":"wb.createGlobalTempView(\"bhaskar\")","commandVersion":0,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\"></div>","arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[]},"errorSummary":"<span class=\"ansired\">AnalysisException</span>: u&quot;Temporary table &apos;wb&apos; already exists;&quot;","error":"<div class=\"ansiout\"><span class=\"ansired\">---------------------------------------------------------------------------</span>\n<span class=\"ansired\">AnalysisException</span>                         Traceback (most recent call last)\n<span class=\"ansigreen\">&lt;command-620808971867615&gt;</span> in <span class=\"ansicyan\">&lt;module&gt;</span><span class=\"ansiblue\">()</span>\n<span class=\"ansigreen\">----&gt; 1</span><span class=\"ansiyellow\"> </span>wb<span class=\"ansiyellow\">.</span>createGlobalTempView<span class=\"ansiyellow\">(</span><span class=\"ansiblue\">&quot;WB&quot;</span><span class=\"ansiyellow\">)</span><span class=\"ansiyellow\"></span>\n\n<span class=\"ansigreen\">/databricks/spark/python/pyspark/sql/dataframe.pyc</span> in <span class=\"ansicyan\">createGlobalTempView</span><span class=\"ansiblue\">(self, name)</span>\n<span class=\"ansigreen\">    191</span> <span class=\"ansiyellow\"></span>\n<span class=\"ansigreen\">    192</span>         &quot;&quot;&quot;\n<span class=\"ansigreen\">--&gt; 193</span><span class=\"ansiyellow\">         </span>self<span class=\"ansiyellow\">.</span>_jdf<span class=\"ansiyellow\">.</span>createGlobalTempView<span class=\"ansiyellow\">(</span>name<span class=\"ansiyellow\">)</span><span class=\"ansiyellow\"></span>\n<span class=\"ansigreen\">    194</span> <span class=\"ansiyellow\"></span>\n<span class=\"ansigreen\">    195</span>     <span class=\"ansiyellow\">@</span>since<span class=\"ansiyellow\">(</span><span class=\"ansicyan\">2.2</span><span class=\"ansiyellow\">)</span><span class=\"ansiyellow\"></span>\n\n<span class=\"ansigreen\">/databricks/spark/python/lib/py4j-0.10.4-src.zip/py4j/java_gateway.py</span> in <span class=\"ansicyan\">__call__</span><span class=\"ansiblue\">(self, *args)</span>\n<span class=\"ansigreen\">   1131</span>         answer <span class=\"ansiyellow\">=</span> self<span class=\"ansiyellow\">.</span>gateway_client<span class=\"ansiyellow\">.</span>send_command<span class=\"ansiyellow\">(</span>command<span class=\"ansiyellow\">)</span><span class=\"ansiyellow\"></span>\n<span class=\"ansigreen\">   1132</span>         return_value = get_return_value(\n<span class=\"ansigreen\">-&gt; 1133</span><span class=\"ansiyellow\">             answer, self.gateway_client, self.target_id, self.name)\n</span><span class=\"ansigreen\">   1134</span> <span class=\"ansiyellow\"></span>\n<span class=\"ansigreen\">   1135</span>         <span class=\"ansigreen\">for</span> temp_arg <span class=\"ansigreen\">in</span> temp_args<span class=\"ansiyellow\">:</span><span class=\"ansiyellow\"></span>\n\n<span class=\"ansigreen\">/databricks/spark/python/pyspark/sql/utils.pyc</span> in <span class=\"ansicyan\">deco</span><span class=\"ansiblue\">(*a, **kw)</span>\n<span class=\"ansigreen\">     69</span>                 <span class=\"ansigreen\">raise</span> AnalysisException<span class=\"ansiyellow\">(</span>s<span class=\"ansiyellow\">.</span>split<span class=\"ansiyellow\">(</span><span class=\"ansiblue\">&apos;: &apos;</span><span class=\"ansiyellow\">,</span> <span class=\"ansicyan\">1</span><span class=\"ansiyellow\">)</span><span class=\"ansiyellow\">[</span><span class=\"ansicyan\">1</span><span class=\"ansiyellow\">]</span><span class=\"ansiyellow\">,</span> stackTrace<span class=\"ansiyellow\">)</span><span class=\"ansiyellow\"></span>\n<span class=\"ansigreen\">     70</span>             <span class=\"ansigreen\">if</span> s<span class=\"ansiyellow\">.</span>startswith<span class=\"ansiyellow\">(</span><span class=\"ansiblue\">&apos;org.apache.spark.sql.catalyst.analysis&apos;</span><span class=\"ansiyellow\">)</span><span class=\"ansiyellow\">:</span><span class=\"ansiyellow\"></span>\n<span class=\"ansigreen\">---&gt; 71</span><span class=\"ansiyellow\">                 </span><span class=\"ansigreen\">raise</span> AnalysisException<span class=\"ansiyellow\">(</span>s<span class=\"ansiyellow\">.</span>split<span class=\"ansiyellow\">(</span><span class=\"ansiblue\">&apos;: &apos;</span><span class=\"ansiyellow\">,</span> <span class=\"ansicyan\">1</span><span class=\"ansiyellow\">)</span><span class=\"ansiyellow\">[</span><span class=\"ansicyan\">1</span><span class=\"ansiyellow\">]</span><span class=\"ansiyellow\">,</span> stackTrace<span class=\"ansiyellow\">)</span><span class=\"ansiyellow\"></span>\n<span class=\"ansigreen\">     72</span>             <span class=\"ansigreen\">if</span> s<span class=\"ansiyellow\">.</span>startswith<span class=\"ansiyellow\">(</span><span class=\"ansiblue\">&apos;org.apache.spark.sql.catalyst.parser.ParseException: &apos;</span><span class=\"ansiyellow\">)</span><span class=\"ansiyellow\">:</span><span class=\"ansiyellow\"></span>\n<span class=\"ansigreen\">     73</span>                 <span class=\"ansigreen\">raise</span> ParseException<span class=\"ansiyellow\">(</span>s<span class=\"ansiyellow\">.</span>split<span class=\"ansiyellow\">(</span><span class=\"ansiblue\">&apos;: &apos;</span><span class=\"ansiyellow\">,</span> <span class=\"ansicyan\">1</span><span class=\"ansiyellow\">)</span><span class=\"ansiyellow\">[</span><span class=\"ansicyan\">1</span><span class=\"ansiyellow\">]</span><span class=\"ansiyellow\">,</span> stackTrace<span class=\"ansiyellow\">)</span><span class=\"ansiyellow\"></span>\n\n<span class=\"ansired\">AnalysisException</span>: u&quot;Temporary table &apos;wb&apos; already exists;&quot;</div>","workflows":[],"startTime":1511424649969,"submitTime":1511424649958,"finishTime":1511424650092,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"2b8fb3fa-5d77-4e0c-b0c3-12b9dfabcdc8"},{"version":"CommandV1","origId":620808971867616,"guid":"ab265057-c05b-4058-83f9-3f180aabc579","subtype":"command","commandType":"auto","position":7.0,"command":"df3 = spark.sql(\"SELECT  distinct approvalfy FROM global_temp.bhaskar WHERE countryshortname = 'Tunisia' \")","commandVersion":0,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\"></div>","arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[{"name":"df3","typeStr":"pyspark.sql.dataframe.DataFrame","schema":{"fields":[{"metadata":{},"name":"approvalfy","nullable":true,"type":"string"}],"type":"struct"},"tableIdentifier":null}]},"errorSummary":"<span class=\"ansired\">AnalysisException</span>: u&quot;cannot resolve &apos;&#96;disticnt&#96;&apos; given input columns: [bhaskar.boardapprovaldate, bhaskar.mjthemecode, bhaskar.sectorcode, bhaskar.totalamt, bhaskar.productlinetype, bhaskar.supplementprojectflg, bhaskar.lendinginstr, bhaskar.lendprojectcost, bhaskar.sector, bhaskar.ibrdcommamt, bhaskar.sector3, bhaskar._id, bhaskar.theme_namecode, bhaskar.sector1, bhaskar.idacommamt, bhaskar.approvalfy, bhaskar.lendinginstrtype, bhaskar.status, bhaskar.mjtheme, bhaskar.url, bhaskar.mjtheme_namecode, bhaskar.sector_namecode, bhaskar.docty, bhaskar.mjsector_namecode, bhaskar.project_name, bhaskar.countryname, bhaskar.grantamt, bhaskar.projectfinancialtype, bhaskar.project_abstract, bhaskar.prodline, bhaskar.impagency, bhaskar.majorsector_percent, bhaskar.totalcommamt, bhaskar.country_namecode, bhaskar.sector4, bhaskar.sector2, bhaskar.regionname, bhaskar.borrower, bhaskar.prodlinetext, bhaskar.projectdocs, bhaskar.board_approval_month, bhaskar.countrycode, bhaskar.closingdate, bhaskar.source, bhaskar.themecode, bhaskar.envassesmentcategorycode, bhaskar.id, bhaskar.projectstatusdisplay, bhaskar.theme1, bhaskar.countryshortname]; line 1 pos 8;\\n&apos;Project [&apos;disticnt AS approvalfy#2753]\\n+- Filter (countryshortname#2329 = Tunisia)\\n   +- SubqueryAlias bhaskar\\n      +- Relation[_id#2320,approvalfy#2321,board_approval_month#2322,boardapprovaldate#2323,borrower#2324,closingdate#2325,country_namecode#2326,countrycode#2327,countryname#2328,countryshortname#2329,docty#2330,envassesmentcategorycode#2331,grantamt#2332L,ibrdcommamt#2333L,id#2334,idacommamt#2335L,impagency#2336,lendinginstr#2337,lendinginstrtype#2338,lendprojectcost#2339L,majorsector_percent#2340,mjsector_namecode#2341,mjtheme#2342,mjtheme_namecode#2343,... 26 more fields] json\\n&quot;","error":"<div class=\"ansiout\"><span class=\"ansired\">---------------------------------------------------------------------------</span>\n<span class=\"ansired\">AnalysisException</span>                         Traceback (most recent call last)\n<span class=\"ansigreen\">&lt;command-620808971867616&gt;</span> in <span class=\"ansicyan\">&lt;module&gt;</span><span class=\"ansiblue\">()</span>\n<span class=\"ansigreen\">----&gt; 1</span><span class=\"ansiyellow\"> </span>df3 <span class=\"ansiyellow\">=</span> spark<span class=\"ansiyellow\">.</span>sql<span class=\"ansiyellow\">(</span><span class=\"ansiblue\">&quot;SELECT  disticnt approvalfy FROM global_temp.bhaskar WHERE countryshortname = &apos;Tunisia&apos; &quot;</span><span class=\"ansiyellow\">)</span><span class=\"ansiyellow\"></span>\n\n<span class=\"ansigreen\">/databricks/spark/python/pyspark/sql/session.pyc</span> in <span class=\"ansicyan\">sql</span><span class=\"ansiblue\">(self, sqlQuery)</span>\n<span class=\"ansigreen\">    554</span>         <span class=\"ansiyellow\">[</span>Row<span class=\"ansiyellow\">(</span>f1<span class=\"ansiyellow\">=</span><span class=\"ansicyan\">1</span><span class=\"ansiyellow\">,</span> f2<span class=\"ansiyellow\">=</span><span class=\"ansiblue\">u&apos;row1&apos;</span><span class=\"ansiyellow\">)</span><span class=\"ansiyellow\">,</span> Row<span class=\"ansiyellow\">(</span>f1<span class=\"ansiyellow\">=</span><span class=\"ansicyan\">2</span><span class=\"ansiyellow\">,</span> f2<span class=\"ansiyellow\">=</span><span class=\"ansiblue\">u&apos;row2&apos;</span><span class=\"ansiyellow\">)</span><span class=\"ansiyellow\">,</span> Row<span class=\"ansiyellow\">(</span>f1<span class=\"ansiyellow\">=</span><span class=\"ansicyan\">3</span><span class=\"ansiyellow\">,</span> f2<span class=\"ansiyellow\">=</span><span class=\"ansiblue\">u&apos;row3&apos;</span><span class=\"ansiyellow\">)</span><span class=\"ansiyellow\">]</span><span class=\"ansiyellow\"></span>\n<span class=\"ansigreen\">    555</span>         &quot;&quot;&quot;\n<span class=\"ansigreen\">--&gt; 556</span><span class=\"ansiyellow\">         </span><span class=\"ansigreen\">return</span> DataFrame<span class=\"ansiyellow\">(</span>self<span class=\"ansiyellow\">.</span>_jsparkSession<span class=\"ansiyellow\">.</span>sql<span class=\"ansiyellow\">(</span>sqlQuery<span class=\"ansiyellow\">)</span><span class=\"ansiyellow\">,</span> self<span class=\"ansiyellow\">.</span>_wrapped<span class=\"ansiyellow\">)</span><span class=\"ansiyellow\"></span>\n<span class=\"ansigreen\">    557</span> <span class=\"ansiyellow\"></span>\n<span class=\"ansigreen\">    558</span>     <span class=\"ansiyellow\">@</span>since<span class=\"ansiyellow\">(</span><span class=\"ansicyan\">2.0</span><span class=\"ansiyellow\">)</span><span class=\"ansiyellow\"></span>\n\n<span class=\"ansigreen\">/databricks/spark/python/lib/py4j-0.10.4-src.zip/py4j/java_gateway.py</span> in <span class=\"ansicyan\">__call__</span><span class=\"ansiblue\">(self, *args)</span>\n<span class=\"ansigreen\">   1131</span>         answer <span class=\"ansiyellow\">=</span> self<span class=\"ansiyellow\">.</span>gateway_client<span class=\"ansiyellow\">.</span>send_command<span class=\"ansiyellow\">(</span>command<span class=\"ansiyellow\">)</span><span class=\"ansiyellow\"></span>\n<span class=\"ansigreen\">   1132</span>         return_value = get_return_value(\n<span class=\"ansigreen\">-&gt; 1133</span><span class=\"ansiyellow\">             answer, self.gateway_client, self.target_id, self.name)\n</span><span class=\"ansigreen\">   1134</span> <span class=\"ansiyellow\"></span>\n<span class=\"ansigreen\">   1135</span>         <span class=\"ansigreen\">for</span> temp_arg <span class=\"ansigreen\">in</span> temp_args<span class=\"ansiyellow\">:</span><span class=\"ansiyellow\"></span>\n\n<span class=\"ansigreen\">/databricks/spark/python/pyspark/sql/utils.pyc</span> in <span class=\"ansicyan\">deco</span><span class=\"ansiblue\">(*a, **kw)</span>\n<span class=\"ansigreen\">     67</span>                                              e.java_exception.getStackTrace()))\n<span class=\"ansigreen\">     68</span>             <span class=\"ansigreen\">if</span> s<span class=\"ansiyellow\">.</span>startswith<span class=\"ansiyellow\">(</span><span class=\"ansiblue\">&apos;org.apache.spark.sql.AnalysisException: &apos;</span><span class=\"ansiyellow\">)</span><span class=\"ansiyellow\">:</span><span class=\"ansiyellow\"></span>\n<span class=\"ansigreen\">---&gt; 69</span><span class=\"ansiyellow\">                 </span><span class=\"ansigreen\">raise</span> AnalysisException<span class=\"ansiyellow\">(</span>s<span class=\"ansiyellow\">.</span>split<span class=\"ansiyellow\">(</span><span class=\"ansiblue\">&apos;: &apos;</span><span class=\"ansiyellow\">,</span> <span class=\"ansicyan\">1</span><span class=\"ansiyellow\">)</span><span class=\"ansiyellow\">[</span><span class=\"ansicyan\">1</span><span class=\"ansiyellow\">]</span><span class=\"ansiyellow\">,</span> stackTrace<span class=\"ansiyellow\">)</span><span class=\"ansiyellow\"></span>\n<span class=\"ansigreen\">     70</span>             <span class=\"ansigreen\">if</span> s<span class=\"ansiyellow\">.</span>startswith<span class=\"ansiyellow\">(</span><span class=\"ansiblue\">&apos;org.apache.spark.sql.catalyst.analysis&apos;</span><span class=\"ansiyellow\">)</span><span class=\"ansiyellow\">:</span><span class=\"ansiyellow\"></span>\n<span class=\"ansigreen\">     71</span>                 <span class=\"ansigreen\">raise</span> AnalysisException<span class=\"ansiyellow\">(</span>s<span class=\"ansiyellow\">.</span>split<span class=\"ansiyellow\">(</span><span class=\"ansiblue\">&apos;: &apos;</span><span class=\"ansiyellow\">,</span> <span class=\"ansicyan\">1</span><span class=\"ansiyellow\">)</span><span class=\"ansiyellow\">[</span><span class=\"ansicyan\">1</span><span class=\"ansiyellow\">]</span><span class=\"ansiyellow\">,</span> stackTrace<span class=\"ansiyellow\">)</span><span class=\"ansiyellow\"></span>\n\n<span class=\"ansired\">AnalysisException</span>: u&quot;cannot resolve &apos;&#96;disticnt&#96;&apos; given input columns: [bhaskar.boardapprovaldate, bhaskar.mjthemecode, bhaskar.sectorcode, bhaskar.totalamt, bhaskar.productlinetype, bhaskar.supplementprojectflg, bhaskar.lendinginstr, bhaskar.lendprojectcost, bhaskar.sector, bhaskar.ibrdcommamt, bhaskar.sector3, bhaskar._id, bhaskar.theme_namecode, bhaskar.sector1, bhaskar.idacommamt, bhaskar.approvalfy, bhaskar.lendinginstrtype, bhaskar.status, bhaskar.mjtheme, bhaskar.url, bhaskar.mjtheme_namecode, bhaskar.sector_namecode, bhaskar.docty, bhaskar.mjsector_namecode, bhaskar.project_name, bhaskar.countryname, bhaskar.grantamt, bhaskar.projectfinancialtype, bhaskar.project_abstract, bhaskar.prodline, bhaskar.impagency, bhaskar.majorsector_percent, bhaskar.totalcommamt, bhaskar.country_namecode, bhaskar.sector4, bhaskar.sector2, bhaskar.regionname, bhaskar.borrower, bhaskar.prodlinetext, bhaskar.projectdocs, bhaskar.board_approval_month, bhaskar.countrycode, bhaskar.closingdate, bhaskar.source, bhaskar.themecode, bhaskar.envassesmentcategorycode, bhaskar.id, bhaskar.projectstatusdisplay, bhaskar.theme1, bhaskar.countryshortname]; line 1 pos 8;\\n&apos;Project [&apos;disticnt AS approvalfy#2753]\\n+- Filter (countryshortname#2329 = Tunisia)\\n   +- SubqueryAlias bhaskar\\n      +- Relation[_id#2320,approvalfy#2321,board_approval_month#2322,boardapprovaldate#2323,borrower#2324,closingdate#2325,country_namecode#2326,countrycode#2327,countryname#2328,countryshortname#2329,docty#2330,envassesmentcategorycode#2331,grantamt#2332L,ibrdcommamt#2333L,id#2334,idacommamt#2335L,impagency#2336,lendinginstr#2337,lendinginstrtype#2338,lendprojectcost#2339L,majorsector_percent#2340,mjsector_namecode#2341,mjtheme#2342,mjtheme_namecode#2343,... 26 more fields] json\\n&quot;</div>","workflows":[],"startTime":1511425291928,"submitTime":1511425291918,"finishTime":1511425292002,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"34aec06c-0b1c-4d57-b3f0-6859af102808"},{"version":"CommandV1","origId":620808971867617,"guid":"cef3d217-178a-4f00-857e-84d7d366fed8","subtype":"command","commandType":"auto","position":8.0,"command":"df3.show()","commandVersion":0,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\">+----------+\n|approvalfy|\n+----------+\n|      2013|\n|      2015|\n+----------+\n\n</div>","arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[]},"errorSummary":null,"error":null,"workflows":[],"startTime":1511425295666,"submitTime":1511425295655,"finishTime":1511425297079,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"4d8d373f-0f3c-4e5b-8996-7c6be5b6f32e"},{"version":"CommandV1","origId":620808971867618,"guid":"3a1b99e8-2f6f-432c-9ffd-c06192681b20","subtype":"command","commandType":"auto","position":9.0,"command":"df4 = spark.sql(\"SELECT  distinct countryshortname FROM global_temp.bhaskar WHERE approvalfy = '2013' \")","commandVersion":0,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\"></div>","arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[{"name":"df4","typeStr":"pyspark.sql.dataframe.DataFrame","schema":{"fields":[{"metadata":{},"name":"countryshortname","nullable":true,"type":"string"}],"type":"struct"},"tableIdentifier":null}]},"errorSummary":null,"error":null,"workflows":[],"startTime":1511425819949,"submitTime":1511425819938,"finishTime":1511425819992,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"daed70d9-9bec-437f-a609-44e90ebfb94d"},{"version":"CommandV1","origId":620808971867619,"guid":"fa2c6f76-3496-458b-9500-fbe40593f569","subtype":"command","commandType":"auto","position":10.0,"command":"df4.count()","commandVersion":0,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\"><span class=\"ansired\">Out[</span><span class=\"ansired\">40</span><span class=\"ansired\">]: </span>113\n</div>","arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[]},"errorSummary":null,"error":null,"workflows":[],"startTime":1511426067604,"submitTime":1511426067596,"finishTime":1511426068715,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"11fdbe9a-fe3e-4f04-988d-605f761c8022"},{"version":"CommandV1","origId":620808971867620,"guid":"b13e3acf-7f95-4992-93c0-b1cc8171c9cd","subtype":"command","commandType":"auto","position":11.0,"command":"df3 = spark.sql(\"SELECT  distinct approvalfy FROM global_temp.bhaskar WHERE countryshortname = 'Tunisia' \")\ndf4 = spark.sql(\"SELECT  distinct countryshortname FROM global_temp.bhaskar WHERE approvalfy = '2013' \")\nprint df3.show()\nprint df.count()","commandVersion":0,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\">+----------+\n|approvalfy|\n+----------+\n|      2013|\n|      2015|\n+----------+\n\nNone\n500\n</div>","arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[{"name":"df3","typeStr":"pyspark.sql.dataframe.DataFrame","schema":{"fields":[{"metadata":{},"name":"approvalfy","nullable":true,"type":"string"}],"type":"struct"},"tableIdentifier":null},{"name":"df4","typeStr":"pyspark.sql.dataframe.DataFrame","schema":{"fields":[{"metadata":{},"name":"countryshortname","nullable":true,"type":"string"}],"type":"struct"},"tableIdentifier":null}]},"errorSummary":null,"error":null,"workflows":[],"startTime":1511426293314,"submitTime":1511426293306,"finishTime":1511426294330,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"a1f16ccf-ccc0-4da9-b683-53a2911a0ad0"},{"version":"CommandV1","origId":620808971867621,"guid":"e7c58cef-12b1-426a-acfc-a8b15418b358","subtype":"command","commandType":"auto","position":12.0,"command":"zpis = spark.read.json('/FileStore/tables/zips.json')\nstocks = spark.read.json('/FileStore/tables/stocks.json')\nenron = spark.read.json('/FileStore/tables/enron.json')\ncompanies = spark.read.json('/FileStore/tables/companies.json')","commandVersion":0,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\"></div>","arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[{"name":"zpis","typeStr":"pyspark.sql.dataframe.DataFrame","schema":{"fields":[{"metadata":{},"name":"_id","nullable":true,"type":"string"},{"metadata":{},"name":"city","nullable":true,"type":"string"},{"metadata":{},"name":"loc","nullable":true,"type":{"containsNull":true,"elementType":"double","type":"array"}},{"metadata":{},"name":"pop","nullable":true,"type":"long"},{"metadata":{},"name":"state","nullable":true,"type":"string"}],"type":"struct"},"tableIdentifier":null},{"name":"stocks","typeStr":"pyspark.sql.dataframe.DataFrame","schema":{"fields":[{"metadata":{},"name":"20-Day Simple Moving Average","nullable":true,"type":"double"},{"metadata":{},"name":"200-Day Simple Moving Average","nullable":true,"type":"double"},{"metadata":{},"name":"50-Day High","nullable":true,"type":"double"},{"metadata":{},"name":"50-Day Low","nullable":true,"type":"double"},{"metadata":{},"name":"50-Day Simple Moving Average","nullable":true,"type":"double"},{"metadata":{},"name":"52-Week High","nullable":true,"type":"double"},{"metadata":{},"name":"52-Week Low","nullable":true,"type":"double"},{"metadata":{},"name":"Analyst Recom","nullable":true,"type":"double"},{"metadata":{},"name":"Average True Range","nullable":true,"type":"double"},{"metadata":{},"name":"Average Volume","nullable":true,"type":"double"},{"metadata":{},"name":"Beta","nullable":true,"type":"double"},{"metadata":{},"name":"Change","nullable":true,"type":"double"},{"metadata":{},"name":"Change from Open","nullable":true,"type":"double"},{"metadata":{},"name":"Company","nullable":true,"type":"string"},{"metadata":{},"name":"Country","nullable":true,"type":"string"},{"metadata":{},"name":"Current Ratio","nullable":true,"type":"double"},{"metadata":{},"name":"Dividend Yield","nullable":true,"type":"double"},{"metadata":{},"name":"EPS (ttm)","nullable":true,"type":"double"},{"metadata":{},"name":"EPS growth next 5 years","nullable":true,"type":"double"},{"metadata":{},"name":"EPS growth next year","nullable":true,"type":"double"},{"metadata":{},"name":"EPS growth past 5 years","nullable":true,"type":"double"},{"metadata":{},"name":"EPS growth quarter over quarter","nullable":true,"type":"double"},{"metadata":{},"name":"EPS growth this year","nullable":true,"type":"double"},{"metadata":{},"name":"Earnings Date","nullable":true,"type":{"fields":[{"metadata":{},"name":"$date","nullable":true,"type":"long"}],"type":"struct"}},{"metadata":{},"name":"Float Short","nullable":true,"type":"double"},{"metadata":{},"name":"Forward P/E","nullable":true,"type":"double"},{"metadata":{},"name":"Gap","nullable":true,"type":"double"},{"metadata":{},"name":"Gross Margin","nullable":true,"type":"double"},{"metadata":{},"name":"Industry","nullable":true,"type":"string"},{"metadata":{},"name":"Insider Ownership","nullable":true,"type":"double"},{"metadata":{},"name":"Insider Transactions","nullable":true,"type":"double"},{"metadata":{},"name":"Institutional Ownership","nullable":true,"type":"double"},{"metadata":{},"name":"Institutional Transactions","nullable":true,"type":"double"},{"metadata":{},"name":"LT Debt/Equity","nullable":true,"type":"double"},{"metadata":{},"name":"Market Cap","nullable":true,"type":"double"},{"metadata":{},"name":"Operating Margin","nullable":true,"type":"double"},{"metadata":{},"name":"P/B","nullable":true,"type":"double"},{"metadata":{},"name":"P/Cash","nullable":true,"type":"double"},{"metadata":{},"name":"P/E","nullable":true,"type":"double"},{"metadata":{},"name":"P/Free Cash Flow","nullable":true,"type":"double"},{"metadata":{},"name":"P/S","nullable":true,"type":"double"},{"metadata":{},"name":"PEG","nullable":true,"type":"double"},{"metadata":{},"name":"Payout Ratio","nullable":true,"type":"double"},{"metadata":{},"name":"Performance (Half Year)","nullable":true,"type":"double"},{"metadata":{},"name":"Performance (Month)","nullable":true,"type":"double"},{"metadata":{},"name":"Performance (Quarter)","nullable":true,"type":"double"},{"metadata":{},"name":"Performance (Week)","nullable":true,"type":"double"},{"metadata":{},"name":"Performance (YTD)","nullable":true,"type":"double"},{"metadata":{},"name":"Performance (Year)","nullable":true,"type":"double"},{"metadata":{},"name":"Price","nullable":true,"type":"double"},{"metadata":{},"name":"Profit Margin","nullable":true,"type":"double"},{"metadata":{},"name":"Quick Ratio","nullable":true,"type":"double"},{"metadata":{},"name":"Relative Strength Index (14)","nullable":true,"type":"double"},{"metadata":{},"name":"Relative Volume","nullable":true,"type":"double"},{"metadata":{},"name":"Return on Assets","nullable":true,"type":"double"},{"metadata":{},"name":"Return on Equity","nullable":true,"type":"double"},{"metadata":{},"name":"Return on Investment","nullable":true,"type":"double"},{"metadata":{},"name":"Sales growth past 5 years","nullable":true,"type":"double"},{"metadata":{},"name":"Sales growth quarter over quarter","nullable":true,"type":"double"},{"metadata":{},"name":"Sector","nullable":true,"type":"string"},{"metadata":{},"name":"Shares Float","nullable":true,"type":"double"},{"metadata":{},"name":"Shares Outstanding","nullable":true,"type":"double"},{"metadata":{},"name":"Short Ratio","nullable":true,"type":"double"},{"metadata":{},"name":"Ticker","nullable":true,"type":"string"},{"metadata":{},"name":"Total Debt/Equity","nullable":true,"type":"double"},{"metadata":{},"name":"Volatility (Month)","nullable":true,"type":"double"},{"metadata":{},"name":"Volatility (Week)","nullable":true,"type":"double"},{"metadata":{},"name":"Volume","nullable":true,"type":"long"},{"metadata":{},"name":"_id","nullable":true,"type":{"fields":[{"metadata":{},"name":"$oid","nullable":true,"type":"string"}],"type":"struct"}}],"type":"struct"},"tableIdentifier":null},{"name":"enron","typeStr":"pyspark.sql.dataframe.DataFrame","schema":{"fields":[{"metadata":{},"name":"_id","nullable":true,"type":{"fields":[{"metadata":{},"name":"$oid","nullable":true,"type":"string"}],"type":"struct"}},{"metadata":{},"name":"bcc","nullable":true,"type":{"containsNull":true,"elementType":"string","type":"array"}},{"metadata":{},"name":"cc","nullable":true,"type":{"containsNull":true,"elementType":"string","type":"array"}},{"metadata":{},"name":"ctype","nullable":true,"type":"string"},{"metadata":{},"name":"date","nullable":true,"type":"string"},{"metadata":{},"name":"fname","nullable":true,"type":"string"},{"metadata":{},"name":"folder","nullable":true,"type":"string"},{"metadata":{},"name":"fpath","nullable":true,"type":"string"},{"metadata":{},"name":"mid","nullable":true,"type":"string"},{"metadata":{},"name":"recipients","nullable":true,"type":{"containsNull":true,"elementType":"string","type":"array"}},{"metadata":{},"name":"replyto","nullable":true,"type":"string"},{"metadata":{},"name":"sender","nullable":true,"type":"string"},{"metadata":{},"name":"subject","nullable":true,"type":"string"},{"metadata":{},"name":"text","nullable":true,"type":"string"},{"metadata":{},"name":"to","nullable":true,"type":{"containsNull":true,"elementType":"string","type":"array"}}],"type":"struct"},"tableIdentifier":null},{"name":"companies","typeStr":"pyspark.sql.dataframe.DataFrame","schema":{"fields":[{"metadata":{},"name":"_id","nullable":true,"type":{"fields":[{"metadata":{},"name":"$oid","nullable":true,"type":"string"}],"type":"struct"}},{"metadata":{},"name":"acquisition","nullable":true,"type":{"fields":[{"metadata":{},"name":"acquired_day","nullable":true,"type":"long"},{"metadata":{},"name":"acquired_month","nullable":true,"type":"long"},{"metadata":{},"name":"acquired_year","nullable":true,"type":"long"},{"metadata":{},"name":"acquiring_company","nullable":true,"type":{"fields":[{"metadata":{},"name":"name","nullable":true,"type":"string"},{"metadata":{},"name":"permalink","nullable":true,"type":"string"}],"type":"struct"}},{"metadata":{},"name":"price_amount","nullable":true,"type":"long"},{"metadata":{},"name":"price_currency_code","nullable":true,"type":"string"},{"metadata":{},"name":"source_description","nullable":true,"type":"string"},{"metadata":{},"name":"source_url","nullable":true,"type":"string"},{"metadata":{},"name":"term_code","nullable":true,"type":"string"}],"type":"struct"}},{"metadata":{},"name":"acquisitions","nullable":true,"type":{"containsNull":true,"elementType":{"fields":[{"metadata":{},"name":"acquired_day","nullable":true,"type":"long"},{"metadata":{},"name":"acquired_month","nullable":true,"type":"long"},{"metadata":{},"name":"acquired_year","nullable":true,"type":"long"},{"metadata":{},"name":"company","nullable":true,"type":{"fields":[{"metadata":{},"name":"name","nullable":true,"type":"string"},{"metadata":{},"name":"permalink","nullable":true,"type":"string"}],"type":"struct"}},{"metadata":{},"name":"price_amount","nullable":true,"type":"double"},{"metadata":{},"name":"price_currency_code","nullable":true,"type":"string"},{"metadata":{},"name":"source_description","nullable":true,"type":"string"},{"metadata":{},"name":"source_url","nullable":true,"type":"string"},{"metadata":{},"name":"term_code","nullable":true,"type":"string"}],"type":"struct"},"type":"array"}},{"metadata":{},"name":"alias_list","nullable":true,"type":"string"},{"metadata":{},"name":"blog_feed_url","nullable":true,"type":"string"},{"metadata":{},"name":"blog_url","nullable":true,"type":"string"},{"metadata":{},"name":"category_code","nullable":true,"type":"string"},{"metadata":{},"name":"competitions","nullable":true,"type":{"containsNull":true,"elementType":{"fields":[{"metadata":{},"name":"competitor","nullable":true,"type":{"fields":[{"metadata":{},"name":"name","nullable":true,"type":"string"},{"metadata":{},"name":"permalink","nullable":true,"type":"string"}],"type":"struct"}}],"type":"struct"},"type":"array"}},{"metadata":{},"name":"created_at","nullable":true,"type":"string"},{"metadata":{},"name":"crunchbase_url","nullable":true,"type":"string"},{"metadata":{},"name":"deadpooled_day","nullable":true,"type":"long"},{"metadata":{},"name":"deadpooled_month","nullable":true,"type":"long"},{"metadata":{},"name":"deadpooled_url","nullable":true,"type":"string"},{"metadata":{},"name":"deadpooled_year","nullable":true,"type":"long"},{"metadata":{},"name":"description","nullable":true,"type":"string"},{"metadata":{},"name":"email_address","nullable":true,"type":"string"},{"metadata":{},"name":"external_links","nullable":true,"type":{"containsNull":true,"elementType":{"fields":[{"metadata":{},"name":"external_url","nullable":true,"type":"string"},{"metadata":{},"name":"title","nullable":true,"type":"string"}],"type":"struct"},"type":"array"}},{"metadata":{},"name":"founded_day","nullable":true,"type":"long"},{"metadata":{},"name":"founded_month","nullable":true,"type":"long"},{"metadata":{},"name":"founded_year","nullable":true,"type":"long"},{"metadata":{},"name":"funding_rounds","nullable":true,"type":{"containsNull":true,"elementType":{"fields":[{"metadata":{},"name":"funded_day","nullable":true,"type":"long"},{"metadata":{},"name":"funded_month","nullable":true,"type":"long"},{"metadata":{},"name":"funded_year","nullable":true,"type":"long"},{"metadata":{},"name":"id","nullable":true,"type":"long"},{"metadata":{},"name":"investments","nullable":true,"type":{"containsNull":true,"elementType":{"fields":[{"metadata":{},"name":"company","nullable":true,"type":{"fields":[{"metadata":{},"name":"name","nullable":true,"type":"string"},{"metadata":{},"name":"permalink","nullable":true,"type":"string"}],"type":"struct"}},{"metadata":{},"name":"financial_org","nullable":true,"type":{"fields":[{"metadata":{},"name":"name","nullable":true,"type":"string"},{"metadata":{},"name":"permalink","nullable":true,"type":"string"}],"type":"struct"}},{"metadata":{},"name":"person","nullable":true,"type":{"fields":[{"metadata":{},"name":"first_name","nullable":true,"type":"string"},{"metadata":{},"name":"last_name","nullable":true,"type":"string"},{"metadata":{},"name":"permalink","nullable":true,"type":"string"}],"type":"struct"}}],"type":"struct"},"type":"array"}},{"metadata":{},"name":"raised_amount","nullable":true,"type":"double"},{"metadata":{},"name":"raised_currency_code","nullable":true,"type":"string"},{"metadata":{},"name":"round_code","nullable":true,"type":"string"},{"metadata":{},"name":"source_description","nullable":true,"type":"string"},{"metadata":{},"name":"source_url","nullable":true,"type":"string"}],"type":"struct"},"type":"array"}},{"metadata":{},"name":"homepage_url","nullable":true,"type":"string"},{"metadata":{},"name":"image","nullable":true,"type":{"fields":[{"metadata":{},"name":"attribution","nullable":true,"type":"string"},{"metadata":{},"name":"available_sizes","nullable":true,"type":{"containsNull":true,"elementType":{"containsNull":true,"elementType":"string","type":"array"},"type":"array"}}],"type":"struct"}},{"metadata":{},"name":"investments","nullable":true,"type":{"containsNull":true,"elementType":{"fields":[{"metadata":{},"name":"funding_round","nullable":true,"type":{"fields":[{"metadata":{},"name":"company","nullable":true,"type":{"fields":[{"metadata":{},"name":"name","nullable":true,"type":"string"},{"metadata":{},"name":"permalink","nullable":true,"type":"string"}],"type":"struct"}},{"metadata":{},"name":"funded_day","nullable":true,"type":"long"},{"metadata":{},"name":"funded_month","nullable":true,"type":"long"},{"metadata":{},"name":"funded_year","nullable":true,"type":"long"},{"metadata":{},"name":"raised_amount","nullable":true,"type":"long"},{"metadata":{},"name":"raised_currency_code","nullable":true,"type":"string"},{"metadata":{},"name":"round_code","nullable":true,"type":"string"},{"metadata":{},"name":"source_description","nullable":true,"type":"string"},{"metadata":{},"name":"source_url","nullable":true,"type":"string"}],"type":"struct"}}],"type":"struct"},"type":"array"}},{"metadata":{},"name":"ipo","nullable":true,"type":{"fields":[{"metadata":{},"name":"pub_day","nullable":true,"type":"long"},{"metadata":{},"name":"pub_month","nullable":true,"type":"long"},{"metadata":{},"name":"pub_year","nullable":true,"type":"long"},{"metadata":{},"name":"stock_symbol","nullable":true,"type":"string"},{"metadata":{},"name":"valuation_amount","nullable":true,"type":"long"},{"metadata":{},"name":"valuation_currency_code","nullable":true,"type":"string"}],"type":"struct"}},{"metadata":{},"name":"milestones","nullable":true,"type":{"containsNull":true,"elementType":{"fields":[{"metadata":{},"name":"description","nullable":true,"type":"string"},{"metadata":{},"name":"id","nullable":true,"type":"long"},{"metadata":{},"name":"source_description","nullable":true,"type":"string"},{"metadata":{},"name":"source_text","nullable":true,"type":"string"},{"metadata":{},"name":"source_url","nullable":true,"type":"string"},{"metadata":{},"name":"stoneable","nullable":true,"type":{"fields":[{"metadata":{},"name":"name","nullable":true,"type":"string"},{"metadata":{},"name":"permalink","nullable":true,"type":"string"}],"type":"struct"}},{"metadata":{},"name":"stoneable_type","nullable":true,"type":"string"},{"metadata":{},"name":"stoned_acquirer","nullable":true,"type":"string"},{"metadata":{},"name":"stoned_day","nullable":true,"type":"long"},{"metadata":{},"name":"stoned_month","nullable":true,"type":"long"},{"metadata":{},"name":"stoned_value","nullable":true,"type":"string"},{"metadata":{},"name":"stoned_value_type","nullable":true,"type":"string"},{"metadata":{},"name":"stoned_year","nullable":true,"type":"long"}],"type":"struct"},"type":"array"}},{"metadata":{},"name":"name","nullable":true,"type":"string"},{"metadata":{},"name":"number_of_employees","nullable":true,"type":"long"},{"metadata":{},"name":"offices","nullable":true,"type":{"containsNull":true,"elementType":{"fields":[{"metadata":{},"name":"address1","nullable":true,"type":"string"},{"metadata":{},"name":"address2","nullable":true,"type":"string"},{"metadata":{},"name":"city","nullable":true,"type":"string"},{"metadata":{},"name":"country_code","nullable":true,"type":"string"},{"metadata":{},"name":"description","nullable":true,"type":"string"},{"metadata":{},"name":"latitude","nullable":true,"type":"double"},{"metadata":{},"name":"longitude","nullable":true,"type":"double"},{"metadata":{},"name":"state_code","nullable":true,"type":"string"},{"metadata":{},"name":"zip_code","nullable":true,"type":"string"}],"type":"struct"},"type":"array"}},{"metadata":{},"name":"overview","nullable":true,"type":"string"},{"metadata":{},"name":"partners","nullable":true,"type":{"containsNull":true,"elementType":{"fields":[{"metadata":{},"name":"homepage_url","nullable":true,"type":"string"},{"metadata":{},"name":"link_1_name","nullable":true,"type":"string"},{"metadata":{},"name":"link_1_url","nullable":true,"type":"string"},{"metadata":{},"name":"link_2_name","nullable":true,"type":"string"},{"metadata":{},"name":"link_2_url","nullable":true,"type":"string"},{"metadata":{},"name":"link_3_name","nullable":true,"type":"string"},{"metadata":{},"name":"link_3_url","nullable":true,"type":"string"},{"metadata":{},"name":"partner_name","nullable":true,"type":"string"}],"type":"struct"},"type":"array"}},{"metadata":{},"name":"permalink","nullable":true,"type":"string"},{"metadata":{},"name":"phone_number","nullable":true,"type":"string"},{"metadata":{},"name":"products","nullable":true,"type":{"containsNull":true,"elementType":{"fields":[{"metadata":{},"name":"name","nullable":true,"type":"string"},{"metadata":{},"name":"permalink","nullable":true,"type":"string"}],"type":"struct"},"type":"array"}},{"metadata":{},"name":"providerships","nullable":true,"type":{"containsNull":true,"elementType":{"fields":[{"metadata":{},"name":"is_past","nullable":true,"type":"boolean"},{"metadata":{},"name":"provider","nullable":true,"type":{"fields":[{"metadata":{},"name":"name","nullable":true,"type":"string"},{"metadata":{},"name":"permalink","nullable":true,"type":"string"}],"type":"struct"}},{"metadata":{},"name":"title","nullable":true,"type":"string"}],"type":"struct"},"type":"array"}},{"metadata":{},"name":"relationships","nullable":true,"type":{"containsNull":true,"elementType":{"fields":[{"metadata":{},"name":"is_past","nullable":true,"type":"boolean"},{"metadata":{},"name":"person","nullable":true,"type":{"fields":[{"metadata":{},"name":"first_name","nullable":true,"type":"string"},{"metadata":{},"name":"last_name","nullable":true,"type":"string"},{"metadata":{},"name":"permalink","nullable":true,"type":"string"}],"type":"struct"}},{"metadata":{},"name":"title","nullable":true,"type":"string"}],"type":"struct"},"type":"array"}},{"metadata":{},"name":"screenshots","nullable":true,"type":{"containsNull":true,"elementType":{"fields":[{"metadata":{},"name":"attribution","nullable":true,"type":"string"},{"metadata":{},"name":"available_sizes","nullable":true,"type":{"containsNull":true,"elementType":{"containsNull":true,"elementType":"string","type":"array"},"type":"array"}}],"type":"struct"},"type":"array"}},{"metadata":{},"name":"tag_list","nullable":true,"type":"string"},{"metadata":{},"name":"total_money_raised","nullable":true,"type":"string"},{"metadata":{},"name":"twitter_username","nullable":true,"type":"string"},{"metadata":{},"name":"updated_at","nullable":true,"type":"string"},{"metadata":{},"name":"video_embeds","nullable":true,"type":{"containsNull":true,"elementType":{"fields":[{"metadata":{},"name":"description","nullable":true,"type":"string"},{"metadata":{},"name":"embed_code","nullable":true,"type":"string"}],"type":"struct"},"type":"array"}}],"type":"struct"},"tableIdentifier":null}]},"errorSummary":null,"error":null,"workflows":[],"startTime":1511435835242,"submitTime":1511435835220,"finishTime":1511435838505,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"32334e4e-17e1-4249-92dd-c8a815a66e2f"},{"version":"CommandV1","origId":620808971867622,"guid":"23787159-4e55-498e-80aa-4bd7bb897777","subtype":"command","commandType":"auto","position":13.0,"command":"enron.printSchema()","commandVersion":0,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\">root\n |-- _id: struct (nullable = true)\n |    |-- $oid: string (nullable = true)\n |-- bcc: array (nullable = true)\n |    |-- element: string (containsNull = true)\n |-- cc: array (nullable = true)\n |    |-- element: string (containsNull = true)\n |-- ctype: string (nullable = true)\n |-- date: string (nullable = true)\n |-- fname: string (nullable = true)\n |-- folder: string (nullable = true)\n |-- fpath: string (nullable = true)\n |-- mid: string (nullable = true)\n |-- recipients: array (nullable = true)\n |    |-- element: string (containsNull = true)\n |-- replyto: string (nullable = true)\n |-- sender: string (nullable = true)\n |-- subject: string (nullable = true)\n |-- text: string (nullable = true)\n |-- to: array (nullable = true)\n |    |-- element: string (containsNull = true)\n\n</div>","arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[]},"errorSummary":null,"error":null,"workflows":[],"startTime":1511437962136,"submitTime":1511437962130,"finishTime":1511437962217,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"88d0af8c-1644-4e00-9fe4-2df4aa129131"},{"version":"CommandV1","origId":620808971867623,"guid":"3059bf30-5bf0-4a2a-9c50-6a3e9d92e7ed","subtype":"command","commandType":"auto","position":14.0,"command":"from pyspark.sql.functions import *\nfrom pyspark.sql.types import *\n\ndef getter(column):\n\n    for i,col in enumerate(column):\n        if i==1:\n           col_new=col\n        else:\n           col_new=col_new+','+col\n    return col_new\n\ngetterUDF = udf(getter, StringType())\n\ndf.select(getterUDF(enron.cc))","commandVersion":0,"state":"error","results":{"type":"html","data":"<div class=\"ansiout\"></div>","arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[]},"errorSummary":"<span class=\"ansired\">AnalysisException</span>: u&apos;resolved attribute(s) cc#3904 missing from country_namecode#87,countryshortname#90,countrycode#88,prodlinetext#107,mjsector_namecode#102,borrower#85,docty#91,mjtheme_namecode#104,board_approval_month#83,projectstatusdisplay#113,sector4#119,approvalfy#82,majorsector_percent#101,closingdate#86,totalcommamt#129L,sector2#117,idacommamt#96L,theme1#125,totalamt#128L,project_abstract#109,id#95,lendinginstr#98,_id#81,productlinetype#108,envassesmentcategorycode#92,lendinginstrtype#99,sector3#118,sector#115,mjtheme#103,boardapprovaldate#84,sector1#116,prodline#106,sectorcode#121,projectfinancialtype#112,projectdocs#111,source#122,theme_namecode#126,lendprojectcost#100L,countryname#89,grantamt#93L,impagency#97,themecode#127,supplementprojectflg#124,project_name#110,status#123,url#130,regionname#114,mjthemecode#105,sector_namecode#120,ibrdcommamt#94L in operator !Project [getter(cc#3904) AS getter(cc)#4294];;\\n!Project [getter(cc#3904) AS getter(cc)#4294]\\n+- Relation[_id#81,approvalfy#82,board_approval_month#83,boardapprovaldate#84,borrower#85,closingdate#86,country_namecode#87,countrycode#88,countryname#89,countryshortname#90,docty#91,envassesmentcategorycode#92,grantamt#93L,ibrdcommamt#94L,id#95,idacommamt#96L,impagency#97,lendinginstr#98,lendinginstrtype#99,lendprojectcost#100L,majorsector_percent#101,mjsector_namecode#102,mjtheme#103,mjtheme_namecode#104,... 26 more fields] json\\n&apos;","error":"<div class=\"ansiout\"><span class=\"ansired\">---------------------------------------------------------------------------</span>\n<span class=\"ansired\">AnalysisException</span>                         Traceback (most recent call last)\n<span class=\"ansigreen\">&lt;command-620808971867623&gt;</span> in <span class=\"ansicyan\">&lt;module&gt;</span><span class=\"ansiblue\">()</span>\n<span class=\"ansigreen\">     13</span> getterUDF <span class=\"ansiyellow\">=</span> udf<span class=\"ansiyellow\">(</span>getter<span class=\"ansiyellow\">,</span> StringType<span class=\"ansiyellow\">(</span><span class=\"ansiyellow\">)</span><span class=\"ansiyellow\">)</span><span class=\"ansiyellow\"></span>\n<span class=\"ansigreen\">     14</span> <span class=\"ansiyellow\"></span>\n<span class=\"ansigreen\">---&gt; 15</span><span class=\"ansiyellow\"> </span>df<span class=\"ansiyellow\">.</span>select<span class=\"ansiyellow\">(</span>getterUDF<span class=\"ansiyellow\">(</span>enron<span class=\"ansiyellow\">.</span>cc<span class=\"ansiyellow\">)</span><span class=\"ansiyellow\">)</span><span class=\"ansiyellow\"></span>\n\n<span class=\"ansigreen\">/databricks/spark/python/pyspark/sql/dataframe.pyc</span> in <span class=\"ansicyan\">select</span><span class=\"ansiblue\">(self, *cols)</span>\n<span class=\"ansigreen\">   1041</span>         <span class=\"ansiyellow\">[</span>Row<span class=\"ansiyellow\">(</span>name<span class=\"ansiyellow\">=</span><span class=\"ansiblue\">u&apos;Alice&apos;</span><span class=\"ansiyellow\">,</span> age<span class=\"ansiyellow\">=</span><span class=\"ansicyan\">12</span><span class=\"ansiyellow\">)</span><span class=\"ansiyellow\">,</span> Row<span class=\"ansiyellow\">(</span>name<span class=\"ansiyellow\">=</span><span class=\"ansiblue\">u&apos;Bob&apos;</span><span class=\"ansiyellow\">,</span> age<span class=\"ansiyellow\">=</span><span class=\"ansicyan\">15</span><span class=\"ansiyellow\">)</span><span class=\"ansiyellow\">]</span><span class=\"ansiyellow\"></span>\n<span class=\"ansigreen\">   1042</span>         &quot;&quot;&quot;\n<span class=\"ansigreen\">-&gt; 1043</span><span class=\"ansiyellow\">         </span>jdf <span class=\"ansiyellow\">=</span> self<span class=\"ansiyellow\">.</span>_jdf<span class=\"ansiyellow\">.</span>select<span class=\"ansiyellow\">(</span>self<span class=\"ansiyellow\">.</span>_jcols<span class=\"ansiyellow\">(</span><span class=\"ansiyellow\">*</span>cols<span class=\"ansiyellow\">)</span><span class=\"ansiyellow\">)</span><span class=\"ansiyellow\"></span>\n<span class=\"ansigreen\">   1044</span>         <span class=\"ansigreen\">return</span> DataFrame<span class=\"ansiyellow\">(</span>jdf<span class=\"ansiyellow\">,</span> self<span class=\"ansiyellow\">.</span>sql_ctx<span class=\"ansiyellow\">)</span><span class=\"ansiyellow\"></span>\n<span class=\"ansigreen\">   1045</span> <span class=\"ansiyellow\"></span>\n\n<span class=\"ansigreen\">/databricks/spark/python/lib/py4j-0.10.4-src.zip/py4j/java_gateway.py</span> in <span class=\"ansicyan\">__call__</span><span class=\"ansiblue\">(self, *args)</span>\n<span class=\"ansigreen\">   1131</span>         answer <span class=\"ansiyellow\">=</span> self<span class=\"ansiyellow\">.</span>gateway_client<span class=\"ansiyellow\">.</span>send_command<span class=\"ansiyellow\">(</span>command<span class=\"ansiyellow\">)</span><span class=\"ansiyellow\"></span>\n<span class=\"ansigreen\">   1132</span>         return_value = get_return_value(\n<span class=\"ansigreen\">-&gt; 1133</span><span class=\"ansiyellow\">             answer, self.gateway_client, self.target_id, self.name)\n</span><span class=\"ansigreen\">   1134</span> <span class=\"ansiyellow\"></span>\n<span class=\"ansigreen\">   1135</span>         <span class=\"ansigreen\">for</span> temp_arg <span class=\"ansigreen\">in</span> temp_args<span class=\"ansiyellow\">:</span><span class=\"ansiyellow\"></span>\n\n<span class=\"ansigreen\">/databricks/spark/python/pyspark/sql/utils.pyc</span> in <span class=\"ansicyan\">deco</span><span class=\"ansiblue\">(*a, **kw)</span>\n<span class=\"ansigreen\">     67</span>                                              e.java_exception.getStackTrace()))\n<span class=\"ansigreen\">     68</span>             <span class=\"ansigreen\">if</span> s<span class=\"ansiyellow\">.</span>startswith<span class=\"ansiyellow\">(</span><span class=\"ansiblue\">&apos;org.apache.spark.sql.AnalysisException: &apos;</span><span class=\"ansiyellow\">)</span><span class=\"ansiyellow\">:</span><span class=\"ansiyellow\"></span>\n<span class=\"ansigreen\">---&gt; 69</span><span class=\"ansiyellow\">                 </span><span class=\"ansigreen\">raise</span> AnalysisException<span class=\"ansiyellow\">(</span>s<span class=\"ansiyellow\">.</span>split<span class=\"ansiyellow\">(</span><span class=\"ansiblue\">&apos;: &apos;</span><span class=\"ansiyellow\">,</span> <span class=\"ansicyan\">1</span><span class=\"ansiyellow\">)</span><span class=\"ansiyellow\">[</span><span class=\"ansicyan\">1</span><span class=\"ansiyellow\">]</span><span class=\"ansiyellow\">,</span> stackTrace<span class=\"ansiyellow\">)</span><span class=\"ansiyellow\"></span>\n<span class=\"ansigreen\">     70</span>             <span class=\"ansigreen\">if</span> s<span class=\"ansiyellow\">.</span>startswith<span class=\"ansiyellow\">(</span><span class=\"ansiblue\">&apos;org.apache.spark.sql.catalyst.analysis&apos;</span><span class=\"ansiyellow\">)</span><span class=\"ansiyellow\">:</span><span class=\"ansiyellow\"></span>\n<span class=\"ansigreen\">     71</span>                 <span class=\"ansigreen\">raise</span> AnalysisException<span class=\"ansiyellow\">(</span>s<span class=\"ansiyellow\">.</span>split<span class=\"ansiyellow\">(</span><span class=\"ansiblue\">&apos;: &apos;</span><span class=\"ansiyellow\">,</span> <span class=\"ansicyan\">1</span><span class=\"ansiyellow\">)</span><span class=\"ansiyellow\">[</span><span class=\"ansicyan\">1</span><span class=\"ansiyellow\">]</span><span class=\"ansiyellow\">,</span> stackTrace<span class=\"ansiyellow\">)</span><span class=\"ansiyellow\"></span>\n\n<span class=\"ansired\">AnalysisException</span>: u&apos;resolved attribute(s) cc#3904 missing from country_namecode#87,countryshortname#90,countrycode#88,prodlinetext#107,mjsector_namecode#102,borrower#85,docty#91,mjtheme_namecode#104,board_approval_month#83,projectstatusdisplay#113,sector4#119,approvalfy#82,majorsector_percent#101,closingdate#86,totalcommamt#129L,sector2#117,idacommamt#96L,theme1#125,totalamt#128L,project_abstract#109,id#95,lendinginstr#98,_id#81,productlinetype#108,envassesmentcategorycode#92,lendinginstrtype#99,sector3#118,sector#115,mjtheme#103,boardapprovaldate#84,sector1#116,prodline#106,sectorcode#121,projectfinancialtype#112,projectdocs#111,source#122,theme_namecode#126,lendprojectcost#100L,countryname#89,grantamt#93L,impagency#97,themecode#127,supplementprojectflg#124,project_name#110,status#123,url#130,regionname#114,mjthemecode#105,sector_namecode#120,ibrdcommamt#94L in operator !Project [getter(cc#3904) AS getter(cc)#4294];;\\n!Project [getter(cc#3904) AS getter(cc)#4294]\\n+- Relation[_id#81,approvalfy#82,board_approval_month#83,boardapprovaldate#84,borrower#85,closingdate#86,country_namecode#87,countrycode#88,countryname#89,countryshortname#90,docty#91,envassesmentcategorycode#92,grantamt#93L,ibrdcommamt#94L,id#95,idacommamt#96L,impagency#97,lendinginstr#98,lendinginstrtype#99,lendprojectcost#100L,majorsector_percent#101,mjsector_namecode#102,mjtheme#103,mjtheme_namecode#104,... 26 more fields] json\\n&apos;</div>","workflows":[],"startTime":1511443563108,"submitTime":1511443563108,"finishTime":1511443563217,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"2a06a872-0ca9-40e0-901e-03d985f6ae38"},{"version":"CommandV1","origId":620808971867624,"guid":"36d83c17-5205-41d2-ba76-fb37f19c7b8c","subtype":"command","commandType":"auto","position":15.0,"command":"#zpis[['loc']].show()\nfrom pyspark.sql.functions import to_json, from_json, col, struct, lit\nfrom pyspark.sql.types import StructType, StructField\nfrom pyspark.ml.linalg import VectorUDT\n\njson_vec = to_json(struct(struct(\n    lit(1).alias(\"type\"),  # type 1 is dense, type 0 is sparse\n    col(\"zpis.loc\").alias(\"values\")\n).alias(\"v\")))\n\nschema = StructType([StructField(\"v\", VectorUDT())])\n\nwith_parsed_vector = df.withColumn(\n    \"parsed_vector\", from_json(json_vec, schema).getItem(\"v\")\n)\n\nwith_parsed_vector.show()","commandVersion":0,"state":"error","results":{"type":"html","data":"<div class=\"ansiout\"></div>","arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[]},"errorSummary":"<span class=\"ansired\">AnalysisException</span>: u&quot;cannot resolve &apos;&#96;zpis.loc&#96;&apos; given input columns: [country_namecode, countryshortname, countrycode, prodlinetext, mjsector_namecode, borrower, docty, mjtheme_namecode, board_approval_month, projectstatusdisplay, sector4, approvalfy, majorsector_percent, closingdate, totalcommamt, sector2, idacommamt, theme1, totalamt, project_abstract, id, lendinginstr, _id, productlinetype, envassesmentcategorycode, lendinginstrtype, sector3, sector, mjtheme, boardapprovaldate, sector1, prodline, sectorcode, projectfinancialtype, projectdocs, source, theme_namecode, lendprojectcost, countryname, grantamt, impagency, themecode, supplementprojectflg, project_name, status, url, regionname, mjthemecode, sector_namecode, ibrdcommamt];;\\n&apos;Project [_id#81, approvalfy#82, board_approval_month#83, boardapprovaldate#84, borrower#85, closingdate#86, country_namecode#87, countrycode#88, countryname#89, countryshortname#90, docty#91, envassesmentcategorycode#92, grantamt#93L, ibrdcommamt#94L, id#95, idacommamt#96L, impagency#97, lendinginstr#98, lendinginstrtype#99, lendprojectcost#100L, majorsector_percent#101, mjsector_namecode#102, mjtheme#103, mjtheme_namecode#104, ... 27 more fields]\\n+- Relation[_id#81,approvalfy#82,board_approval_month#83,boardapprovaldate#84,borrower#85,closingdate#86,country_namecode#87,countrycode#88,countryname#89,countryshortname#90,docty#91,envassesmentcategorycode#92,grantamt#93L,ibrdcommamt#94L,id#95,idacommamt#96L,impagency#97,lendinginstr#98,lendinginstrtype#99,lendprojectcost#100L,majorsector_percent#101,mjsector_namecode#102,mjtheme#103,mjtheme_namecode#104,... 26 more fields] json\\n&quot;","error":"<div class=\"ansiout\"><span class=\"ansired\">---------------------------------------------------------------------------</span>\n<span class=\"ansired\">AnalysisException</span>                         Traceback (most recent call last)\n<span class=\"ansigreen\">&lt;command-620808971867624&gt;</span> in <span class=\"ansicyan\">&lt;module&gt;</span><span class=\"ansiblue\">()</span>\n<span class=\"ansigreen\">     12</span> <span class=\"ansiyellow\"></span>\n<span class=\"ansigreen\">     13</span> with_parsed_vector = df.withColumn(\n<span class=\"ansigreen\">---&gt; 14</span><span class=\"ansiyellow\">     </span><span class=\"ansiblue\">&quot;parsed_vector&quot;</span><span class=\"ansiyellow\">,</span> from_json<span class=\"ansiyellow\">(</span>json_vec<span class=\"ansiyellow\">,</span> schema<span class=\"ansiyellow\">)</span><span class=\"ansiyellow\">.</span>getItem<span class=\"ansiyellow\">(</span><span class=\"ansiblue\">&quot;v&quot;</span><span class=\"ansiyellow\">)</span><span class=\"ansiyellow\"></span>\n<span class=\"ansigreen\">     15</span> )\n<span class=\"ansigreen\">     16</span> <span class=\"ansiyellow\"></span>\n\n<span class=\"ansigreen\">/databricks/spark/python/pyspark/sql/dataframe.pyc</span> in <span class=\"ansicyan\">withColumn</span><span class=\"ansiblue\">(self, colName, col)</span>\n<span class=\"ansigreen\">   1621</span>         &quot;&quot;&quot;\n<span class=\"ansigreen\">   1622</span>         <span class=\"ansigreen\">assert</span> isinstance<span class=\"ansiyellow\">(</span>col<span class=\"ansiyellow\">,</span> Column<span class=\"ansiyellow\">)</span><span class=\"ansiyellow\">,</span> <span class=\"ansiblue\">&quot;col should be Column&quot;</span><span class=\"ansiyellow\"></span>\n<span class=\"ansigreen\">-&gt; 1623</span><span class=\"ansiyellow\">         </span><span class=\"ansigreen\">return</span> DataFrame<span class=\"ansiyellow\">(</span>self<span class=\"ansiyellow\">.</span>_jdf<span class=\"ansiyellow\">.</span>withColumn<span class=\"ansiyellow\">(</span>colName<span class=\"ansiyellow\">,</span> col<span class=\"ansiyellow\">.</span>_jc<span class=\"ansiyellow\">)</span><span class=\"ansiyellow\">,</span> self<span class=\"ansiyellow\">.</span>sql_ctx<span class=\"ansiyellow\">)</span><span class=\"ansiyellow\"></span>\n<span class=\"ansigreen\">   1624</span> <span class=\"ansiyellow\"></span>\n<span class=\"ansigreen\">   1625</span>     <span class=\"ansiyellow\">@</span>ignore_unicode_prefix<span class=\"ansiyellow\"></span>\n\n<span class=\"ansigreen\">/databricks/spark/python/lib/py4j-0.10.4-src.zip/py4j/java_gateway.py</span> in <span class=\"ansicyan\">__call__</span><span class=\"ansiblue\">(self, *args)</span>\n<span class=\"ansigreen\">   1131</span>         answer <span class=\"ansiyellow\">=</span> self<span class=\"ansiyellow\">.</span>gateway_client<span class=\"ansiyellow\">.</span>send_command<span class=\"ansiyellow\">(</span>command<span class=\"ansiyellow\">)</span><span class=\"ansiyellow\"></span>\n<span class=\"ansigreen\">   1132</span>         return_value = get_return_value(\n<span class=\"ansigreen\">-&gt; 1133</span><span class=\"ansiyellow\">             answer, self.gateway_client, self.target_id, self.name)\n</span><span class=\"ansigreen\">   1134</span> <span class=\"ansiyellow\"></span>\n<span class=\"ansigreen\">   1135</span>         <span class=\"ansigreen\">for</span> temp_arg <span class=\"ansigreen\">in</span> temp_args<span class=\"ansiyellow\">:</span><span class=\"ansiyellow\"></span>\n\n<span class=\"ansigreen\">/databricks/spark/python/pyspark/sql/utils.pyc</span> in <span class=\"ansicyan\">deco</span><span class=\"ansiblue\">(*a, **kw)</span>\n<span class=\"ansigreen\">     67</span>                                              e.java_exception.getStackTrace()))\n<span class=\"ansigreen\">     68</span>             <span class=\"ansigreen\">if</span> s<span class=\"ansiyellow\">.</span>startswith<span class=\"ansiyellow\">(</span><span class=\"ansiblue\">&apos;org.apache.spark.sql.AnalysisException: &apos;</span><span class=\"ansiyellow\">)</span><span class=\"ansiyellow\">:</span><span class=\"ansiyellow\"></span>\n<span class=\"ansigreen\">---&gt; 69</span><span class=\"ansiyellow\">                 </span><span class=\"ansigreen\">raise</span> AnalysisException<span class=\"ansiyellow\">(</span>s<span class=\"ansiyellow\">.</span>split<span class=\"ansiyellow\">(</span><span class=\"ansiblue\">&apos;: &apos;</span><span class=\"ansiyellow\">,</span> <span class=\"ansicyan\">1</span><span class=\"ansiyellow\">)</span><span class=\"ansiyellow\">[</span><span class=\"ansicyan\">1</span><span class=\"ansiyellow\">]</span><span class=\"ansiyellow\">,</span> stackTrace<span class=\"ansiyellow\">)</span><span class=\"ansiyellow\"></span>\n<span class=\"ansigreen\">     70</span>             <span class=\"ansigreen\">if</span> s<span class=\"ansiyellow\">.</span>startswith<span class=\"ansiyellow\">(</span><span class=\"ansiblue\">&apos;org.apache.spark.sql.catalyst.analysis&apos;</span><span class=\"ansiyellow\">)</span><span class=\"ansiyellow\">:</span><span class=\"ansiyellow\"></span>\n<span class=\"ansigreen\">     71</span>                 <span class=\"ansigreen\">raise</span> AnalysisException<span class=\"ansiyellow\">(</span>s<span class=\"ansiyellow\">.</span>split<span class=\"ansiyellow\">(</span><span class=\"ansiblue\">&apos;: &apos;</span><span class=\"ansiyellow\">,</span> <span class=\"ansicyan\">1</span><span class=\"ansiyellow\">)</span><span class=\"ansiyellow\">[</span><span class=\"ansicyan\">1</span><span class=\"ansiyellow\">]</span><span class=\"ansiyellow\">,</span> stackTrace<span class=\"ansiyellow\">)</span><span class=\"ansiyellow\"></span>\n\n<span class=\"ansired\">AnalysisException</span>: u&quot;cannot resolve &apos;&#96;zpis.loc&#96;&apos; given input columns: [country_namecode, countryshortname, countrycode, prodlinetext, mjsector_namecode, borrower, docty, mjtheme_namecode, board_approval_month, projectstatusdisplay, sector4, approvalfy, majorsector_percent, closingdate, totalcommamt, sector2, idacommamt, theme1, totalamt, project_abstract, id, lendinginstr, _id, productlinetype, envassesmentcategorycode, lendinginstrtype, sector3, sector, mjtheme, boardapprovaldate, sector1, prodline, sectorcode, projectfinancialtype, projectdocs, source, theme_namecode, lendprojectcost, countryname, grantamt, impagency, themecode, supplementprojectflg, project_name, status, url, regionname, mjthemecode, sector_namecode, ibrdcommamt];;\\n&apos;Project [_id#81, approvalfy#82, board_approval_month#83, boardapprovaldate#84, borrower#85, closingdate#86, country_namecode#87, countrycode#88, countryname#89, countryshortname#90, docty#91, envassesmentcategorycode#92, grantamt#93L, ibrdcommamt#94L, id#95, idacommamt#96L, impagency#97, lendinginstr#98, lendinginstrtype#99, lendprojectcost#100L, majorsector_percent#101, mjsector_namecode#102, mjtheme#103, mjtheme_namecode#104, ... 27 more fields]\\n+- Relation[_id#81,approvalfy#82,board_approval_month#83,boardapprovaldate#84,borrower#85,closingdate#86,country_namecode#87,countrycode#88,countryname#89,countryshortname#90,docty#91,envassesmentcategorycode#92,grantamt#93L,ibrdcommamt#94L,id#95,idacommamt#96L,impagency#97,lendinginstr#98,lendinginstrtype#99,lendprojectcost#100L,majorsector_percent#101,mjsector_namecode#102,mjtheme#103,mjtheme_namecode#104,... 26 more fields] json\\n&quot;</div>","workflows":[],"startTime":1511435847396,"submitTime":1511435847396,"finishTime":1511435847681,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"a9e4e735-872b-401a-8e15-d3f9f7d623d7"},{"version":"CommandV1","origId":620808971867625,"guid":"8608a623-3308-4698-843f-035d15b1fba3","subtype":"command","commandType":"auto","position":16.0,"command":"zpis.write.parquet(\"zpis1.parquet\")","commandVersion":0,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\"></div>","arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[]},"errorSummary":null,"error":null,"workflows":[],"startTime":1511428080577,"submitTime":1511428080565,"finishTime":1511428085510,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"aeb5f9a1-4331-4eca-bfa6-2b0dfa814152"},{"version":"CommandV1","origId":620808971867626,"guid":"becbaf77-f690-4b56-af37-3a719c492780","subtype":"command","commandType":"auto","position":17.0,"command":"zpis1 = spark.read.parquet('zpis1.parquet')","commandVersion":0,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\"></div>","arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[{"name":"zpis1","typeStr":"pyspark.sql.dataframe.DataFrame","schema":{"fields":[{"metadata":{},"name":"_id","nullable":true,"type":"string"},{"metadata":{},"name":"city","nullable":true,"type":"string"},{"metadata":{},"name":"loc","nullable":true,"type":{"containsNull":true,"elementType":"double","type":"array"}},{"metadata":{},"name":"pop","nullable":true,"type":"long"},{"metadata":{},"name":"state","nullable":true,"type":"string"}],"type":"struct"},"tableIdentifier":null}]},"errorSummary":null,"error":null,"workflows":[],"startTime":1511428120291,"submitTime":1511428120279,"finishTime":1511428121020,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"193bd2b4-60d1-4a27-95c3-31191e19ebb5"},{"version":"CommandV1","origId":620808971867627,"guid":"b5ef3e76-4153-4722-9857-77cd3d7f9cf5","subtype":"command","commandType":"auto","position":18.0,"command":"print zpis1.show(2)\nprint zpis.show(2)","commandVersion":0,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\">+-----+-------+--------------------+-----+-----+\n|  _id|   city|                 loc|  pop|state|\n+-----+-------+--------------------+-----+-----+\n|01001| AGAWAM|[-72.622739, 42.0...|15338|   MA|\n|01002|CUSHMAN|[-72.51565, 42.37...|36963|   MA|\n+-----+-------+--------------------+-----+-----+\nonly showing top 2 rows\n\nNone\n+-----+-------+--------------------+-----+-----+\n|  _id|   city|                 loc|  pop|state|\n+-----+-------+--------------------+-----+-----+\n|01001| AGAWAM|[-72.622739, 42.0...|15338|   MA|\n|01002|CUSHMAN|[-72.51565, 42.37...|36963|   MA|\n+-----+-------+--------------------+-----+-----+\nonly showing top 2 rows\n\nNone\n</div>","arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[]},"errorSummary":null,"error":null,"workflows":[],"startTime":1511428158899,"submitTime":1511428158892,"finishTime":1511428159777,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"d3c1111f-81c4-445d-b19c-ee246e46252b"},{"version":"CommandV1","origId":620808971867628,"guid":"ca295609-89cf-4e84-a576-720e5dd3cb76","subtype":"command","commandType":"auto","position":19.0,"command":"#zpis1.createGlobalTempView('zpis1')\n\nspark.catalog.refreshTable(\"global_temp.zpis1\")","commandVersion":0,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\"></div>","arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[]},"errorSummary":"<span class=\"ansired\">AnalysisException</span>: u&quot;Table or view &apos;zpis1&apos; not found in database &apos;default&apos;;&quot;","error":"<div class=\"ansiout\"><span class=\"ansired\">---------------------------------------------------------------------------</span>\n<span class=\"ansired\">AnalysisException</span>                         Traceback (most recent call last)\n<span class=\"ansigreen\">&lt;command-620808971867628&gt;</span> in <span class=\"ansicyan\">&lt;module&gt;</span><span class=\"ansiblue\">()</span>\n<span class=\"ansigreen\">      1</span> <span class=\"ansired\">#zpis1.createGlobalTempView(&apos;zpis1&apos;)</span><span class=\"ansiyellow\"></span><span class=\"ansiyellow\"></span>\n<span class=\"ansigreen\">      2</span> <span class=\"ansiyellow\"></span>\n<span class=\"ansigreen\">----&gt; 3</span><span class=\"ansiyellow\"> </span>spark<span class=\"ansiyellow\">.</span>catalog<span class=\"ansiyellow\">.</span>refreshTable<span class=\"ansiyellow\">(</span><span class=\"ansiblue\">&quot;zpis1&quot;</span><span class=\"ansiyellow\">)</span><span class=\"ansiyellow\"></span>\n\n<span class=\"ansigreen\">/databricks/spark/python/pyspark/sql/catalog.pyc</span> in <span class=\"ansicyan\">refreshTable</span><span class=\"ansiblue\">(self, tableName)</span>\n<span class=\"ansigreen\">    279</span>     <span class=\"ansigreen\">def</span> refreshTable<span class=\"ansiyellow\">(</span>self<span class=\"ansiyellow\">,</span> tableName<span class=\"ansiyellow\">)</span><span class=\"ansiyellow\">:</span><span class=\"ansiyellow\"></span>\n<span class=\"ansigreen\">    280</span>         <span class=\"ansiblue\">&quot;&quot;&quot;Invalidates and refreshes all the cached data and metadata of the given table.&quot;&quot;&quot;</span><span class=\"ansiyellow\"></span>\n<span class=\"ansigreen\">--&gt; 281</span><span class=\"ansiyellow\">         </span>self<span class=\"ansiyellow\">.</span>_jcatalog<span class=\"ansiyellow\">.</span>refreshTable<span class=\"ansiyellow\">(</span>tableName<span class=\"ansiyellow\">)</span><span class=\"ansiyellow\"></span>\n<span class=\"ansigreen\">    282</span> <span class=\"ansiyellow\"></span>\n<span class=\"ansigreen\">    283</span>     <span class=\"ansiyellow\">@</span>since<span class=\"ansiyellow\">(</span><span class=\"ansiblue\">&apos;2.1.1&apos;</span><span class=\"ansiyellow\">)</span><span class=\"ansiyellow\"></span>\n\n<span class=\"ansigreen\">/databricks/spark/python/lib/py4j-0.10.4-src.zip/py4j/java_gateway.py</span> in <span class=\"ansicyan\">__call__</span><span class=\"ansiblue\">(self, *args)</span>\n<span class=\"ansigreen\">   1131</span>         answer <span class=\"ansiyellow\">=</span> self<span class=\"ansiyellow\">.</span>gateway_client<span class=\"ansiyellow\">.</span>send_command<span class=\"ansiyellow\">(</span>command<span class=\"ansiyellow\">)</span><span class=\"ansiyellow\"></span>\n<span class=\"ansigreen\">   1132</span>         return_value = get_return_value(\n<span class=\"ansigreen\">-&gt; 1133</span><span class=\"ansiyellow\">             answer, self.gateway_client, self.target_id, self.name)\n</span><span class=\"ansigreen\">   1134</span> <span class=\"ansiyellow\"></span>\n<span class=\"ansigreen\">   1135</span>         <span class=\"ansigreen\">for</span> temp_arg <span class=\"ansigreen\">in</span> temp_args<span class=\"ansiyellow\">:</span><span class=\"ansiyellow\"></span>\n\n<span class=\"ansigreen\">/databricks/spark/python/pyspark/sql/utils.pyc</span> in <span class=\"ansicyan\">deco</span><span class=\"ansiblue\">(*a, **kw)</span>\n<span class=\"ansigreen\">     69</span>                 <span class=\"ansigreen\">raise</span> AnalysisException<span class=\"ansiyellow\">(</span>s<span class=\"ansiyellow\">.</span>split<span class=\"ansiyellow\">(</span><span class=\"ansiblue\">&apos;: &apos;</span><span class=\"ansiyellow\">,</span> <span class=\"ansicyan\">1</span><span class=\"ansiyellow\">)</span><span class=\"ansiyellow\">[</span><span class=\"ansicyan\">1</span><span class=\"ansiyellow\">]</span><span class=\"ansiyellow\">,</span> stackTrace<span class=\"ansiyellow\">)</span><span class=\"ansiyellow\"></span>\n<span class=\"ansigreen\">     70</span>             <span class=\"ansigreen\">if</span> s<span class=\"ansiyellow\">.</span>startswith<span class=\"ansiyellow\">(</span><span class=\"ansiblue\">&apos;org.apache.spark.sql.catalyst.analysis&apos;</span><span class=\"ansiyellow\">)</span><span class=\"ansiyellow\">:</span><span class=\"ansiyellow\"></span>\n<span class=\"ansigreen\">---&gt; 71</span><span class=\"ansiyellow\">                 </span><span class=\"ansigreen\">raise</span> AnalysisException<span class=\"ansiyellow\">(</span>s<span class=\"ansiyellow\">.</span>split<span class=\"ansiyellow\">(</span><span class=\"ansiblue\">&apos;: &apos;</span><span class=\"ansiyellow\">,</span> <span class=\"ansicyan\">1</span><span class=\"ansiyellow\">)</span><span class=\"ansiyellow\">[</span><span class=\"ansicyan\">1</span><span class=\"ansiyellow\">]</span><span class=\"ansiyellow\">,</span> stackTrace<span class=\"ansiyellow\">)</span><span class=\"ansiyellow\"></span>\n<span class=\"ansigreen\">     72</span>             <span class=\"ansigreen\">if</span> s<span class=\"ansiyellow\">.</span>startswith<span class=\"ansiyellow\">(</span><span class=\"ansiblue\">&apos;org.apache.spark.sql.catalyst.parser.ParseException: &apos;</span><span class=\"ansiyellow\">)</span><span class=\"ansiyellow\">:</span><span class=\"ansiyellow\"></span>\n<span class=\"ansigreen\">     73</span>                 <span class=\"ansigreen\">raise</span> ParseException<span class=\"ansiyellow\">(</span>s<span class=\"ansiyellow\">.</span>split<span class=\"ansiyellow\">(</span><span class=\"ansiblue\">&apos;: &apos;</span><span class=\"ansiyellow\">,</span> <span class=\"ansicyan\">1</span><span class=\"ansiyellow\">)</span><span class=\"ansiyellow\">[</span><span class=\"ansicyan\">1</span><span class=\"ansiyellow\">]</span><span class=\"ansiyellow\">,</span> stackTrace<span class=\"ansiyellow\">)</span><span class=\"ansiyellow\"></span>\n\n<span class=\"ansired\">AnalysisException</span>: u&quot;Table or view &apos;zpis1&apos; not found in database &apos;default&apos;;&quot;</div>","workflows":[],"startTime":1511428692312,"submitTime":1511428692302,"finishTime":1511428692589,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"0a27a1bf-5dfb-4180-9d7d-f2bc21bbf12f"},{"version":"CommandV1","origId":620808971867629,"guid":"d43dbb4c-3938-4e55-85f1-7e814ca66ba8","subtype":"command","commandType":"auto","position":20.0,"command":"zpis.printSchema()","commandVersion":0,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\">root\n |-- _id: string (nullable = true)\n |-- city: string (nullable = true)\n |-- loc: array (nullable = true)\n |    |-- element: double (containsNull = true)\n |-- pop: long (nullable = true)\n |-- state: string (nullable = true)\n\n</div>","arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[]},"errorSummary":null,"error":null,"workflows":[],"startTime":1511429215442,"submitTime":1511429215433,"finishTime":1511429215515,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"2957afff-339c-4386-bc95-d3b2dad8cb16"},{"version":"CommandV1","origId":620808971867630,"guid":"1d28373b-0525-4463-a8a6-f814f1122171","subtype":"command","commandType":"auto","position":21.0,"command":"import pyspark.ml.feature as ft","commandVersion":0,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\"></div>","arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[]},"errorSummary":null,"error":null,"workflows":[],"startTime":1511429296996,"submitTime":1511429296982,"finishTime":1511429297069,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"0c2a0099-f3fc-4f27-9adf-355188d3f94a"},{"version":"CommandV1","origId":620808971867631,"guid":"3f1fc7e0-d58b-48a5-83cd-74c91eba1628","subtype":"command","commandType":"auto","position":22.0,"command":"transformed_id = ft.StringIndexer(inputCol='_id', outputCol='id_en')\ntransformed_city = ft.StringIndexer(inputCol='city', outputCol='city_en')\ntransformed_state = ft.StringIndexer(inputCol='state', outputCol='state_en')","commandVersion":0,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\"></div>","arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[]},"errorSummary":null,"error":null,"workflows":[],"startTime":1511432028397,"submitTime":1511432028383,"finishTime":1511432028469,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"0eb08afb-3b51-4ab7-bcdb-84995120e39f"},{"version":"CommandV1","origId":620808971867632,"guid":"794623de-e7af-4889-b17b-c14b8e221bb9","subtype":"command","commandType":"auto","position":23.0,"command":"transfor","commandVersion":0,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\"><span class=\"ansired\">Out[</span><span class=\"ansired\">63</span><span class=\"ansired\">]: </span>[&apos;_id&apos;, &apos;city&apos;, &apos;loc&apos;, &apos;pop&apos;, &apos;state&apos;]\n</div>","arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[]},"errorSummary":null,"error":null,"workflows":[],"startTime":1511429454545,"submitTime":1511429454533,"finishTime":1511429454586,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"6e6eec78-c707-4304-adf7-2e8afaca0a97"},{"version":"CommandV1","origId":620808971867633,"guid":"bf734cc8-c92b-4c5a-a073-a49841efe23f","subtype":"command","commandType":"auto","position":24.0,"command":"featurescreator = ft.VectorAssembler(inputCols=['id_en',\n                                     'city_en',\n                                     \"features[{2}]\". format(i) for i in range(n)\n                                     'state_en' ], outputCol='features')","commandVersion":0,"state":"error","results":{"type":"html","data":"<div class=\"ansiout\"></div>","arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[]},"errorSummary":"<span class=\"ansired\">SyntaxError</span><span class=\"ansired\">:</span> invalid syntax","error":"<div class=\"ansiout\"><span class=\"ansicyan\">  File </span><span class=\"ansigreen\">&quot;&lt;command-620808971867633&gt;&quot;</span><span class=\"ansicyan\">, line </span><span class=\"ansigreen\">3</span>\n<span class=\"ansiyellow\">    &quot;features[{2}]&quot;.format(i) for i in range(n)</span>\n<span class=\"ansigrey\">                                ^</span>\n<span class=\"ansired\">SyntaxError</span><span class=\"ansired\">:</span> invalid syntax\n</div>","workflows":[],"startTime":1511437338992,"submitTime":1511437338992,"finishTime":1511437339077,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"0a97bd01-97d3-4b63-a5bd-11136d1dc52f"},{"version":"CommandV1","origId":620808971867634,"guid":"c96d81b8-e6a3-44f4-895c-369033681757","subtype":"command","commandType":"auto","position":25.0,"command":"import pyspark.ml.classification as cl","commandVersion":0,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\"></div>","arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[]},"errorSummary":null,"error":null,"workflows":[],"startTime":1511431902043,"submitTime":1511431902028,"finishTime":1511431902116,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"d74f457d-240e-4a96-becb-0e38ac7a27f2"},{"version":"CommandV1","origId":620808971867635,"guid":"f07c70e9-589b-400e-a968-99fcff8c4e59","subtype":"command","commandType":"auto","position":26.0,"command":"createLogistic = cl.LogisticRegression(maxIter=10, regParam=0.01, labelCol='pop')","commandVersion":0,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\"></div>","arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[]},"errorSummary":"<span class=\"ansired\">SyntaxError</span><span class=\"ansired\">:</span> invalid syntax","error":"<div class=\"ansiout\"><span class=\"ansicyan\">  File </span><span class=\"ansigreen\">&quot;&lt;command-620808971867635&gt;&quot;</span><span class=\"ansicyan\">, line </span><span class=\"ansigreen\">1</span>\n<span class=\"ansiyellow\">    createLogistic = cl.LogisticRegression(maxIter=10, regParam=0.01, labelCol=&apos;pop&apos;))</span>\n<span class=\"ansigrey\">                                                                                     ^</span>\n<span class=\"ansired\">SyntaxError</span><span class=\"ansired\">:</span> invalid syntax\n</div>","workflows":[],"startTime":1511432176394,"submitTime":1511432176380,"finishTime":1511432176466,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"e739f613-2c48-488d-888a-bc8f633abe2b"},{"version":"CommandV1","origId":620808971867636,"guid":"8baa0b56-825f-433a-9272-2a14230f2132","subtype":"command","commandType":"auto","position":27.0,"command":"from pyspark.ml import Pipeline","commandVersion":0,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\"></div>","arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[]},"errorSummary":null,"error":null,"workflows":[],"startTime":1511432005004,"submitTime":1511432004991,"finishTime":1511432005044,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"f7180a9f-cde4-443e-aaf0-8d74ad5451a6"},{"version":"CommandV1","origId":620808971867637,"guid":"b9546f3d-2855-4666-9efc-6d7767f170fd","subtype":"command","commandType":"auto","position":28.0,"command":"pipeline = Pipeline(stages=[transformed_id,\n                            transformed_city,\n                            transformed_state,\n                           featurescreator,\n                           createLogistic])","commandVersion":0,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\"></div>","arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[]},"errorSummary":null,"error":null,"workflows":[],"startTime":1511432182790,"submitTime":1511432182776,"finishTime":1511432182832,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"3b5544e1-1e18-40e9-bdf1-40c303f3a4b3"},{"version":"CommandV1","origId":620808971867638,"guid":"5fa4da64-08ed-46e3-b3b4-18937cc057c5","subtype":"command","commandType":"auto","position":29.0,"command":"zpis_train, zpis_test = zpis.randomSplit([0.7, 0.3], seed=100)","commandVersion":0,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\"></div>","arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[{"name":"zpis_train","typeStr":"pyspark.sql.dataframe.DataFrame","schema":{"fields":[{"metadata":{},"name":"_id","nullable":true,"type":"string"},{"metadata":{},"name":"city","nullable":true,"type":"string"},{"metadata":{},"name":"loc","nullable":true,"type":{"containsNull":true,"elementType":"double","type":"array"}},{"metadata":{},"name":"pop","nullable":true,"type":"long"},{"metadata":{},"name":"state","nullable":true,"type":"string"}],"type":"struct"},"tableIdentifier":null},{"name":"zpis_test","typeStr":"pyspark.sql.dataframe.DataFrame","schema":{"fields":[{"metadata":{},"name":"_id","nullable":true,"type":"string"},{"metadata":{},"name":"city","nullable":true,"type":"string"},{"metadata":{},"name":"loc","nullable":true,"type":{"containsNull":true,"elementType":"double","type":"array"}},{"metadata":{},"name":"pop","nullable":true,"type":"long"},{"metadata":{},"name":"state","nullable":true,"type":"string"}],"type":"struct"},"tableIdentifier":null}]},"errorSummary":null,"error":null,"workflows":[],"startTime":1511432187205,"submitTime":1511432187192,"finishTime":1511432187287,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"3920fc2d-8195-493f-a246-a3d06fe7f5cb"},{"version":"CommandV1","origId":620808971867639,"guid":"258fef28-d5a4-462a-b6b2-a2cdd8ed93ec","subtype":"command","commandType":"auto","position":30.0,"command":"model = pipeline.fit(zpis_train)","commandVersion":0,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\"></div>","arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[]},"errorSummary":"<span class=\"ansired\">IllegalArgumentException</span>: u&apos;Field &quot;state_e&quot; does not exist.&apos;","error":"<div class=\"ansiout\"><span class=\"ansired\">---------------------------------------------------------------------------</span>\n<span class=\"ansired\">IllegalArgumentException</span>                  Traceback (most recent call last)\n<span class=\"ansigreen\">&lt;command-620808971867639&gt;</span> in <span class=\"ansicyan\">&lt;module&gt;</span><span class=\"ansiblue\">()</span>\n<span class=\"ansigreen\">----&gt; 1</span><span class=\"ansiyellow\"> </span>model <span class=\"ansiyellow\">=</span> pipeline<span class=\"ansiyellow\">.</span>fit<span class=\"ansiyellow\">(</span>zpis_train<span class=\"ansiyellow\">)</span><span class=\"ansiyellow\"></span>\n\n<span class=\"ansigreen\">/databricks/spark/python/pyspark/ml/base.pyc</span> in <span class=\"ansicyan\">fit</span><span class=\"ansiblue\">(self, dataset, params)</span>\n<span class=\"ansigreen\">     62</span>                 <span class=\"ansigreen\">return</span> self<span class=\"ansiyellow\">.</span>copy<span class=\"ansiyellow\">(</span>params<span class=\"ansiyellow\">)</span><span class=\"ansiyellow\">.</span>_fit<span class=\"ansiyellow\">(</span>dataset<span class=\"ansiyellow\">)</span><span class=\"ansiyellow\"></span>\n<span class=\"ansigreen\">     63</span>             <span class=\"ansigreen\">else</span><span class=\"ansiyellow\">:</span><span class=\"ansiyellow\"></span>\n<span class=\"ansigreen\">---&gt; 64</span><span class=\"ansiyellow\">                 </span><span class=\"ansigreen\">return</span> self<span class=\"ansiyellow\">.</span>_fit<span class=\"ansiyellow\">(</span>dataset<span class=\"ansiyellow\">)</span><span class=\"ansiyellow\"></span>\n<span class=\"ansigreen\">     65</span>         <span class=\"ansigreen\">else</span><span class=\"ansiyellow\">:</span><span class=\"ansiyellow\"></span>\n<span class=\"ansigreen\">     66</span>             raise ValueError(&quot;Params must be either a param map or a list/tuple of param maps, &quot;\n\n<span class=\"ansigreen\">/databricks/spark/python/pyspark/ml/pipeline.pyc</span> in <span class=\"ansicyan\">_fit</span><span class=\"ansiblue\">(self, dataset)</span>\n<span class=\"ansigreen\">    104</span>                 <span class=\"ansigreen\">if</span> isinstance<span class=\"ansiyellow\">(</span>stage<span class=\"ansiyellow\">,</span> Transformer<span class=\"ansiyellow\">)</span><span class=\"ansiyellow\">:</span><span class=\"ansiyellow\"></span>\n<span class=\"ansigreen\">    105</span>                     transformers<span class=\"ansiyellow\">.</span>append<span class=\"ansiyellow\">(</span>stage<span class=\"ansiyellow\">)</span><span class=\"ansiyellow\"></span>\n<span class=\"ansigreen\">--&gt; 106</span><span class=\"ansiyellow\">                     </span>dataset <span class=\"ansiyellow\">=</span> stage<span class=\"ansiyellow\">.</span>transform<span class=\"ansiyellow\">(</span>dataset<span class=\"ansiyellow\">)</span><span class=\"ansiyellow\"></span>\n<span class=\"ansigreen\">    107</span>                 <span class=\"ansigreen\">else</span><span class=\"ansiyellow\">:</span>  <span class=\"ansired\"># must be an Estimator</span><span class=\"ansiyellow\"></span>\n<span class=\"ansigreen\">    108</span>                     model <span class=\"ansiyellow\">=</span> stage<span class=\"ansiyellow\">.</span>fit<span class=\"ansiyellow\">(</span>dataset<span class=\"ansiyellow\">)</span><span class=\"ansiyellow\"></span>\n\n<span class=\"ansigreen\">/databricks/spark/python/pyspark/ml/base.pyc</span> in <span class=\"ansicyan\">transform</span><span class=\"ansiblue\">(self, dataset, params)</span>\n<span class=\"ansigreen\">    103</span>                 <span class=\"ansigreen\">return</span> self<span class=\"ansiyellow\">.</span>copy<span class=\"ansiyellow\">(</span>params<span class=\"ansiyellow\">)</span><span class=\"ansiyellow\">.</span>_transform<span class=\"ansiyellow\">(</span>dataset<span class=\"ansiyellow\">)</span><span class=\"ansiyellow\"></span>\n<span class=\"ansigreen\">    104</span>             <span class=\"ansigreen\">else</span><span class=\"ansiyellow\">:</span><span class=\"ansiyellow\"></span>\n<span class=\"ansigreen\">--&gt; 105</span><span class=\"ansiyellow\">                 </span><span class=\"ansigreen\">return</span> self<span class=\"ansiyellow\">.</span>_transform<span class=\"ansiyellow\">(</span>dataset<span class=\"ansiyellow\">)</span><span class=\"ansiyellow\"></span>\n<span class=\"ansigreen\">    106</span>         <span class=\"ansigreen\">else</span><span class=\"ansiyellow\">:</span><span class=\"ansiyellow\"></span>\n<span class=\"ansigreen\">    107</span>             <span class=\"ansigreen\">raise</span> ValueError<span class=\"ansiyellow\">(</span><span class=\"ansiblue\">&quot;Params must be a param map but got %s.&quot;</span> <span class=\"ansiyellow\">%</span> type<span class=\"ansiyellow\">(</span>params<span class=\"ansiyellow\">)</span><span class=\"ansiyellow\">)</span><span class=\"ansiyellow\"></span>\n\n<span class=\"ansigreen\">/databricks/spark/python/pyspark/ml/wrapper.pyc</span> in <span class=\"ansicyan\">_transform</span><span class=\"ansiblue\">(self, dataset)</span>\n<span class=\"ansigreen\">    279</span>     <span class=\"ansigreen\">def</span> _transform<span class=\"ansiyellow\">(</span>self<span class=\"ansiyellow\">,</span> dataset<span class=\"ansiyellow\">)</span><span class=\"ansiyellow\">:</span><span class=\"ansiyellow\"></span>\n<span class=\"ansigreen\">    280</span>         self<span class=\"ansiyellow\">.</span>_transfer_params_to_java<span class=\"ansiyellow\">(</span><span class=\"ansiyellow\">)</span><span class=\"ansiyellow\"></span>\n<span class=\"ansigreen\">--&gt; 281</span><span class=\"ansiyellow\">         </span><span class=\"ansigreen\">return</span> DataFrame<span class=\"ansiyellow\">(</span>self<span class=\"ansiyellow\">.</span>_java_obj<span class=\"ansiyellow\">.</span>transform<span class=\"ansiyellow\">(</span>dataset<span class=\"ansiyellow\">.</span>_jdf<span class=\"ansiyellow\">)</span><span class=\"ansiyellow\">,</span> dataset<span class=\"ansiyellow\">.</span>sql_ctx<span class=\"ansiyellow\">)</span><span class=\"ansiyellow\"></span>\n<span class=\"ansigreen\">    282</span> <span class=\"ansiyellow\"></span>\n<span class=\"ansigreen\">    283</span> <span class=\"ansiyellow\"></span>\n\n<span class=\"ansigreen\">/databricks/spark/python/lib/py4j-0.10.4-src.zip/py4j/java_gateway.py</span> in <span class=\"ansicyan\">__call__</span><span class=\"ansiblue\">(self, *args)</span>\n<span class=\"ansigreen\">   1131</span>         answer <span class=\"ansiyellow\">=</span> self<span class=\"ansiyellow\">.</span>gateway_client<span class=\"ansiyellow\">.</span>send_command<span class=\"ansiyellow\">(</span>command<span class=\"ansiyellow\">)</span><span class=\"ansiyellow\"></span>\n<span class=\"ansigreen\">   1132</span>         return_value = get_return_value(\n<span class=\"ansigreen\">-&gt; 1133</span><span class=\"ansiyellow\">             answer, self.gateway_client, self.target_id, self.name)\n</span><span class=\"ansigreen\">   1134</span> <span class=\"ansiyellow\"></span>\n<span class=\"ansigreen\">   1135</span>         <span class=\"ansigreen\">for</span> temp_arg <span class=\"ansigreen\">in</span> temp_args<span class=\"ansiyellow\">:</span><span class=\"ansiyellow\"></span>\n\n<span class=\"ansigreen\">/databricks/spark/python/pyspark/sql/utils.pyc</span> in <span class=\"ansicyan\">deco</span><span class=\"ansiblue\">(*a, **kw)</span>\n<span class=\"ansigreen\">     77</span>                 <span class=\"ansigreen\">raise</span> QueryExecutionException<span class=\"ansiyellow\">(</span>s<span class=\"ansiyellow\">.</span>split<span class=\"ansiyellow\">(</span><span class=\"ansiblue\">&apos;: &apos;</span><span class=\"ansiyellow\">,</span> <span class=\"ansicyan\">1</span><span class=\"ansiyellow\">)</span><span class=\"ansiyellow\">[</span><span class=\"ansicyan\">1</span><span class=\"ansiyellow\">]</span><span class=\"ansiyellow\">,</span> stackTrace<span class=\"ansiyellow\">)</span><span class=\"ansiyellow\"></span>\n<span class=\"ansigreen\">     78</span>             <span class=\"ansigreen\">if</span> s<span class=\"ansiyellow\">.</span>startswith<span class=\"ansiyellow\">(</span><span class=\"ansiblue\">&apos;java.lang.IllegalArgumentException: &apos;</span><span class=\"ansiyellow\">)</span><span class=\"ansiyellow\">:</span><span class=\"ansiyellow\"></span>\n<span class=\"ansigreen\">---&gt; 79</span><span class=\"ansiyellow\">                 </span><span class=\"ansigreen\">raise</span> IllegalArgumentException<span class=\"ansiyellow\">(</span>s<span class=\"ansiyellow\">.</span>split<span class=\"ansiyellow\">(</span><span class=\"ansiblue\">&apos;: &apos;</span><span class=\"ansiyellow\">,</span> <span class=\"ansicyan\">1</span><span class=\"ansiyellow\">)</span><span class=\"ansiyellow\">[</span><span class=\"ansicyan\">1</span><span class=\"ansiyellow\">]</span><span class=\"ansiyellow\">,</span> stackTrace<span class=\"ansiyellow\">)</span><span class=\"ansiyellow\"></span>\n<span class=\"ansigreen\">     80</span>             <span class=\"ansigreen\">raise</span><span class=\"ansiyellow\"></span>\n<span class=\"ansigreen\">     81</span>     <span class=\"ansigreen\">return</span> deco<span class=\"ansiyellow\"></span>\n\n<span class=\"ansired\">IllegalArgumentException</span>: u&apos;Field &quot;state_e&quot; does not exist.&apos;</div>","workflows":[],"startTime":1511432190598,"submitTime":1511432190583,"finishTime":1511434418320,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"0659e6b3-6c79-4a64-8a7c-794ff20c4eb2"},{"version":"CommandV1","origId":620808971867640,"guid":"c7742b55-47f0-4319-9e66-61668df4786c","subtype":"command","commandType":"auto","position":31.0,"command":"test_out = model.transform(zpis_test)","commandVersion":0,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\"></div>","arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[]},"errorSummary":null,"error":null,"workflows":[],"startTime":1511434816615,"submitTime":1511434816600,"finishTime":1511434817050,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"aedde587-f8c8-438a-b4b9-4fa08e15b6a5"},{"version":"CommandV1","origId":620808971867641,"guid":"33103b65-5811-4afb-b2ac-217327729f6a","subtype":"command","commandType":"auto","position":32.0,"command":"test_out","commandVersion":0,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\"><span class=\"ansired\">Out[</span><span class=\"ansired\">108</span><span class=\"ansired\">]: </span>DataFrame[_id: string, city: string, loc: array&lt;double&gt;, pop: bigint, state: string, id_en: double, city_en: double, state_en: double, features: vector, rawPrediction: vector, probability: vector, prediction: double]\n</div>","arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[]},"errorSummary":"<span class=\"ansired\">NameError</span>: name &apos;time_out&apos; is not defined","error":"<div class=\"ansiout\"><span class=\"ansired\">---------------------------------------------------------------------------</span>\n<span class=\"ansired\">NameError</span>                                 Traceback (most recent call last)\n<span class=\"ansigreen\">&lt;command-620808971867641&gt;</span> in <span class=\"ansicyan\">&lt;module&gt;</span><span class=\"ansiblue\">()</span>\n<span class=\"ansigreen\">----&gt; 1</span><span class=\"ansiyellow\"> </span>time_out<span class=\"ansiyellow\"></span>\n\n<span class=\"ansired\">NameError</span>: name &apos;time_out&apos; is not defined</div>","workflows":[],"startTime":1511434843224,"submitTime":1511434843209,"finishTime":1511434843296,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"8b075545-a94d-48e6-b06f-732b89d1d63a"},{"version":"CommandV1","origId":620808971867642,"guid":"879ebbf1-da99-49be-81f4-84544b196549","subtype":"command","commandType":"auto","position":33.0,"command":"#To find accuracy of the algo under processing\nimport pyspark.ml.evaluation as ev","commandVersion":0,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\"></div>","arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[]},"errorSummary":"org.apache.spark.SparkException: Job aborted due to stage failure: Task 0 in stage 114.0 failed 1 times, most recent failure: Lost task 0.0 in stage 114.0 (TID 1182, localhost, executor driver): org.apache.spark.SparkException: Failed to execute user defined function($anonfun$5: (string) =&gt; double)","error":"<div class=\"ansiout\"><span class=\"ansired\">---------------------------------------------------------------------------</span>\n<span class=\"ansired\">Py4JJavaError</span>                             Traceback (most recent call last)\n<span class=\"ansigreen\">&lt;command-620808971867642&gt;</span> in <span class=\"ansicyan\">&lt;module&gt;</span><span class=\"ansiblue\">()</span>\n<span class=\"ansigreen\">----&gt; 1</span><span class=\"ansiyellow\"> </span>test_out<span class=\"ansiyellow\">[</span><span class=\"ansiyellow\">[</span><span class=\"ansiblue\">&apos;prediction&apos;</span><span class=\"ansiyellow\">]</span><span class=\"ansiyellow\">]</span><span class=\"ansiyellow\">.</span>take<span class=\"ansiyellow\">(</span><span class=\"ansicyan\">5</span><span class=\"ansiyellow\">)</span><span class=\"ansiyellow\"></span>\n\n<span class=\"ansigreen\">/databricks/spark/python/pyspark/sql/dataframe.pyc</span> in <span class=\"ansicyan\">take</span><span class=\"ansiblue\">(self, num)</span>\n<span class=\"ansigreen\">    475</span>         <span class=\"ansiyellow\">[</span>Row<span class=\"ansiyellow\">(</span>age<span class=\"ansiyellow\">=</span><span class=\"ansicyan\">2</span><span class=\"ansiyellow\">,</span> name<span class=\"ansiyellow\">=</span><span class=\"ansiblue\">u&apos;Alice&apos;</span><span class=\"ansiyellow\">)</span><span class=\"ansiyellow\">,</span> Row<span class=\"ansiyellow\">(</span>age<span class=\"ansiyellow\">=</span><span class=\"ansicyan\">5</span><span class=\"ansiyellow\">,</span> name<span class=\"ansiyellow\">=</span><span class=\"ansiblue\">u&apos;Bob&apos;</span><span class=\"ansiyellow\">)</span><span class=\"ansiyellow\">]</span><span class=\"ansiyellow\"></span>\n<span class=\"ansigreen\">    476</span>         &quot;&quot;&quot;\n<span class=\"ansigreen\">--&gt; 477</span><span class=\"ansiyellow\">         </span><span class=\"ansigreen\">return</span> self<span class=\"ansiyellow\">.</span>limit<span class=\"ansiyellow\">(</span>num<span class=\"ansiyellow\">)</span><span class=\"ansiyellow\">.</span>collect<span class=\"ansiyellow\">(</span><span class=\"ansiyellow\">)</span><span class=\"ansiyellow\"></span>\n<span class=\"ansigreen\">    478</span> <span class=\"ansiyellow\"></span>\n<span class=\"ansigreen\">    479</span>     <span class=\"ansiyellow\">@</span>since<span class=\"ansiyellow\">(</span><span class=\"ansicyan\">1.3</span><span class=\"ansiyellow\">)</span><span class=\"ansiyellow\"></span>\n\n<span class=\"ansigreen\">/databricks/spark/python/pyspark/sql/dataframe.pyc</span> in <span class=\"ansicyan\">collect</span><span class=\"ansiblue\">(self)</span>\n<span class=\"ansigreen\">    437</span>         &quot;&quot;&quot;\n<span class=\"ansigreen\">    438</span>         <span class=\"ansigreen\">with</span> SCCallSiteSync<span class=\"ansiyellow\">(</span>self<span class=\"ansiyellow\">.</span>_sc<span class=\"ansiyellow\">)</span> <span class=\"ansigreen\">as</span> css<span class=\"ansiyellow\">:</span><span class=\"ansiyellow\"></span>\n<span class=\"ansigreen\">--&gt; 439</span><span class=\"ansiyellow\">             </span>port <span class=\"ansiyellow\">=</span> self<span class=\"ansiyellow\">.</span>_jdf<span class=\"ansiyellow\">.</span>collectToPython<span class=\"ansiyellow\">(</span><span class=\"ansiyellow\">)</span><span class=\"ansiyellow\"></span>\n<span class=\"ansigreen\">    440</span>         <span class=\"ansigreen\">return</span> list<span class=\"ansiyellow\">(</span>_load_from_socket<span class=\"ansiyellow\">(</span>port<span class=\"ansiyellow\">,</span> BatchedSerializer<span class=\"ansiyellow\">(</span>PickleSerializer<span class=\"ansiyellow\">(</span><span class=\"ansiyellow\">)</span><span class=\"ansiyellow\">)</span><span class=\"ansiyellow\">)</span><span class=\"ansiyellow\">)</span><span class=\"ansiyellow\"></span>\n<span class=\"ansigreen\">    441</span> <span class=\"ansiyellow\"></span>\n\n<span class=\"ansigreen\">/databricks/spark/python/lib/py4j-0.10.4-src.zip/py4j/java_gateway.py</span> in <span class=\"ansicyan\">__call__</span><span class=\"ansiblue\">(self, *args)</span>\n<span class=\"ansigreen\">   1131</span>         answer <span class=\"ansiyellow\">=</span> self<span class=\"ansiyellow\">.</span>gateway_client<span class=\"ansiyellow\">.</span>send_command<span class=\"ansiyellow\">(</span>command<span class=\"ansiyellow\">)</span><span class=\"ansiyellow\"></span>\n<span class=\"ansigreen\">   1132</span>         return_value = get_return_value(\n<span class=\"ansigreen\">-&gt; 1133</span><span class=\"ansiyellow\">             answer, self.gateway_client, self.target_id, self.name)\n</span><span class=\"ansigreen\">   1134</span> <span class=\"ansiyellow\"></span>\n<span class=\"ansigreen\">   1135</span>         <span class=\"ansigreen\">for</span> temp_arg <span class=\"ansigreen\">in</span> temp_args<span class=\"ansiyellow\">:</span><span class=\"ansiyellow\"></span>\n\n<span class=\"ansigreen\">/databricks/spark/python/pyspark/sql/utils.pyc</span> in <span class=\"ansicyan\">deco</span><span class=\"ansiblue\">(*a, **kw)</span>\n<span class=\"ansigreen\">     61</span>     <span class=\"ansigreen\">def</span> deco<span class=\"ansiyellow\">(</span><span class=\"ansiyellow\">*</span>a<span class=\"ansiyellow\">,</span> <span class=\"ansiyellow\">**</span>kw<span class=\"ansiyellow\">)</span><span class=\"ansiyellow\">:</span><span class=\"ansiyellow\"></span>\n<span class=\"ansigreen\">     62</span>         <span class=\"ansigreen\">try</span><span class=\"ansiyellow\">:</span><span class=\"ansiyellow\"></span>\n<span class=\"ansigreen\">---&gt; 63</span><span class=\"ansiyellow\">             </span><span class=\"ansigreen\">return</span> f<span class=\"ansiyellow\">(</span><span class=\"ansiyellow\">*</span>a<span class=\"ansiyellow\">,</span> <span class=\"ansiyellow\">**</span>kw<span class=\"ansiyellow\">)</span><span class=\"ansiyellow\"></span>\n<span class=\"ansigreen\">     64</span>         <span class=\"ansigreen\">except</span> py4j<span class=\"ansiyellow\">.</span>protocol<span class=\"ansiyellow\">.</span>Py4JJavaError <span class=\"ansigreen\">as</span> e<span class=\"ansiyellow\">:</span><span class=\"ansiyellow\"></span>\n<span class=\"ansigreen\">     65</span>             s <span class=\"ansiyellow\">=</span> e<span class=\"ansiyellow\">.</span>java_exception<span class=\"ansiyellow\">.</span>toString<span class=\"ansiyellow\">(</span><span class=\"ansiyellow\">)</span><span class=\"ansiyellow\"></span>\n\n<span class=\"ansigreen\">/databricks/spark/python/lib/py4j-0.10.4-src.zip/py4j/protocol.py</span> in <span class=\"ansicyan\">get_return_value</span><span class=\"ansiblue\">(answer, gateway_client, target_id, name)</span>\n<span class=\"ansigreen\">    317</span>                 raise Py4JJavaError(\n<span class=\"ansigreen\">    318</span>                     <span class=\"ansiblue\">&quot;An error occurred while calling {0}{1}{2}.\\n&quot;</span><span class=\"ansiyellow\">.</span><span class=\"ansiyellow\"></span>\n<span class=\"ansigreen\">--&gt; 319</span><span class=\"ansiyellow\">                     format(target_id, &quot;.&quot;, name), value)\n</span><span class=\"ansigreen\">    320</span>             <span class=\"ansigreen\">else</span><span class=\"ansiyellow\">:</span><span class=\"ansiyellow\"></span>\n<span class=\"ansigreen\">    321</span>                 raise Py4JError(\n\n<span class=\"ansired\">Py4JJavaError</span>: An error occurred while calling o5922.collectToPython.\n: org.apache.spark.SparkException: Job aborted due to stage failure: Task 0 in stage 114.0 failed 1 times, most recent failure: Lost task 0.0 in stage 114.0 (TID 1182, localhost, executor driver): org.apache.spark.SparkException: Failed to execute user defined function($anonfun$5: (string) =&gt; double)\n\tat org.apache.spark.sql.catalyst.expressions.GeneratedClass$GeneratedIterator.processNext(Unknown Source)\n\tat org.apache.spark.sql.execution.BufferedRowIterator.hasNext(BufferedRowIterator.java:43)\n\tat org.apache.spark.sql.execution.WholeStageCodegenExec$$anonfun$8$$anon$1.hasNext(WholeStageCodegenExec.scala:395)\n\tat org.apache.spark.sql.execution.SparkPlan$$anonfun$2.apply(SparkPlan.scala:249)\n\tat org.apache.spark.sql.execution.SparkPlan$$anonfun$2.apply(SparkPlan.scala:243)\n\tat org.apache.spark.rdd.RDD$$anonfun$mapPartitionsInternal$1$$anonfun$apply$25.apply(RDD.scala:827)\n\tat org.apache.spark.rdd.RDD$$anonfun$mapPartitionsInternal$1$$anonfun$apply$25.apply(RDD.scala:827)\n\tat org.apache.spark.rdd.MapPartitionsRDD.compute(MapPartitionsRDD.scala:38)\n\tat org.apache.spark.rdd.RDD.computeOrReadCheckpoint(RDD.scala:323)\n\tat org.apache.spark.rdd.RDD.iterator(RDD.scala:287)\n\tat org.apache.spark.scheduler.ResultTask.runTask(ResultTask.scala:87)\n\tat org.apache.spark.scheduler.Task.run(Task.scala:108)\n\tat org.apache.spark.executor.Executor$TaskRunner.run(Executor.scala:346)\n\tat java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)\n\tat java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)\n\tat java.lang.Thread.run(Thread.java:748)\nCaused by: org.apache.spark.SparkException: Unseen label: 01008.  To handle unseen labels, set Param handleInvalid to keep.\n\tat org.apache.spark.ml.feature.StringIndexerModel$$anonfun$5.apply(StringIndexer.scala:222)\n\tat org.apache.spark.ml.feature.StringIndexerModel$$anonfun$5.apply(StringIndexer.scala:208)\n\t... 16 more\n\nDriver stacktrace:\n\tat org.apache.spark.scheduler.DAGScheduler.org$apache$spark$scheduler$DAGScheduler$$failJobAndIndependentStages(DAGScheduler.scala:1676)\n\tat org.apache.spark.scheduler.DAGScheduler$$anonfun$abortStage$1.apply(DAGScheduler.scala:1664)\n\tat org.apache.spark.scheduler.DAGScheduler$$anonfun$abortStage$1.apply(DAGScheduler.scala:1663)\n\tat scala.collection.mutable.ResizableArray$class.foreach(ResizableArray.scala:59)\n\tat scala.collection.mutable.ArrayBuffer.foreach(ArrayBuffer.scala:48)\n\tat org.apache.spark.scheduler.DAGScheduler.abortStage(DAGScheduler.scala:1663)\n\tat org.apache.spark.scheduler.DAGScheduler$$anonfun$handleTaskSetFailed$1.apply(DAGScheduler.scala:930)\n\tat org.apache.spark.scheduler.DAGScheduler$$anonfun$handleTaskSetFailed$1.apply(DAGScheduler.scala:930)\n\tat scala.Option.foreach(Option.scala:257)\n\tat org.apache.spark.scheduler.DAGScheduler.handleTaskSetFailed(DAGScheduler.scala:930)\n\tat org.apache.spark.scheduler.DAGSchedulerEventProcessLoop.doOnReceive(DAGScheduler.scala:1896)\n\tat org.apache.spark.scheduler.DAGSchedulerEventProcessLoop.onReceive(DAGScheduler.scala:1847)\n\tat org.apache.spark.scheduler.DAGSchedulerEventProcessLoop.onReceive(DAGScheduler.scala:1835)\n\tat org.apache.spark.util.EventLoop$$anon$1.run(EventLoop.scala:48)\n\tat org.apache.spark.scheduler.DAGScheduler.runJob(DAGScheduler.scala:732)\n\tat org.apache.spark.SparkContext.runJob(SparkContext.scala:2055)\n\tat org.apache.spark.SparkContext.runJob(SparkContext.scala:2076)\n\tat org.apache.spark.SparkContext.runJob(SparkContext.scala:2095)\n\tat org.apache.spark.sql.execution.SparkPlan.executeTake(SparkPlan.scala:361)\n\tat org.apache.spark.sql.execution.CollectLimitExec.executeCollect(limit.scala:38)\n\tat org.apache.spark.sql.Dataset$$anonfun$collectToPython$1.apply$mcI$sp(Dataset.scala:2865)\n\tat org.apache.spark.sql.Dataset$$anonfun$collectToPython$1.apply(Dataset.scala:2862)\n\tat org.apache.spark.sql.Dataset$$anonfun$collectToPython$1.apply(Dataset.scala:2862)\n\tat org.apache.spark.sql.execution.SQLExecution$.withCustomExecutionEnv(SQLExecution.scala:80)\n\tat org.apache.spark.sql.execution.SQLExecution$.withNewExecutionId(SQLExecution.scala:99)\n\tat org.apache.spark.sql.Dataset.withNewExecutionId(Dataset.scala:2895)\n\tat org.apache.spark.sql.Dataset.collectToPython(Dataset.scala:2862)\n\tat sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)\n\tat sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)\n\tat sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)\n\tat java.lang.reflect.Method.invoke(Method.java:498)\n\tat py4j.reflection.MethodInvoker.invoke(MethodInvoker.java:244)\n\tat py4j.reflection.ReflectionEngine.invoke(ReflectionEngine.java:357)\n\tat py4j.Gateway.invoke(Gateway.java:280)\n\tat py4j.commands.AbstractCommand.invokeMethod(AbstractCommand.java:132)\n\tat py4j.commands.CallCommand.execute(CallCommand.java:79)\n\tat py4j.GatewayConnection.run(GatewayConnection.java:214)\n\tat java.lang.Thread.run(Thread.java:748)\nCaused by: org.apache.spark.SparkException: Failed to execute user defined function($anonfun$5: (string) =&gt; double)\n\tat org.apache.spark.sql.catalyst.expressions.GeneratedClass$GeneratedIterator.processNext(Unknown Source)\n\tat org.apache.spark.sql.execution.BufferedRowIterator.hasNext(BufferedRowIterator.java:43)\n\tat org.apache.spark.sql.execution.WholeStageCodegenExec$$anonfun$8$$anon$1.hasNext(WholeStageCodegenExec.scala:395)\n\tat org.apache.spark.sql.execution.SparkPlan$$anonfun$2.apply(SparkPlan.scala:249)\n\tat org.apache.spark.sql.execution.SparkPlan$$anonfun$2.apply(SparkPlan.scala:243)\n\tat org.apache.spark.rdd.RDD$$anonfun$mapPartitionsInternal$1$$anonfun$apply$25.apply(RDD.scala:827)\n\tat org.apache.spark.rdd.RDD$$anonfun$mapPartitionsInternal$1$$anonfun$apply$25.apply(RDD.scala:827)\n\tat org.apache.spark.rdd.MapPartitionsRDD.compute(MapPartitionsRDD.scala:38)\n\tat org.apache.spark.rdd.RDD.computeOrReadCheckpoint(RDD.scala:323)\n\tat org.apache.spark.rdd.RDD.iterator(RDD.scala:287)\n\tat org.apache.spark.scheduler.ResultTask.runTask(ResultTask.scala:87)\n\tat org.apache.spark.scheduler.Task.run(Task.scala:108)\n\tat org.apache.spark.executor.Executor$TaskRunner.run(Executor.scala:346)\n\tat java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)\n\tat java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)\n\t... 1 more\nCaused by: org.apache.spark.SparkException: Unseen label: 01008.  To handle unseen labels, set Param handleInvalid to keep.\n\tat org.apache.spark.ml.feature.StringIndexerModel$$anonfun$5.apply(StringIndexer.scala:222)\n\tat org.apache.spark.ml.feature.StringIndexerModel$$anonfun$5.apply(StringIndexer.scala:208)\n\t... 16 more\n</div>","workflows":[],"startTime":1511435026650,"submitTime":1511435026638,"finishTime":1511435026723,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"5d1fad13-6dc1-43a2-b4d6-9129322a4da5"},{"version":"CommandV1","origId":620808971867643,"guid":"9042d092-4775-4502-9492-211d29e2acf6","subtype":"command","commandType":"auto","position":34.0,"command":"\n#BinaryClassification\nevaluator = ev.BinaryClassificationEvaluator(rawPredictionCol='probability', \n                                             labelCol='pop')","commandVersion":0,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\"></div>","arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[]},"errorSummary":null,"error":null,"workflows":[],"startTime":1511435045665,"submitTime":1511435045650,"finishTime":1511435045738,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"154e7f7d-fb9f-4593-b59e-6834cb7b8a31"},{"version":"CommandV1","origId":620808971867644,"guid":"e9f85826-4f6e-4478-b517-05b0fe21b779","subtype":"command","commandType":"auto","position":35.0,"command":"evaluator.evaluate(test_out)","commandVersion":0,"state":"error","results":{"type":"html","data":"<div class=\"ansiout\"></div>","arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[]},"errorSummary":"org.apache.spark.SparkException: Job aborted due to stage failure: Task 0 in stage 115.0 failed 1 times, most recent failure: Lost task 0.0 in stage 115.0 (TID 1183, localhost, executor driver): org.apache.spark.SparkException: Failed to execute user defined function($anonfun$5: (string) =&gt; double)","error":"<div class=\"ansiout\"><span class=\"ansired\">---------------------------------------------------------------------------</span>\n<span class=\"ansired\">Py4JJavaError</span>                             Traceback (most recent call last)\n<span class=\"ansigreen\">&lt;command-620808971867644&gt;</span> in <span class=\"ansicyan\">&lt;module&gt;</span><span class=\"ansiblue\">()</span>\n<span class=\"ansigreen\">----&gt; 1</span><span class=\"ansiyellow\"> </span>evaluator<span class=\"ansiyellow\">.</span>evaluate<span class=\"ansiyellow\">(</span>test_out<span class=\"ansiyellow\">)</span><span class=\"ansiyellow\"></span>\n\n<span class=\"ansigreen\">/databricks/spark/python/pyspark/ml/evaluation.py</span> in <span class=\"ansicyan\">evaluate</span><span class=\"ansiblue\">(self, dataset, params)</span>\n<span class=\"ansigreen\">     67</span>                 <span class=\"ansigreen\">return</span> self<span class=\"ansiyellow\">.</span>copy<span class=\"ansiyellow\">(</span>params<span class=\"ansiyellow\">)</span><span class=\"ansiyellow\">.</span>_evaluate<span class=\"ansiyellow\">(</span>dataset<span class=\"ansiyellow\">)</span><span class=\"ansiyellow\"></span>\n<span class=\"ansigreen\">     68</span>             <span class=\"ansigreen\">else</span><span class=\"ansiyellow\">:</span><span class=\"ansiyellow\"></span>\n<span class=\"ansigreen\">---&gt; 69</span><span class=\"ansiyellow\">                 </span><span class=\"ansigreen\">return</span> self<span class=\"ansiyellow\">.</span>_evaluate<span class=\"ansiyellow\">(</span>dataset<span class=\"ansiyellow\">)</span><span class=\"ansiyellow\"></span>\n<span class=\"ansigreen\">     70</span>         <span class=\"ansigreen\">else</span><span class=\"ansiyellow\">:</span><span class=\"ansiyellow\"></span>\n<span class=\"ansigreen\">     71</span>             <span class=\"ansigreen\">raise</span> ValueError<span class=\"ansiyellow\">(</span><span class=\"ansiblue\">&quot;Params must be a param map but got %s.&quot;</span> <span class=\"ansiyellow\">%</span> type<span class=\"ansiyellow\">(</span>params<span class=\"ansiyellow\">)</span><span class=\"ansiyellow\">)</span><span class=\"ansiyellow\"></span>\n\n<span class=\"ansigreen\">/databricks/spark/python/pyspark/ml/evaluation.py</span> in <span class=\"ansicyan\">_evaluate</span><span class=\"ansiblue\">(self, dataset)</span>\n<span class=\"ansigreen\">     97</span>         &quot;&quot;&quot;\n<span class=\"ansigreen\">     98</span>         self<span class=\"ansiyellow\">.</span>_transfer_params_to_java<span class=\"ansiyellow\">(</span><span class=\"ansiyellow\">)</span><span class=\"ansiyellow\"></span>\n<span class=\"ansigreen\">---&gt; 99</span><span class=\"ansiyellow\">         </span><span class=\"ansigreen\">return</span> self<span class=\"ansiyellow\">.</span>_java_obj<span class=\"ansiyellow\">.</span>evaluate<span class=\"ansiyellow\">(</span>dataset<span class=\"ansiyellow\">.</span>_jdf<span class=\"ansiyellow\">)</span><span class=\"ansiyellow\"></span>\n<span class=\"ansigreen\">    100</span> <span class=\"ansiyellow\"></span>\n<span class=\"ansigreen\">    101</span>     <span class=\"ansigreen\">def</span> isLargerBetter<span class=\"ansiyellow\">(</span>self<span class=\"ansiyellow\">)</span><span class=\"ansiyellow\">:</span><span class=\"ansiyellow\"></span>\n\n<span class=\"ansigreen\">/databricks/spark/python/lib/py4j-0.10.4-src.zip/py4j/java_gateway.py</span> in <span class=\"ansicyan\">__call__</span><span class=\"ansiblue\">(self, *args)</span>\n<span class=\"ansigreen\">   1131</span>         answer <span class=\"ansiyellow\">=</span> self<span class=\"ansiyellow\">.</span>gateway_client<span class=\"ansiyellow\">.</span>send_command<span class=\"ansiyellow\">(</span>command<span class=\"ansiyellow\">)</span><span class=\"ansiyellow\"></span>\n<span class=\"ansigreen\">   1132</span>         return_value = get_return_value(\n<span class=\"ansigreen\">-&gt; 1133</span><span class=\"ansiyellow\">             answer, self.gateway_client, self.target_id, self.name)\n</span><span class=\"ansigreen\">   1134</span> <span class=\"ansiyellow\"></span>\n<span class=\"ansigreen\">   1135</span>         <span class=\"ansigreen\">for</span> temp_arg <span class=\"ansigreen\">in</span> temp_args<span class=\"ansiyellow\">:</span><span class=\"ansiyellow\"></span>\n\n<span class=\"ansigreen\">/databricks/spark/python/pyspark/sql/utils.pyc</span> in <span class=\"ansicyan\">deco</span><span class=\"ansiblue\">(*a, **kw)</span>\n<span class=\"ansigreen\">     61</span>     <span class=\"ansigreen\">def</span> deco<span class=\"ansiyellow\">(</span><span class=\"ansiyellow\">*</span>a<span class=\"ansiyellow\">,</span> <span class=\"ansiyellow\">**</span>kw<span class=\"ansiyellow\">)</span><span class=\"ansiyellow\">:</span><span class=\"ansiyellow\"></span>\n<span class=\"ansigreen\">     62</span>         <span class=\"ansigreen\">try</span><span class=\"ansiyellow\">:</span><span class=\"ansiyellow\"></span>\n<span class=\"ansigreen\">---&gt; 63</span><span class=\"ansiyellow\">             </span><span class=\"ansigreen\">return</span> f<span class=\"ansiyellow\">(</span><span class=\"ansiyellow\">*</span>a<span class=\"ansiyellow\">,</span> <span class=\"ansiyellow\">**</span>kw<span class=\"ansiyellow\">)</span><span class=\"ansiyellow\"></span>\n<span class=\"ansigreen\">     64</span>         <span class=\"ansigreen\">except</span> py4j<span class=\"ansiyellow\">.</span>protocol<span class=\"ansiyellow\">.</span>Py4JJavaError <span class=\"ansigreen\">as</span> e<span class=\"ansiyellow\">:</span><span class=\"ansiyellow\"></span>\n<span class=\"ansigreen\">     65</span>             s <span class=\"ansiyellow\">=</span> e<span class=\"ansiyellow\">.</span>java_exception<span class=\"ansiyellow\">.</span>toString<span class=\"ansiyellow\">(</span><span class=\"ansiyellow\">)</span><span class=\"ansiyellow\"></span>\n\n<span class=\"ansigreen\">/databricks/spark/python/lib/py4j-0.10.4-src.zip/py4j/protocol.py</span> in <span class=\"ansicyan\">get_return_value</span><span class=\"ansiblue\">(answer, gateway_client, target_id, name)</span>\n<span class=\"ansigreen\">    317</span>                 raise Py4JJavaError(\n<span class=\"ansigreen\">    318</span>                     <span class=\"ansiblue\">&quot;An error occurred while calling {0}{1}{2}.\\n&quot;</span><span class=\"ansiyellow\">.</span><span class=\"ansiyellow\"></span>\n<span class=\"ansigreen\">--&gt; 319</span><span class=\"ansiyellow\">                     format(target_id, &quot;.&quot;, name), value)\n</span><span class=\"ansigreen\">    320</span>             <span class=\"ansigreen\">else</span><span class=\"ansiyellow\">:</span><span class=\"ansiyellow\"></span>\n<span class=\"ansigreen\">    321</span>                 raise Py4JError(\n\n<span class=\"ansired\">Py4JJavaError</span>: An error occurred while calling o5979.evaluate.\n: org.apache.spark.SparkException: Job aborted due to stage failure: Task 0 in stage 115.0 failed 1 times, most recent failure: Lost task 0.0 in stage 115.0 (TID 1183, localhost, executor driver): org.apache.spark.SparkException: Failed to execute user defined function($anonfun$5: (string) =&gt; double)\n\tat org.apache.spark.sql.catalyst.expressions.GeneratedClass$GeneratedIterator.processNext(Unknown Source)\n\tat org.apache.spark.sql.execution.BufferedRowIterator.hasNext(BufferedRowIterator.java:43)\n\tat org.apache.spark.sql.execution.WholeStageCodegenExec$$anonfun$8$$anon$1.hasNext(WholeStageCodegenExec.scala:395)\n\tat scala.collection.Iterator$$anon$11.hasNext(Iterator.scala:408)\n\tat scala.collection.Iterator$$anon$11.hasNext(Iterator.scala:408)\n\tat scala.collection.Iterator$$anon$11.hasNext(Iterator.scala:408)\n\tat org.apache.spark.util.collection.ExternalSorter.insertAll(ExternalSorter.scala:191)\n\tat org.apache.spark.shuffle.sort.SortShuffleWriter.write(SortShuffleWriter.scala:63)\n\tat org.apache.spark.scheduler.ShuffleMapTask.runTask(ShuffleMapTask.scala:96)\n\tat org.apache.spark.scheduler.ShuffleMapTask.runTask(ShuffleMapTask.scala:53)\n\tat org.apache.spark.scheduler.Task.run(Task.scala:108)\n\tat org.apache.spark.executor.Executor$TaskRunner.run(Executor.scala:346)\n\tat java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)\n\tat java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)\n\tat java.lang.Thread.run(Thread.java:748)\nCaused by: org.apache.spark.SparkException: Unseen label: 01008.  To handle unseen labels, set Param handleInvalid to keep.\n\tat org.apache.spark.ml.feature.StringIndexerModel$$anonfun$5.apply(StringIndexer.scala:222)\n\tat org.apache.spark.ml.feature.StringIndexerModel$$anonfun$5.apply(StringIndexer.scala:208)\n\t... 15 more\n\nDriver stacktrace:\n\tat org.apache.spark.scheduler.DAGScheduler.org$apache$spark$scheduler$DAGScheduler$$failJobAndIndependentStages(DAGScheduler.scala:1676)\n\tat org.apache.spark.scheduler.DAGScheduler$$anonfun$abortStage$1.apply(DAGScheduler.scala:1664)\n\tat org.apache.spark.scheduler.DAGScheduler$$anonfun$abortStage$1.apply(DAGScheduler.scala:1663)\n\tat scala.collection.mutable.ResizableArray$class.foreach(ResizableArray.scala:59)\n\tat scala.collection.mutable.ArrayBuffer.foreach(ArrayBuffer.scala:48)\n\tat org.apache.spark.scheduler.DAGScheduler.abortStage(DAGScheduler.scala:1663)\n\tat org.apache.spark.scheduler.DAGScheduler$$anonfun$handleTaskSetFailed$1.apply(DAGScheduler.scala:930)\n\tat org.apache.spark.scheduler.DAGScheduler$$anonfun$handleTaskSetFailed$1.apply(DAGScheduler.scala:930)\n\tat scala.Option.foreach(Option.scala:257)\n\tat org.apache.spark.scheduler.DAGScheduler.handleTaskSetFailed(DAGScheduler.scala:930)\n\tat org.apache.spark.scheduler.DAGSchedulerEventProcessLoop.doOnReceive(DAGScheduler.scala:1896)\n\tat org.apache.spark.scheduler.DAGSchedulerEventProcessLoop.onReceive(DAGScheduler.scala:1847)\n\tat org.apache.spark.scheduler.DAGSchedulerEventProcessLoop.onReceive(DAGScheduler.scala:1835)\n\tat org.apache.spark.util.EventLoop$$anon$1.run(EventLoop.scala:48)\n\tat org.apache.spark.scheduler.DAGScheduler.runJob(DAGScheduler.scala:732)\n\tat org.apache.spark.SparkContext.runJob(SparkContext.scala:2055)\n\tat org.apache.spark.SparkContext.runJob(SparkContext.scala:2076)\n\tat org.apache.spark.SparkContext.runJob(SparkContext.scala:2095)\n\tat org.apache.spark.SparkContext.runJob(SparkContext.scala:2120)\n\tat org.apache.spark.rdd.RDD$$anonfun$collect$1.apply(RDD.scala:936)\n\tat org.apache.spark.rdd.RDDOperationScope$.withScope(RDDOperationScope.scala:151)\n\tat org.apache.spark.rdd.RDDOperationScope$.withScope(RDDOperationScope.scala:112)\n\tat org.apache.spark.rdd.RDD.withScope(RDD.scala:362)\n\tat org.apache.spark.rdd.RDD.collect(RDD.scala:935)\n\tat org.apache.spark.mllib.evaluation.BinaryClassificationMetrics.x$4$lzycompute(BinaryClassificationMetrics.scala:192)\n\tat org.apache.spark.mllib.evaluation.BinaryClassificationMetrics.x$4(BinaryClassificationMetrics.scala:146)\n\tat org.apache.spark.mllib.evaluation.BinaryClassificationMetrics.confusions$lzycompute(BinaryClassificationMetrics.scala:148)\n\tat org.apache.spark.mllib.evaluation.BinaryClassificationMetrics.confusions(BinaryClassificationMetrics.scala:148)\n\tat org.apache.spark.mllib.evaluation.BinaryClassificationMetrics.createCurve(BinaryClassificationMetrics.scala:223)\n\tat org.apache.spark.mllib.evaluation.BinaryClassificationMetrics.roc(BinaryClassificationMetrics.scala:86)\n\tat org.apache.spark.mllib.evaluation.BinaryClassificationMetrics.areaUnderROC(BinaryClassificationMetrics.scala:97)\n\tat org.apache.spark.ml.evaluation.BinaryClassificationEvaluator.evaluate(BinaryClassificationEvaluator.scala:87)\n\tat sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)\n\tat sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)\n\tat sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)\n\tat java.lang.reflect.Method.invoke(Method.java:498)\n\tat py4j.reflection.MethodInvoker.invoke(MethodInvoker.java:244)\n\tat py4j.reflection.ReflectionEngine.invoke(ReflectionEngine.java:357)\n\tat py4j.Gateway.invoke(Gateway.java:280)\n\tat py4j.commands.AbstractCommand.invokeMethod(AbstractCommand.java:132)\n\tat py4j.commands.CallCommand.execute(CallCommand.java:79)\n\tat py4j.GatewayConnection.run(GatewayConnection.java:214)\n\tat java.lang.Thread.run(Thread.java:748)\nCaused by: org.apache.spark.SparkException: Failed to execute user defined function($anonfun$5: (string) =&gt; double)\n\tat org.apache.spark.sql.catalyst.expressions.GeneratedClass$GeneratedIterator.processNext(Unknown Source)\n\tat org.apache.spark.sql.execution.BufferedRowIterator.hasNext(BufferedRowIterator.java:43)\n\tat org.apache.spark.sql.execution.WholeStageCodegenExec$$anonfun$8$$anon$1.hasNext(WholeStageCodegenExec.scala:395)\n\tat scala.collection.Iterator$$anon$11.hasNext(Iterator.scala:408)\n\tat scala.collection.Iterator$$anon$11.hasNext(Iterator.scala:408)\n\tat scala.collection.Iterator$$anon$11.hasNext(Iterator.scala:408)\n\tat org.apache.spark.util.collection.ExternalSorter.insertAll(ExternalSorter.scala:191)\n\tat org.apache.spark.shuffle.sort.SortShuffleWriter.write(SortShuffleWriter.scala:63)\n\tat org.apache.spark.scheduler.ShuffleMapTask.runTask(ShuffleMapTask.scala:96)\n\tat org.apache.spark.scheduler.ShuffleMapTask.runTask(ShuffleMapTask.scala:53)\n\tat org.apache.spark.scheduler.Task.run(Task.scala:108)\n\tat org.apache.spark.executor.Executor$TaskRunner.run(Executor.scala:346)\n\tat java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)\n\tat java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)\n\t... 1 more\nCaused by: org.apache.spark.SparkException: Unseen label: 01008.  To handle unseen labels, set Param handleInvalid to keep.\n\tat org.apache.spark.ml.feature.StringIndexerModel$$anonfun$5.apply(StringIndexer.scala:222)\n\tat org.apache.spark.ml.feature.StringIndexerModel$$anonfun$5.apply(StringIndexer.scala:208)\n\t... 15 more\n</div>","workflows":[],"startTime":1511435057438,"submitTime":1511435057438,"finishTime":1511435058159,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"83c4337d-68af-4483-bd6d-7f1d41dc27b8"},{"version":"CommandV1","origId":620808971867645,"guid":"9aed33af-edd1-479f-a51e-f71fbff33644","subtype":"command","commandType":"auto","position":36.0,"command":"zpis = spark.read.json('/FileStore/tables/zips.json')","commandVersion":0,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\"></div>","arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[{"name":"zpis","typeStr":"pyspark.sql.dataframe.DataFrame","schema":{"fields":[{"metadata":{},"name":"_id","nullable":true,"type":"string"},{"metadata":{},"name":"city","nullable":true,"type":"string"},{"metadata":{},"name":"loc","nullable":true,"type":{"containsNull":true,"elementType":"double","type":"array"}},{"metadata":{},"name":"pop","nullable":true,"type":"long"},{"metadata":{},"name":"state","nullable":true,"type":"string"}],"type":"struct"},"tableIdentifier":null}]},"errorSummary":null,"error":null,"workflows":[],"startTime":1511435871239,"submitTime":1511435871222,"finishTime":1511435873004,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"ab6cbf3c-c89c-4bec-ba5f-9db345732530"},{"version":"CommandV1","origId":620808971867646,"guid":"ea816e43-2386-4934-94e2-ff8a38c491c2","subtype":"command","commandType":"auto","position":37.0,"command":"from pyspark.sql.functions import to_json, from_json, col, struct, lit\nfrom pyspark.sql.types import StructType, StructField\nfrom pyspark.ml.linalg import VectorUDT\n\njson_vec = to_json(struct(struct(lit(1).\n                                  col('loc')\n).alias(\"v\")))\n\nschema = StructType([StructField(\"v\", VectorUDT())])\n\nwith_parsed_vector = df.withColumn(\n    \"parsed_vector\", from_json(json_vec, schema).getItem(\"v\")\n)","commandVersion":0,"state":"error","results":{"type":"html","data":"<div class=\"ansiout\"></div>","arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[]},"errorSummary":"<span class=\"ansired\">TypeError</span>: &apos;Column&apos; object is not callable","error":"<div class=\"ansiout\"><span class=\"ansired\">---------------------------------------------------------------------------</span>\n<span class=\"ansired\">TypeError</span>                                 Traceback (most recent call last)\n<span class=\"ansigreen\">&lt;command-620808971867646&gt;</span> in <span class=\"ansicyan\">&lt;module&gt;</span><span class=\"ansiblue\">()</span>\n<span class=\"ansigreen\">      4</span> <span class=\"ansiyellow\"></span>\n<span class=\"ansigreen\">      5</span> json_vec = to_json(struct(struct(lit(1).\n<span class=\"ansigreen\">----&gt; 6</span><span class=\"ansiyellow\">                                   </span>col<span class=\"ansiyellow\">(</span><span class=\"ansiblue\">&apos;loc&apos;</span><span class=\"ansiyellow\">)</span><span class=\"ansiyellow\"></span>\n<span class=\"ansigreen\">      7</span> ).alias(&quot;v&quot;)))\n<span class=\"ansigreen\">      8</span> <span class=\"ansiyellow\"></span>\n\n<span class=\"ansired\">TypeError</span>: &apos;Column&apos; object is not callable</div>","workflows":[],"startTime":1511437050550,"submitTime":1511437050550,"finishTime":1511437050784,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"be40fa9e-652f-4b1b-81c2-b4c8c4421902"},{"version":"CommandV1","origId":620808971867647,"guid":"d5034147-2dd4-487b-bb85-fd03517f44c0","subtype":"command","commandType":"auto","position":38.0,"command":"with_vec = df.withColumn(\"loc\", as_vector(\"loc\"))\nwith_vec.show()","commandVersion":0,"state":"error","results":{"type":"html","data":"<div class=\"ansiout\"></div>","arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[]},"errorSummary":"<span class=\"ansired\">TypeError</span>: &apos;JavaPackage&apos; object is not callable","error":"<div class=\"ansiout\"><span class=\"ansired\">---------------------------------------------------------------------------</span>\n<span class=\"ansired\">TypeError</span>                                 Traceback (most recent call last)\n<span class=\"ansigreen\">&lt;command-620808971867647&gt;</span> in <span class=\"ansicyan\">&lt;module&gt;</span><span class=\"ansiblue\">()</span>\n<span class=\"ansigreen\">----&gt; 1</span><span class=\"ansiyellow\"> </span>with_vec <span class=\"ansiyellow\">=</span> df<span class=\"ansiyellow\">.</span>withColumn<span class=\"ansiyellow\">(</span><span class=\"ansiblue\">&quot;loc&quot;</span><span class=\"ansiyellow\">,</span> as_vector<span class=\"ansiyellow\">(</span><span class=\"ansiblue\">&quot;loc&quot;</span><span class=\"ansiyellow\">)</span><span class=\"ansiyellow\">)</span><span class=\"ansiyellow\"></span>\n<span class=\"ansigreen\">      2</span> with_vec<span class=\"ansiyellow\">.</span>show<span class=\"ansiyellow\">(</span><span class=\"ansiyellow\">)</span><span class=\"ansiyellow\"></span>\n\n<span class=\"ansigreen\">&lt;command-620808971867646&gt;</span> in <span class=\"ansicyan\">as_vector</span><span class=\"ansiblue\">(col)</span>\n<span class=\"ansigreen\">      4</span> <span class=\"ansigreen\">def</span> as_vector<span class=\"ansiyellow\">(</span>col<span class=\"ansiyellow\">)</span><span class=\"ansiyellow\">:</span><span class=\"ansiyellow\"></span>\n<span class=\"ansigreen\">      5</span>     sc <span class=\"ansiyellow\">=</span> SparkContext<span class=\"ansiyellow\">.</span>getOrCreate<span class=\"ansiyellow\">(</span><span class=\"ansiyellow\">)</span><span class=\"ansiyellow\"></span>\n<span class=\"ansigreen\">----&gt; 6</span><span class=\"ansiyellow\">     </span>f <span class=\"ansiyellow\">=</span> sc<span class=\"ansiyellow\">.</span>_jvm<span class=\"ansiyellow\">.</span>com<span class=\"ansiyellow\">.</span>example<span class=\"ansiyellow\">.</span>spark<span class=\"ansiyellow\">.</span>udfs<span class=\"ansiyellow\">.</span>udfs<span class=\"ansiyellow\">.</span>as_vector<span class=\"ansiyellow\">(</span><span class=\"ansiyellow\">)</span><span class=\"ansiyellow\"></span>\n<span class=\"ansigreen\">      7</span>     <span class=\"ansigreen\">return</span> Column<span class=\"ansiyellow\">(</span>f<span class=\"ansiyellow\">.</span>apply<span class=\"ansiyellow\">(</span>_to_seq<span class=\"ansiyellow\">(</span>sc<span class=\"ansiyellow\">,</span> <span class=\"ansiyellow\">[</span>col<span class=\"ansiyellow\">]</span><span class=\"ansiyellow\">,</span> _to_java_column<span class=\"ansiyellow\">)</span><span class=\"ansiyellow\">)</span><span class=\"ansiyellow\">)</span><span class=\"ansiyellow\"></span>\n\n<span class=\"ansired\">TypeError</span>: &apos;JavaPackage&apos; object is not callable</div>","workflows":[],"startTime":1511436254006,"submitTime":1511436254006,"finishTime":1511436254104,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"d0eca55c-a581-44b1-8be4-33992d75c980"},{"version":"CommandV1","origId":620808971867648,"guid":"8b5e6d4a-3d35-4586-a505-663b0c91fd9c","subtype":"command","commandType":"auto","position":39.0,"command":"zpis.show(2)","commandVersion":0,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\">+-----+-------+--------------------+-----+-----+\n|  _id|   city|                 loc|  pop|state|\n+-----+-------+--------------------+-----+-----+\n|01001| AGAWAM|[-72.622739, 42.0...|15338|   MA|\n|01002|CUSHMAN|[-72.51565, 42.37...|36963|   MA|\n+-----+-------+--------------------+-----+-----+\nonly showing top 2 rows\n\n</div>","arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[]},"errorSummary":"<span class=\"ansired\">NameError</span>: name &apos;show&apos; is not defined","error":"<div class=\"ansiout\"><span class=\"ansired\">---------------------------------------------------------------------------</span>\n<span class=\"ansired\">NameError</span>                                 Traceback (most recent call last)\n<span class=\"ansigreen\">&lt;command-620808971867648&gt;</span> in <span class=\"ansicyan\">&lt;module&gt;</span><span class=\"ansiblue\">()</span>\n<span class=\"ansigreen\">----&gt; 1</span><span class=\"ansiyellow\"> </span>show<span class=\"ansiyellow\">(</span><span class=\"ansiyellow\">)</span><span class=\"ansiyellow\"></span>\n\n<span class=\"ansired\">NameError</span>: name &apos;show&apos; is not defined</div>","workflows":[],"startTime":1511436218553,"submitTime":1511436218543,"finishTime":1511436219029,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"240d4b75-aaba-4b23-9f56-be8c45a3b122"},{"version":"CommandV1","origId":620808971867649,"guid":"ab75922c-4212-49ca-86ee-f5c6e873f5fc","subtype":"command","commandType":"auto","position":40.0,"command":"companies = spark.read.json('/FileStore/tables/companies.json')","commandVersion":0,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\"></div>","arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[{"name":"companies","typeStr":"pyspark.sql.dataframe.DataFrame","schema":{"fields":[{"metadata":{},"name":"_id","nullable":true,"type":{"fields":[{"metadata":{},"name":"$oid","nullable":true,"type":"string"}],"type":"struct"}},{"metadata":{},"name":"acquisition","nullable":true,"type":{"fields":[{"metadata":{},"name":"acquired_day","nullable":true,"type":"long"},{"metadata":{},"name":"acquired_month","nullable":true,"type":"long"},{"metadata":{},"name":"acquired_year","nullable":true,"type":"long"},{"metadata":{},"name":"acquiring_company","nullable":true,"type":{"fields":[{"metadata":{},"name":"name","nullable":true,"type":"string"},{"metadata":{},"name":"permalink","nullable":true,"type":"string"}],"type":"struct"}},{"metadata":{},"name":"price_amount","nullable":true,"type":"long"},{"metadata":{},"name":"price_currency_code","nullable":true,"type":"string"},{"metadata":{},"name":"source_description","nullable":true,"type":"string"},{"metadata":{},"name":"source_url","nullable":true,"type":"string"},{"metadata":{},"name":"term_code","nullable":true,"type":"string"}],"type":"struct"}},{"metadata":{},"name":"acquisitions","nullable":true,"type":{"containsNull":true,"elementType":{"fields":[{"metadata":{},"name":"acquired_day","nullable":true,"type":"long"},{"metadata":{},"name":"acquired_month","nullable":true,"type":"long"},{"metadata":{},"name":"acquired_year","nullable":true,"type":"long"},{"metadata":{},"name":"company","nullable":true,"type":{"fields":[{"metadata":{},"name":"name","nullable":true,"type":"string"},{"metadata":{},"name":"permalink","nullable":true,"type":"string"}],"type":"struct"}},{"metadata":{},"name":"price_amount","nullable":true,"type":"double"},{"metadata":{},"name":"price_currency_code","nullable":true,"type":"string"},{"metadata":{},"name":"source_description","nullable":true,"type":"string"},{"metadata":{},"name":"source_url","nullable":true,"type":"string"},{"metadata":{},"name":"term_code","nullable":true,"type":"string"}],"type":"struct"},"type":"array"}},{"metadata":{},"name":"alias_list","nullable":true,"type":"string"},{"metadata":{},"name":"blog_feed_url","nullable":true,"type":"string"},{"metadata":{},"name":"blog_url","nullable":true,"type":"string"},{"metadata":{},"name":"category_code","nullable":true,"type":"string"},{"metadata":{},"name":"competitions","nullable":true,"type":{"containsNull":true,"elementType":{"fields":[{"metadata":{},"name":"competitor","nullable":true,"type":{"fields":[{"metadata":{},"name":"name","nullable":true,"type":"string"},{"metadata":{},"name":"permalink","nullable":true,"type":"string"}],"type":"struct"}}],"type":"struct"},"type":"array"}},{"metadata":{},"name":"created_at","nullable":true,"type":"string"},{"metadata":{},"name":"crunchbase_url","nullable":true,"type":"string"},{"metadata":{},"name":"deadpooled_day","nullable":true,"type":"long"},{"metadata":{},"name":"deadpooled_month","nullable":true,"type":"long"},{"metadata":{},"name":"deadpooled_url","nullable":true,"type":"string"},{"metadata":{},"name":"deadpooled_year","nullable":true,"type":"long"},{"metadata":{},"name":"description","nullable":true,"type":"string"},{"metadata":{},"name":"email_address","nullable":true,"type":"string"},{"metadata":{},"name":"external_links","nullable":true,"type":{"containsNull":true,"elementType":{"fields":[{"metadata":{},"name":"external_url","nullable":true,"type":"string"},{"metadata":{},"name":"title","nullable":true,"type":"string"}],"type":"struct"},"type":"array"}},{"metadata":{},"name":"founded_day","nullable":true,"type":"long"},{"metadata":{},"name":"founded_month","nullable":true,"type":"long"},{"metadata":{},"name":"founded_year","nullable":true,"type":"long"},{"metadata":{},"name":"funding_rounds","nullable":true,"type":{"containsNull":true,"elementType":{"fields":[{"metadata":{},"name":"funded_day","nullable":true,"type":"long"},{"metadata":{},"name":"funded_month","nullable":true,"type":"long"},{"metadata":{},"name":"funded_year","nullable":true,"type":"long"},{"metadata":{},"name":"id","nullable":true,"type":"long"},{"metadata":{},"name":"investments","nullable":true,"type":{"containsNull":true,"elementType":{"fields":[{"metadata":{},"name":"company","nullable":true,"type":{"fields":[{"metadata":{},"name":"name","nullable":true,"type":"string"},{"metadata":{},"name":"permalink","nullable":true,"type":"string"}],"type":"struct"}},{"metadata":{},"name":"financial_org","nullable":true,"type":{"fields":[{"metadata":{},"name":"name","nullable":true,"type":"string"},{"metadata":{},"name":"permalink","nullable":true,"type":"string"}],"type":"struct"}},{"metadata":{},"name":"person","nullable":true,"type":{"fields":[{"metadata":{},"name":"first_name","nullable":true,"type":"string"},{"metadata":{},"name":"last_name","nullable":true,"type":"string"},{"metadata":{},"name":"permalink","nullable":true,"type":"string"}],"type":"struct"}}],"type":"struct"},"type":"array"}},{"metadata":{},"name":"raised_amount","nullable":true,"type":"double"},{"metadata":{},"name":"raised_currency_code","nullable":true,"type":"string"},{"metadata":{},"name":"round_code","nullable":true,"type":"string"},{"metadata":{},"name":"source_description","nullable":true,"type":"string"},{"metadata":{},"name":"source_url","nullable":true,"type":"string"}],"type":"struct"},"type":"array"}},{"metadata":{},"name":"homepage_url","nullable":true,"type":"string"},{"metadata":{},"name":"image","nullable":true,"type":{"fields":[{"metadata":{},"name":"attribution","nullable":true,"type":"string"},{"metadata":{},"name":"available_sizes","nullable":true,"type":{"containsNull":true,"elementType":{"containsNull":true,"elementType":"string","type":"array"},"type":"array"}}],"type":"struct"}},{"metadata":{},"name":"investments","nullable":true,"type":{"containsNull":true,"elementType":{"fields":[{"metadata":{},"name":"funding_round","nullable":true,"type":{"fields":[{"metadata":{},"name":"company","nullable":true,"type":{"fields":[{"metadata":{},"name":"name","nullable":true,"type":"string"},{"metadata":{},"name":"permalink","nullable":true,"type":"string"}],"type":"struct"}},{"metadata":{},"name":"funded_day","nullable":true,"type":"long"},{"metadata":{},"name":"funded_month","nullable":true,"type":"long"},{"metadata":{},"name":"funded_year","nullable":true,"type":"long"},{"metadata":{},"name":"raised_amount","nullable":true,"type":"long"},{"metadata":{},"name":"raised_currency_code","nullable":true,"type":"string"},{"metadata":{},"name":"round_code","nullable":true,"type":"string"},{"metadata":{},"name":"source_description","nullable":true,"type":"string"},{"metadata":{},"name":"source_url","nullable":true,"type":"string"}],"type":"struct"}}],"type":"struct"},"type":"array"}},{"metadata":{},"name":"ipo","nullable":true,"type":{"fields":[{"metadata":{},"name":"pub_day","nullable":true,"type":"long"},{"metadata":{},"name":"pub_month","nullable":true,"type":"long"},{"metadata":{},"name":"pub_year","nullable":true,"type":"long"},{"metadata":{},"name":"stock_symbol","nullable":true,"type":"string"},{"metadata":{},"name":"valuation_amount","nullable":true,"type":"long"},{"metadata":{},"name":"valuation_currency_code","nullable":true,"type":"string"}],"type":"struct"}},{"metadata":{},"name":"milestones","nullable":true,"type":{"containsNull":true,"elementType":{"fields":[{"metadata":{},"name":"description","nullable":true,"type":"string"},{"metadata":{},"name":"id","nullable":true,"type":"long"},{"metadata":{},"name":"source_description","nullable":true,"type":"string"},{"metadata":{},"name":"source_text","nullable":true,"type":"string"},{"metadata":{},"name":"source_url","nullable":true,"type":"string"},{"metadata":{},"name":"stoneable","nullable":true,"type":{"fields":[{"metadata":{},"name":"name","nullable":true,"type":"string"},{"metadata":{},"name":"permalink","nullable":true,"type":"string"}],"type":"struct"}},{"metadata":{},"name":"stoneable_type","nullable":true,"type":"string"},{"metadata":{},"name":"stoned_acquirer","nullable":true,"type":"string"},{"metadata":{},"name":"stoned_day","nullable":true,"type":"long"},{"metadata":{},"name":"stoned_month","nullable":true,"type":"long"},{"metadata":{},"name":"stoned_value","nullable":true,"type":"string"},{"metadata":{},"name":"stoned_value_type","nullable":true,"type":"string"},{"metadata":{},"name":"stoned_year","nullable":true,"type":"long"}],"type":"struct"},"type":"array"}},{"metadata":{},"name":"name","nullable":true,"type":"string"},{"metadata":{},"name":"number_of_employees","nullable":true,"type":"long"},{"metadata":{},"name":"offices","nullable":true,"type":{"containsNull":true,"elementType":{"fields":[{"metadata":{},"name":"address1","nullable":true,"type":"string"},{"metadata":{},"name":"address2","nullable":true,"type":"string"},{"metadata":{},"name":"city","nullable":true,"type":"string"},{"metadata":{},"name":"country_code","nullable":true,"type":"string"},{"metadata":{},"name":"description","nullable":true,"type":"string"},{"metadata":{},"name":"latitude","nullable":true,"type":"double"},{"metadata":{},"name":"longitude","nullable":true,"type":"double"},{"metadata":{},"name":"state_code","nullable":true,"type":"string"},{"metadata":{},"name":"zip_code","nullable":true,"type":"string"}],"type":"struct"},"type":"array"}},{"metadata":{},"name":"overview","nullable":true,"type":"string"},{"metadata":{},"name":"partners","nullable":true,"type":{"containsNull":true,"elementType":{"fields":[{"metadata":{},"name":"homepage_url","nullable":true,"type":"string"},{"metadata":{},"name":"link_1_name","nullable":true,"type":"string"},{"metadata":{},"name":"link_1_url","nullable":true,"type":"string"},{"metadata":{},"name":"link_2_name","nullable":true,"type":"string"},{"metadata":{},"name":"link_2_url","nullable":true,"type":"string"},{"metadata":{},"name":"link_3_name","nullable":true,"type":"string"},{"metadata":{},"name":"link_3_url","nullable":true,"type":"string"},{"metadata":{},"name":"partner_name","nullable":true,"type":"string"}],"type":"struct"},"type":"array"}},{"metadata":{},"name":"permalink","nullable":true,"type":"string"},{"metadata":{},"name":"phone_number","nullable":true,"type":"string"},{"metadata":{},"name":"products","nullable":true,"type":{"containsNull":true,"elementType":{"fields":[{"metadata":{},"name":"name","nullable":true,"type":"string"},{"metadata":{},"name":"permalink","nullable":true,"type":"string"}],"type":"struct"},"type":"array"}},{"metadata":{},"name":"providerships","nullable":true,"type":{"containsNull":true,"elementType":{"fields":[{"metadata":{},"name":"is_past","nullable":true,"type":"boolean"},{"metadata":{},"name":"provider","nullable":true,"type":{"fields":[{"metadata":{},"name":"name","nullable":true,"type":"string"},{"metadata":{},"name":"permalink","nullable":true,"type":"string"}],"type":"struct"}},{"metadata":{},"name":"title","nullable":true,"type":"string"}],"type":"struct"},"type":"array"}},{"metadata":{},"name":"relationships","nullable":true,"type":{"containsNull":true,"elementType":{"fields":[{"metadata":{},"name":"is_past","nullable":true,"type":"boolean"},{"metadata":{},"name":"person","nullable":true,"type":{"fields":[{"metadata":{},"name":"first_name","nullable":true,"type":"string"},{"metadata":{},"name":"last_name","nullable":true,"type":"string"},{"metadata":{},"name":"permalink","nullable":true,"type":"string"}],"type":"struct"}},{"metadata":{},"name":"title","nullable":true,"type":"string"}],"type":"struct"},"type":"array"}},{"metadata":{},"name":"screenshots","nullable":true,"type":{"containsNull":true,"elementType":{"fields":[{"metadata":{},"name":"attribution","nullable":true,"type":"string"},{"metadata":{},"name":"available_sizes","nullable":true,"type":{"containsNull":true,"elementType":{"containsNull":true,"elementType":"string","type":"array"},"type":"array"}}],"type":"struct"},"type":"array"}},{"metadata":{},"name":"tag_list","nullable":true,"type":"string"},{"metadata":{},"name":"total_money_raised","nullable":true,"type":"string"},{"metadata":{},"name":"twitter_username","nullable":true,"type":"string"},{"metadata":{},"name":"updated_at","nullable":true,"type":"string"},{"metadata":{},"name":"video_embeds","nullable":true,"type":{"containsNull":true,"elementType":{"fields":[{"metadata":{},"name":"description","nullable":true,"type":"string"},{"metadata":{},"name":"embed_code","nullable":true,"type":"string"}],"type":"struct"},"type":"array"}}],"type":"struct"},"tableIdentifier":null}]},"errorSummary":null,"error":null,"workflows":[],"startTime":1511437808210,"submitTime":1511437808194,"finishTime":1511437809577,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"5167a6f2-1f2e-47f4-9891-e1e52080b2fd"},{"version":"CommandV1","origId":620808971867650,"guid":"119d088e-51da-4c79-93c2-04d86d1bf4a1","subtype":"command","commandType":"auto","position":41.0,"command":"companies.show(2)","commandVersion":0,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\">+--------------------+--------------------+------------+------------------+--------------------+--------------------+-------------+--------------------+--------------------+--------------------+--------------+----------------+--------------+---------------+--------------------+-----------------+--------------------+-----------+-------------+------------+--------------------+--------------------+--------------------+-----------+----+--------------------+---------+-------------------+--------------------+--------------------+--------+---------+------------+--------------------+--------------------+--------------------+--------------------+--------------------+------------------+----------------+--------------------+------------+\n|                 _id|         acquisition|acquisitions|        alias_list|       blog_feed_url|            blog_url|category_code|        competitions|          created_at|      crunchbase_url|deadpooled_day|deadpooled_month|deadpooled_url|deadpooled_year|         description|    email_address|      external_links|founded_day|founded_month|founded_year|      funding_rounds|        homepage_url|               image|investments| ipo|          milestones|     name|number_of_employees|             offices|            overview|partners|permalink|phone_number|            products|       providerships|       relationships|         screenshots|            tag_list|total_money_raised|twitter_username|          updated_at|video_embeds|\n+--------------------+--------------------+------------+------------------+--------------------+--------------------+-------------+--------------------+--------------------+--------------------+--------------+----------------+--------------+---------------+--------------------+-----------------+--------------------+-----------+-------------+------------+--------------------+--------------------+--------------------+-----------+----+--------------------+---------+-------------------+--------------------+--------------------+--------+---------+------------+--------------------+--------------------+--------------------+--------------------+--------------------+------------------+----------------+--------------------+------------+\n|[52cdef7c4bab8bd6...|[16,12,2013,[Vigg...|          []|                  |http://digitalqua...|http://digitalqua...|          web|[[[Wikia,wikia]],...|{&quot;$date&quot;:11800758...|http://www.crunch...|          null|            null|          null|              1|Technology Platfo...|info@wetpaint.com|[[http://www.geek...|         17|           10|        2005|[[1,10,2005,888,W...|http://wetpaint-i...|[null,WrappedArra...|         []|null|[[Wetpaint named ...| Wetpaint|                 47|[[710 - 2nd Avenu...|&lt;p&gt;Wetpaint is a ...|      []|     abc2|206.859.6300|[[Wikison Wetpain...|                  []|[[false,[Michael,...|[[null,WrappedArr...|wiki, seattle, el...|            $39.8M| BachelrWetpaint|Sun Dec 08 07:15:...|          []|\n|[52cdef7c4bab8bd6...|                null|          []|Zoho ManageEngine |                    |                    |   enterprise|                  []|{&quot;$date&quot;:11801210...|http://www.crunch...|          null|            null|          null|              2|Server Management...| pr@adventnet.com|                  []|       null|         null|        1996|                  []|http://adventnet.com|[null,WrappedArra...|         []|null|                  []|AdventNet|                600|[[4900 Hopyard Rd...|&lt;p&gt;AdventNet is n...|      []|     abc3|925-924-9500|                  []|[[true,[A Small O...|[[true,[Sridhar,V...|[[null,WrappedArr...|                    |                $0|    manageengine|Wed Oct 31 18:26:...|          []|\n+--------------------+--------------------+------------+------------------+--------------------+--------------------+-------------+--------------------+--------------------+--------------------+--------------+----------------+--------------+---------------+--------------------+-----------------+--------------------+-----------+-------------+------------+--------------------+--------------------+--------------------+-----------+----+--------------------+---------+-------------------+--------------------+--------------------+--------+---------+------------+--------------------+--------------------+--------------------+--------------------+--------------------+------------------+----------------+--------------------+------------+\nonly showing top 2 rows\n\n</div>","arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[]},"errorSummary":null,"error":null,"workflows":[],"startTime":1511437820922,"submitTime":1511437820906,"finishTime":1511437821647,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"07cd9ed5-6c27-402d-8321-1dd3db70deda"}],"dashboards":[],"guid":"0b2b82cd-b01d-4525-ad20-b4237d100185","globalVars":{},"iPythonMetadata":null,"inputWidgets":{}};</script>
<script
 src="https://databricks-prod-cloudfront.cloud.databricks.com/static/bc1c85971ad864da65b19d4f80abe81e111e7bfd8db9cac8f69dc1d94b874689/js/notebook-main.js"
 onerror="window.mainJsLoadError = true;"></script>
<script>var tableOfContentsCell = {"version":"CommandV1","origId":0,"guid":"5524e82e-f98f-4314-8b21-1e9d75123085","subtype":"command","commandType":"auto","position":0.0,"command":"%md [&lsaquo; Back to Table of Contents](index.html)","commandVersion":1,"state":"finished","results":{"type":"raw","data":"","arguments":{}},"errorSummary":null,"error":null,"workflows":[],"startTime":0,"submitTime":0,"finishTime":0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{}};</script>
</head>
<body>
  <script>
if (window.mainJsLoadError) {
  var u = 'https://databricks-prod-cloudfront.cloud.databricks.com/static/bc1c85971ad864da65b19d4f80abe81e111e7bfd8db9cac8f69dc1d94b874689/js/notebook-main.js';
  var b = document.getElementsByTagName('body')[0];
  var c = document.createElement('div');
  c.innerHTML = ('<h1>Network Error</h1>' +
    '<p><b>Please check your network connection and try again.</b></p>' +
    '<p>Could not load a required resource: ' + u + '</p>');
  c.style.margin = '30px';
  c.style.padding = '20px 50px';
  c.style.backgroundColor = '#f5f5f5';
  c.style.borderRadius = '5px';
  b.appendChild(c);
}
</script>
</body>
</html>