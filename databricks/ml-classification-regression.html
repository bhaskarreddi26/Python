<!DOCTYPE html>
<html>
<head>
  <meta name="databricks-html-version" content="1">
<title>ml-classification-regression - Databricks</title>

<meta charset="utf-8">
<meta name="google" content="notranslate">
<meta name="robots" content="nofollow">
<meta http-equiv="Content-Language" content="en">
<meta http-equiv="Content-Type" content="text/html; charset=UTF8">

<link rel="stylesheet" type="text/css" href="https://databricks-prod-cloudfront.cloud.databricks.com/static/bc1c85971ad864da65b19d4f80abe81e111e7bfd8db9cac8f69dc1d94b874689/css/main.css">
<link rel="stylesheet" href="https://databricks-prod-cloudfront.cloud.databricks.com/static/bc1c85971ad864da65b19d4f80abe81e111e7bfd8db9cac8f69dc1d94b874689/css/print.css" media="print">
<link rel="icon" type="image/png" href="https://databricks-prod-cloudfront.cloud.databricks.com/static/bc1c85971ad864da65b19d4f80abe81e111e7bfd8db9cac8f69dc1d94b874689/img/favicon.ico"/>
<script>window.settings = {"enableNotebookNotifications":true,"enableSshKeyUI":false,"defaultInteractivePricePerDBU":0.4,"enableClusterMetricsUI":true,"enableOnDemandClusterType":true,"enableAutoCompleteAsYouType":[],"devTierName":"Community Edition","enableJobsPrefetching":true,"workspaceFeaturedLinks":[{"linkURI":"https://docs.databricks.com/index.html","displayName":"Documentation","icon":"question"},{"linkURI":"https://docs.databricks.com/release-notes/product/index.html","displayName":"Release Notes","icon":"code"},{"linkURI":"https://docs.databricks.com/spark/latest/training/index.html","displayName":"Training & Tutorials","icon":"graduation-cap"}],"enableReservoirTableUI":false,"enableClearStateFeature":true,"dbcForumURL":"http://forums.databricks.com/","enableProtoClusterInfoDeltaPublisher":true,"enableAttachExistingCluster":true,"resetJobListOnConnect":true,"serverlessDefaultSparkVersion":"latest-stable-scala2.11","maxCustomTags":45,"serverlessDefaultMaxWorkers":20,"enableInstanceProfilesUIInJobs":true,"nodeInfo":{"node_types":[{"support_ssh":false,"spark_heap_memory":4800,"instance_type_id":"r3.2xlarge","spark_core_oversubscription_factor":8.0,"node_type_id":"dev-tier-node","description":"Community Optimized","support_cluster_tags":false,"container_memory_mb":6000,"node_instance_type":{"instance_type_id":"r3.2xlarge","provider":"AWS","local_disk_size_gb":160,"compute_units":26.0,"number_of_ips":14,"local_disks":1,"reserved_compute_units":3.64,"gpus":0,"memory_mb":62464,"num_cores":8,"local_disk_type":"AHCI","max_attachable_disks":0,"supported_disk_types":[{"ebs_volume_type":"GENERAL_PURPOSE_SSD"},{"ebs_volume_type":"THROUGHPUT_OPTIMIZED_HDD"}],"reserved_memory_mb":4800},"memory_mb":6144,"is_hidden":false,"category":"Community Edition","num_cores":0.88,"support_port_forwarding":false,"support_ebs_volumes":false,"is_deprecated":false}],"default_node_type_id":"dev-tier-node"},"sqlAclsDisabledMap":{"spark.databricks.acl.enabled":"false","spark.databricks.acl.sqlOnly":"false"},"enableDatabaseSupportClusterChoice":true,"enableClusterAcls":true,"notebookRevisionVisibilityHorizon":999999,"serverlessClusterProductName":"Serverless Pool","showS3TableImportOption":true,"maxEbsVolumesPerInstance":10,"enableRStudioUI":false,"isAdmin":true,"deltaProcessingBatchSize":1000,"timerUpdateQueueLength":100,"sqlAclsEnabledMap":{"spark.databricks.acl.enabled":"true","spark.databricks.acl.sqlOnly":"true"},"enableLargeResultDownload":true,"maxElasticDiskCapacityGB":5000,"serverlessDefaultMinWorkers":2,"zoneInfos":[{"id":"us-west-2c","isDefault":true},{"id":"us-west-2b","isDefault":false},{"id":"us-west-2a","isDefault":false}],"enableCustomSpotPricingUIByTier":false,"serverlessClustersEnabled":false,"enableSentryLogging":false,"enableFindAndReplace":true,"disallowUrlImportExceptFromDocs":false,"defaultStandardClusterModel":{"cluster_name":"","node_type_id":"dev-tier-node","spark_version":"3.5.x-scala2.11","num_workers":0,"aws_attributes":{"first_on_demand":0,"availability":"ON_DEMAND","zone_id":"us-west-2c","spot_bid_price_percent":100},"autotermination_minutes":120,"default_tags":{"Vendor":"Databricks","Creator":"bhaskar.reddi@gmail.com","ClusterName":null,"ClusterId":"<Generated after creation>"}},"enableEBSVolumesUIForJobs":true,"enablePublishNotebooks":true,"enableBitbucketCloud":true,"createTableInNotebookS3Link":{"url":"https://docs.databricks.com/_static/notebooks/data-import/s3.html","displayName":"S3","workspaceFileName":"S3 Example"},"sanitizeHtmlResult":true,"enableJobAclsConfig":false,"enableFullTextSearch":false,"enableElasticSparkUI":false,"enableNewClustersCreate":true,"clusters":true,"allowRunOnPendingClusters":true,"useAutoscalingByDefault":false,"enableAzureToolbar":false,"fileStoreBase":"FileStore","enableEmailInAzure":false,"enableRLibraries":true,"enableTableAclsConfig":false,"enableSshKeyUIInJobs":true,"enableDetachAndAttachSubMenu":true,"configurableSparkOptionsSpec":[{"keyPattern":"spark\\.kryo(\\.[^\\.]+)+","valuePattern":".*","keyPatternDisplay":"spark.kryo.*","valuePatternDisplay":"*","description":"Configuration options for Kryo serialization"},{"keyPattern":"spark\\.io\\.compression\\.codec","valuePattern":"(lzf|snappy|org\\.apache\\.spark\\.io\\.LZFCompressionCodec|org\\.apache\\.spark\\.io\\.SnappyCompressionCodec)","keyPatternDisplay":"spark.io.compression.codec","valuePatternDisplay":"snappy|lzf","description":"The codec used to compress internal data such as RDD partitions, broadcast variables and shuffle outputs."},{"keyPattern":"spark\\.serializer","valuePattern":"(org\\.apache\\.spark\\.serializer\\.JavaSerializer|org\\.apache\\.spark\\.serializer\\.KryoSerializer)","keyPatternDisplay":"spark.serializer","valuePatternDisplay":"org.apache.spark.serializer.JavaSerializer|org.apache.spark.serializer.KryoSerializer","description":"Class to use for serializing objects that will be sent over the network or need to be cached in serialized form."},{"keyPattern":"spark\\.rdd\\.compress","valuePattern":"(true|false)","keyPatternDisplay":"spark.rdd.compress","valuePatternDisplay":"true|false","description":"Whether to compress serialized RDD partitions (e.g. for StorageLevel.MEMORY_ONLY_SER). Can save substantial space at the cost of some extra CPU time."},{"keyPattern":"spark\\.speculation","valuePattern":"(true|false)","keyPatternDisplay":"spark.speculation","valuePatternDisplay":"true|false","description":"Whether to use speculation (recommended off for streaming)"},{"keyPattern":"spark\\.es(\\.[^\\.]+)+","valuePattern":".*","keyPatternDisplay":"spark.es.*","valuePatternDisplay":"*","description":"Configuration options for ElasticSearch"},{"keyPattern":"es(\\.([^\\.]+))+","valuePattern":".*","keyPatternDisplay":"es.*","valuePatternDisplay":"*","description":"Configuration options for ElasticSearch"},{"keyPattern":"spark\\.(storage|shuffle)\\.memoryFraction","valuePattern":"0?\\.0*([1-9])([0-9])*","keyPatternDisplay":"spark.(storage|shuffle).memoryFraction","valuePatternDisplay":"(0.0,1.0)","description":"Fraction of Java heap to use for Spark's shuffle or storage"},{"keyPattern":"spark\\.streaming\\.backpressure\\.enabled","valuePattern":"(true|false)","keyPatternDisplay":"spark.streaming.backpressure.enabled","valuePatternDisplay":"true|false","description":"Enables or disables Spark Streaming's internal backpressure mechanism (since 1.5). This enables the Spark Streaming to control the receiving rate based on the current batch scheduling delays and processing times so that the system receives only as fast as the system can process. Internally, this dynamically sets the maximum receiving rate of receivers. This rate is upper bounded by the values `spark.streaming.receiver.maxRate` and `spark.streaming.kafka.maxRatePerPartition` if they are set."},{"keyPattern":"spark\\.streaming\\.receiver\\.maxRate","valuePattern":"^([0-9]{1,})$","keyPatternDisplay":"spark.streaming.receiver.maxRate","valuePatternDisplay":"numeric","description":"Maximum rate (number of records per second) at which each receiver will receive data. Effectively, each stream will consume at most this number of records per second. Setting this configuration to 0 or a negative number will put no limit on the rate. See the deployment guide in the Spark Streaming programing guide for mode details."},{"keyPattern":"spark\\.streaming\\.kafka\\.maxRatePerPartition","valuePattern":"^([0-9]{1,})$","keyPatternDisplay":"spark.streaming.kafka.maxRatePerPartition","valuePatternDisplay":"numeric","description":"Maximum rate (number of records per second) at which data will be read from each Kafka partition when using the Kafka direct stream API introduced in Spark 1.3. See the Kafka Integration guide for more details."},{"keyPattern":"spark\\.streaming\\.kafka\\.maxRetries","valuePattern":"^([0-9]{1,})$","keyPatternDisplay":"spark.streaming.kafka.maxRetries","valuePatternDisplay":"numeric","description":"Maximum number of consecutive retries the driver will make in order to find the latest offsets on the leader of each partition (a default value of 1 means that the driver will make a maximum of 2 attempts). Only applies to the Kafka direct stream API introduced in Spark 1.3."},{"keyPattern":"spark\\.streaming\\.ui\\.retainedBatches","valuePattern":"^([0-9]{1,})$","keyPatternDisplay":"spark.streaming.ui.retainedBatches","valuePatternDisplay":"numeric","description":"How many batches the Spark Streaming UI and status APIs remember before garbage collecting."}],"enableReactNotebookComments":true,"enableAdminPasswordReset":false,"checkBeforeAddingAadUser":false,"enableResetPassword":true,"maxClusterTagValueLength":255,"enableJobsSparkUpgrade":true,"createTableInNotebookDBFSLink":{"url":"https://docs.databricks.com/_static/notebooks/data-import/dbfs.html","displayName":"DBFS","workspaceFileName":"DBFS Example"},"perClusterAutoterminationEnabled":false,"enableNotebookCommandNumbers":true,"allowStyleInSanitizedHtml":true,"sparkVersions":[{"key":"1.6.3-db2-hadoop2-scala2.10","displayName":"Spark 1.6.3-db2 (Hadoop 2, Scala 2.10)","packageLabel":"spark-image-aba860a0ffce4f3471fb14aefdcb1d768ac66a53a5ad884c48745ef98aeb9d67","upgradable":true,"deprecated":false,"customerVisible":true,"capabilities":[]},{"key":"3.3.x-gpu-scala2.11","displayName":"3.3 (includes Apache Spark 2.2.0, GPU, Scala 2.11)","packageLabel":"spark-image-86b4917bb6586289ca64e65f64fd23678c297274be6cd6aa6aa01d7b91fed29c","upgradable":true,"deprecated":false,"customerVisible":true,"capabilities":[]},{"key":"2.1.1-db5-scala2.11","displayName":"Spark 2.1.1-db5 (Scala 2.11)","packageLabel":"spark-image-08d9fc1551087e0876236f19640c4a83116b1649f15137427d21c9056656e80e","upgradable":true,"deprecated":false,"customerVisible":false,"capabilities":["SUPPORTS_END_TO_END_ENCRYPTION"]},{"key":"1.6.x-ubuntu15.10","displayName":"Spark 1.6.x (Hadoop 1)","packageLabel":"spark-image-8cea23fb9094e174bf5815d79009f4a8e383eb86cf2909cf6c6434ed8da2a16a","upgradable":true,"deprecated":false,"customerVisible":false,"capabilities":[]},{"key":"3.3.x-scala2.10","displayName":"3.3 (includes Apache Spark 2.2.0, Scala 2.10)","packageLabel":"spark-image-d7df74e188103a4093ff4467dbf0d32886366c984097f6997e0cd87d0f6b2fa5","upgradable":true,"deprecated":false,"customerVisible":true,"capabilities":[]},{"key":"1.4.x-ubuntu15.10","displayName":"Spark 1.4.1 (Hadoop 1, deprecated)","packageLabel":"spark-image-f710650fb8aaade8e4e812368ea87c45cd8cd0b5e6894ca6c94f3354e8daa6dc","upgradable":true,"deprecated":false,"customerVisible":false,"capabilities":[]},{"key":"2.2.x-scala2.11","displayName":"3.0 (includes Apache Spark 2.2.0, Scala 2.11)","packageLabel":"spark-image-67ab3a06d1e83d5b60df7063245eb419a2e9fe329aeeb7e7d9713332c669bb17","upgradable":true,"deprecated":false,"customerVisible":false,"capabilities":["SUPPORTS_END_TO_END_ENCRYPTION"]},{"key":"2.1.1-db6-scala2.10","displayName":"Spark 2.1.1-db6 (Scala 2.10)","packageLabel":"spark-image-177f3f02a6a3432d30068332dc857b9161345bdd2ee8a2d2de05bb05cb4b0f4c","upgradable":true,"deprecated":false,"customerVisible":true,"capabilities":["SUPPORTS_END_TO_END_ENCRYPTION"]},{"key":"2.1.0-db2-scala2.11","displayName":"Spark 2.1.0-db2 (Scala 2.11)","packageLabel":"spark-image-267c4490a3ab8a39acdbbd9f1d36f6decdecebf013e30dd677faff50f1d9cf8b","upgradable":true,"deprecated":false,"customerVisible":false,"capabilities":[]},{"key":"4.0.x-scala2.11","displayName":"4.0 beta (Scala 2.11)","packageLabel":"spark-image-806e2bf6ff456b3832d8f4a8da22564cd3dcb6bbb7da2a910fbdc95597ac2fe6","upgradable":true,"deprecated":false,"customerVisible":true,"capabilities":["SUPPORTS_END_TO_END_ENCRYPTION","SUPPORTS_TABLE_ACLS"]},{"key":"2.1.x-gpu-scala2.11","displayName":"Spark 2.1 (Auto-updating, GPU, Scala 2.11 experimental)","packageLabel":"spark-image-d613235f93e0f29838beb2079a958c02a192ed67a502192bc67a8a5f2fb37f35","upgradable":true,"deprecated":false,"customerVisible":true,"capabilities":[]},{"key":"2.0.0-ubuntu15.10-scala2.10","displayName":"Spark 2.0.0 (Scala 2.10)","packageLabel":"spark-image-073c1b52ace74f251fae2680624a0d8d184a8b57096d1c21c5ce56c29be6a37a","upgradable":true,"deprecated":true,"customerVisible":false,"capabilities":[]},{"key":"latest-stable-gpu-scala2.11","displayName":"Latest stable (3.5 LTS, GPU, Scala 2.11)","packageLabel":"spark-image-71e2fd18fdbbb732d6adec03e171846687b6ec85a572e5931e8a9ed9b62e7c32","upgradable":true,"deprecated":false,"customerVisible":false,"capabilities":[]},{"key":"3.4.x-scala2.11","displayName":"3.4 (includes Apache Spark 2.2.0, Scala 2.11)","packageLabel":"spark-image-a5615cb1adf0d2305f2b93188c6720174ec3e782d100fcbfa96ff870392861df","upgradable":true,"deprecated":false,"customerVisible":true,"capabilities":["SUPPORTS_END_TO_END_ENCRYPTION"]},{"key":"2.0.2-db3-scala2.10","displayName":"Spark 2.0.2-db3 (Scala 2.10)","packageLabel":"spark-image-584091dedb690de20e8cf22d9e02fdcce1281edda99eedb441a418d50e28088f","upgradable":true,"deprecated":false,"customerVisible":false,"capabilities":[]},{"key":"3.2.x-scala2.10","displayName":"3.2 (includes Apache Spark 2.2.0, Scala 2.10)","packageLabel":"spark-image-557788bea0eea16bbf7a8ba13ace07e64dd7fc86270bd5cea086097fe886431f","upgradable":true,"deprecated":false,"customerVisible":true,"capabilities":[]},{"key":"latest-experimental-scala2.10","displayName":"Latest experimental (Scala 2.10)","packageLabel":"spark-image-ec81b6840af02ee2321dd8dfe2587437bbcddf024d4ae287f326a98fac406a6c","upgradable":true,"deprecated":false,"customerVisible":false,"capabilities":["SUPPORTS_END_TO_END_ENCRYPTION"]},{"key":"4.0.x-gpu-scala2.11","displayName":"4.0 beta (GPU, Scala 2.11)","packageLabel":"spark-image-26215c96fc1e7eb1a4657d345beb878d79cea7de1363a3ea12a2904dd17eaa18","upgradable":true,"deprecated":false,"customerVisible":true,"capabilities":[]},{"key":"2.1.0-db1-scala2.11","displayName":"Spark 2.1.0-db1 (Scala 2.11)","packageLabel":"spark-image-e8ad5b72cf0f899dcf2b4720c1f572ab0e87a311d6113b943b4e1d4a7edb77eb","upgradable":true,"deprecated":true,"customerVisible":false,"capabilities":[]},{"key":"2.1.1-db4-scala2.11","displayName":"Spark 2.1.1-db4 (Scala 2.11)","packageLabel":"spark-image-52bca0ca866e3f4243d3820a783abf3b9b3b553edf234abef14b892657ceaca9","upgradable":true,"deprecated":false,"customerVisible":true,"capabilities":["SUPPORTS_END_TO_END_ENCRYPTION"]},{"key":"latest-rc-scala2.11","displayName":"Latest RC (4.0, Scala 2.11)","packageLabel":"spark-image-806e2bf6ff456b3832d8f4a8da22564cd3dcb6bbb7da2a910fbdc95597ac2fe6","upgradable":true,"deprecated":false,"customerVisible":false,"capabilities":["SUPPORTS_END_TO_END_ENCRYPTION","SUPPORTS_TABLE_ACLS"]},{"key":"latest-stable-scala2.11","displayName":"Latest stable (3.5 LTS, Scala 2.11)","packageLabel":"spark-image-4f5f9fb3a7177ac43f84a20f819e8ad76833e356707ed0b79812a2f837ac0a06","upgradable":true,"deprecated":false,"customerVisible":false,"capabilities":["SUPPORTS_END_TO_END_ENCRYPTION","SUPPORTS_TABLE_ACLS"]},{"key":"2.1.0-db2-scala2.10","displayName":"Spark 2.1.0-db2 (Scala 2.10)","packageLabel":"spark-image-a2ca4f6b58c95f78dca91b1340305ab3fe32673bd894da2fa8e1dc8a9f8d0478","upgradable":true,"deprecated":false,"customerVisible":false,"capabilities":[]},{"key":"1.6.x-ubuntu15.10-hadoop1","displayName":"Spark 1.6.x (Hadoop 1)","packageLabel":"spark-image-8cea23fb9094e174bf5815d79009f4a8e383eb86cf2909cf6c6434ed8da2a16a","upgradable":true,"deprecated":false,"customerVisible":false,"capabilities":[]},{"key":"2.0.2-db4-scala2.11","displayName":"Spark 2.0.2-db4 (Scala 2.11)","packageLabel":"spark-image-7dbc7583e8271765b8a1508cb9e832768e35489bbde2c4c790bc6766aee2fd7f","upgradable":true,"deprecated":false,"customerVisible":true,"capabilities":[]},{"key":"1.6.1-ubuntu15.10-hadoop1","displayName":"Spark 1.6.1 (Hadoop 1)","packageLabel":"spark-image-21d1cac181b7b8856dd1b4214a3a734f95b5289089349db9d9c926cb87d843db","upgradable":true,"deprecated":true,"customerVisible":false,"capabilities":[]},{"key":"2.0.x-gpu-scala2.11","displayName":"Spark 2.0 (Auto-updating, GPU, Scala 2.11 experimental)","packageLabel":"spark-image-968b89f1d0ec32e1ee4dacd04838cae25ef44370a441224177a37980d539d83a","upgradable":true,"deprecated":false,"customerVisible":true,"capabilities":[]},{"key":"1.6.2-ubuntu15.10-hadoop1","displayName":"Spark 1.6.2 (Hadoop 1)","packageLabel":"spark-image-8cea23fb9094e174bf5815d79009f4a8e383eb86cf2909cf6c6434ed8da2a16a","upgradable":true,"deprecated":true,"customerVisible":false,"capabilities":[]},{"key":"next-major-version-scala2.11","displayName":"Next major version (4.0 snapshot, Scala 2.11)","packageLabel":"spark-image-d6dcf1e5cebb0329df081e7ecd2f3dc93ab96106049cdc80979bb27197d240c1","upgradable":true,"deprecated":false,"customerVisible":false,"capabilities":["SUPPORTS_END_TO_END_ENCRYPTION","SUPPORTS_TABLE_ACLS"]},{"key":"1.6.3-db1-hadoop2-scala2.10","displayName":"Spark 1.6.3-db1 (Hadoop 2, Scala 2.10)","packageLabel":"spark-image-eaa8d9b990015a14e032fb2e2e15be0b8d5af9627cd01d855df728b67969d5d9","upgradable":true,"deprecated":false,"customerVisible":false,"capabilities":[]},{"key":"1.6.3-db2-hadoop1-scala2.10","displayName":"Spark 1.6.3-db2 (Hadoop 1, Scala 2.10)","packageLabel":"spark-image-14112ea0645bea94333a571a150819ce85573cf5541167d905b7e6588645cf3b","upgradable":true,"deprecated":false,"customerVisible":true,"capabilities":[]},{"key":"3.5.x-scala2.10","displayName":"3.5 LTS (includes Apache Spark 2.2.1, Scala 2.10)","packageLabel":"spark-image-fff24a42ff1d42290166196e45860557b34d4af8a5e6e794857bd999865393fb","upgradable":true,"deprecated":false,"customerVisible":true,"capabilities":["SUPPORTS_END_TO_END_ENCRYPTION","SUPPORTS_TABLE_ACLS"]},{"key":"1.6.2-ubuntu15.10-hadoop2","displayName":"Spark 1.6.2 (Hadoop 2)","packageLabel":"spark-image-161245e66d887cd775e23286a54bab0b146143e1289f25bd1732beac454a1561","upgradable":true,"deprecated":true,"customerVisible":false,"capabilities":[]},{"key":"1.6.1-ubuntu15.10-hadoop2","displayName":"Spark 1.6.1 (Hadoop 2)","packageLabel":"spark-image-4cafdf8bc6cba8edad12f441e3b3f0a8ea27da35c896bc8290e16b41fd15496a","upgradable":true,"deprecated":true,"customerVisible":false,"capabilities":[]},{"key":"2.0.2-db2-scala2.10","displayName":"Spark 2.0.2-db2 (Scala 2.10)","packageLabel":"spark-image-36d48f22cca7a907538e07df71847dd22aaf84a852c2eeea2dcefe24c681602f","upgradable":true,"deprecated":true,"customerVisible":false,"capabilities":[]},{"key":"2.0.x-ubuntu15.10-scala2.11","displayName":"Spark 2.0 (Ubuntu 15.10, Scala 2.11, deprecated)","packageLabel":"spark-image-8e1c50d626a52eac5a6c8129e09ae206ba9890f4523775f77af4ad6d99a64c44","upgradable":true,"deprecated":true,"customerVisible":false,"capabilities":[]},{"key":"2.0.x-scala2.10","displayName":"Spark 2.0 (Auto-updating, Scala 2.10)","packageLabel":"spark-image-859e88079f97f58d50e25163b39a1943d1eeac0b6939c5a65faba986477e311a","upgradable":true,"deprecated":false,"customerVisible":true,"capabilities":[]},{"key":"2.1.1-db4-scala2.10","displayName":"Spark 2.1.1-db4 (Scala 2.10)","packageLabel":"spark-image-c7c0224de396cd1563addc1ae4bca6ba823780b6babe6c3729ddf73008f29ba4","upgradable":true,"deprecated":false,"customerVisible":true,"capabilities":["SUPPORTS_END_TO_END_ENCRYPTION"]},{"key":"latest-rc-scala2.10","displayName":"Latest RC (Scala 2.10)","packageLabel":"spark-image-ec81b6840af02ee2321dd8dfe2587437bbcddf024d4ae287f326a98fac406a6c","upgradable":true,"deprecated":false,"customerVisible":false,"capabilities":["SUPPORTS_END_TO_END_ENCRYPTION"]},{"key":"latest-stable-scala2.10","displayName":"Latest stable (3.5 LTS, Scala 2.10)","packageLabel":"spark-image-fff24a42ff1d42290166196e45860557b34d4af8a5e6e794857bd999865393fb","upgradable":true,"deprecated":false,"customerVisible":false,"capabilities":["SUPPORTS_END_TO_END_ENCRYPTION","SUPPORTS_TABLE_ACLS"]},{"key":"2.0.2-db1-scala2.11","displayName":"Spark 2.0.2-db1 (Scala 2.11)","packageLabel":"spark-image-c2d623f03dd44097493c01aa54a941fc31978ebe6d759b36c75b716b2ff6ab9c","upgradable":true,"deprecated":true,"customerVisible":false,"capabilities":[]},{"key":"2.0.2-db4-scala2.10","displayName":"Spark 2.0.2-db4 (Scala 2.10)","packageLabel":"spark-image-859e88079f97f58d50e25163b39a1943d1eeac0b6939c5a65faba986477e311a","upgradable":true,"deprecated":false,"customerVisible":true,"capabilities":[]},{"key":"2.1.1-db5-scala2.10","displayName":"Spark 2.1.1-db5 (Scala 2.10)","packageLabel":"spark-image-74133df2c13950431298d1cab3e865c191d83ac33648a8590495c52fc644c654","upgradable":true,"deprecated":false,"customerVisible":false,"capabilities":["SUPPORTS_END_TO_END_ENCRYPTION"]},{"key":"3.4.x-gpu-scala2.11","displayName":"3.4 (includes Apache Spark 2.2.0, GPU, Scala 2.11)","packageLabel":"spark-image-613a129fcaa93423a4de06407c9f93e341ed5c6b02d69179d2703c8bb47e2b99","upgradable":true,"deprecated":false,"customerVisible":true,"capabilities":[]},{"key":"1.5.x-ubuntu15.10","displayName":"Spark 1.5.2 (Hadoop 1, deprecated)","packageLabel":"spark-image-c9d2a8abf41f157a4acc6d52bc721090346f6fea2de356f3a66e388f54481698","upgradable":true,"deprecated":false,"customerVisible":false,"capabilities":[]},{"key":"latest-experimental-gpu-scala2.11","displayName":"Latest experimental (4.1 snapshot, GPU, Scala 2.11)","packageLabel":"spark-image-dd98d38d8ee4c19720515230e2b52f26f492d0c94b32c9406f1e7a3f259c1779","upgradable":true,"deprecated":false,"customerVisible":false,"capabilities":[]},{"key":"2.2.x-scala2.10","displayName":"3.0 (includes Apache Spark 2.2.0, Scala 2.10)","packageLabel":"spark-image-d549f2d4a523994ecdf37e531b51d5ec7d8be51534bb0ca5322eaad28ba8f557","upgradable":true,"deprecated":false,"customerVisible":false,"capabilities":["SUPPORTS_END_TO_END_ENCRYPTION"]},{"key":"3.0.x-scala2.11","displayName":"3.0 (includes Apache Spark 2.2.0, Scala 2.11)","packageLabel":"spark-image-67ab3a06d1e83d5b60df7063245eb419a2e9fe329aeeb7e7d9713332c669bb17","upgradable":true,"deprecated":false,"customerVisible":false,"capabilities":["SUPPORTS_END_TO_END_ENCRYPTION"]},{"key":"2.0.x-scala2.11","displayName":"Spark 2.0 (Auto-updating, Scala 2.11)","packageLabel":"spark-image-7dbc7583e8271765b8a1508cb9e832768e35489bbde2c4c790bc6766aee2fd7f","upgradable":true,"deprecated":false,"customerVisible":true,"capabilities":[]},{"key":"2.1.x-scala2.10","displayName":"Spark 2.1 (Auto-updating, Scala 2.10)","packageLabel":"spark-image-177f3f02a6a3432d30068332dc857b9161345bdd2ee8a2d2de05bb05cb4b0f4c","upgradable":true,"deprecated":false,"customerVisible":true,"capabilities":["SUPPORTS_END_TO_END_ENCRYPTION"]},{"key":"3.1.x-scala2.11","displayName":"3.1 (includes Apache Spark 2.2.0, Scala 2.11)","packageLabel":"spark-image-241fa8b78ee6343242b1756b18076270894385ff40a81172a6fb5eadf66155d3","upgradable":true,"deprecated":false,"customerVisible":false,"capabilities":[]},{"key":"2.1.0-db3-scala2.10","displayName":"Spark 2.1.0-db3 (Scala 2.10)","packageLabel":"spark-image-25a17d070af155f10c4232dcc6248e36a2eb48c24f8d4fc00f34041b86bd1626","upgradable":true,"deprecated":false,"customerVisible":false,"capabilities":["SUPPORTS_END_TO_END_ENCRYPTION"]},{"key":"2.0.2-db2-scala2.11","displayName":"Spark 2.0.2-db2 (Scala 2.11)","packageLabel":"spark-image-4fa852ba378e97815083b96c9cada7b962a513ec23554a5fc849f7f1dd8c065a","upgradable":true,"deprecated":true,"customerVisible":false,"capabilities":[]},{"key":"3.1.x-scala2.10","displayName":"3.1 (includes Apache Spark 2.2.0, Scala 2.10)","packageLabel":"spark-image-7efac6b9a8f2da59cb4f6d0caac46cfcb3f1ebf64c8073498c42d0360f846714","upgradable":true,"deprecated":false,"customerVisible":false,"capabilities":[]},{"key":"3.3.x-scala2.11","displayName":"3.3 (includes Apache Spark 2.2.0, Scala 2.11)","packageLabel":"spark-image-0badc3d8dfc8cddd55795d02c0b31c76330cfe687d588414f91278197fbc9416","upgradable":true,"deprecated":false,"customerVisible":true,"capabilities":[]},{"key":"next-major-version-gpu-scala2.11","displayName":"Next major version (4.0 snapshot, GPU, Scala 2.11)","packageLabel":"spark-image-fe0b3ec2ae0caa7f2187ebf3a63f7003c29e7d4902f57140fca733452006f27d","upgradable":true,"deprecated":false,"customerVisible":false,"capabilities":[]},{"key":"3.5.x-gpu-scala2.11","displayName":"3.5 LTS (includes Apache Spark 2.2.1, GPU, Scala 2.11)","packageLabel":"spark-image-71e2fd18fdbbb732d6adec03e171846687b6ec85a572e5931e8a9ed9b62e7c32","upgradable":true,"deprecated":false,"customerVisible":true,"capabilities":[]},{"key":"1.3.x-ubuntu15.10","displayName":"Spark 1.3.0 (Hadoop 1, deprecated)","packageLabel":"spark-image-40d2842670bc3dc178b14042501847d76171437ccf70613fa397a7a24c48b912","upgradable":true,"deprecated":false,"customerVisible":false,"capabilities":[]},{"key":"2.0.1-db1-scala2.11","displayName":"Spark 2.0.1-db1 (Scala 2.11)","packageLabel":"spark-image-10ab19f634bbfdb860446c326a9f76dc25bfa87de6403b980566279142a289ea","upgradable":true,"deprecated":true,"customerVisible":false,"capabilities":[]},{"key":"2.0.2-db3-scala2.11","displayName":"Spark 2.0.2-db3 (Scala 2.11)","packageLabel":"spark-image-7fd7aaa89d55692e429115ae7eac3b1a1dc4de705d50510995f34306b39c2397","upgradable":true,"deprecated":false,"customerVisible":false,"capabilities":[]},{"key":"2.1.1-db6-scala2.11","displayName":"Spark 2.1.1-db6 (Scala 2.11)","packageLabel":"spark-image-fdad9ef557700d7a8b6bde86feccbcc3c71d1acdc838b0fd299bd19956b1076e","upgradable":true,"deprecated":false,"customerVisible":true,"capabilities":["SUPPORTS_END_TO_END_ENCRYPTION"]},{"key":"1.6.3-db1-hadoop1-scala2.10","displayName":"Spark 1.6.3-db1 (Hadoop 1, Scala 2.10)","packageLabel":"spark-image-d50af1032799546b8ccbeeb76889a20c819ebc2a0e68ea20920cb30d3895d3ae","upgradable":true,"deprecated":false,"customerVisible":false,"capabilities":[]},{"key":"2.0.2-db1-scala2.10","displayName":"Spark 2.0.2-db1 (Scala 2.10)","packageLabel":"spark-image-654bdd6e9bad70079491987d853b4b7abf3b736fff099701501acaabe0e75c41","upgradable":true,"deprecated":true,"customerVisible":false,"capabilities":[]},{"key":"2.0.x-ubuntu15.10","displayName":"Spark 2.0 (Ubuntu 15.10, Scala 2.10, deprecated)","packageLabel":"spark-image-a659f3909d51b38d297b20532fc807ecf708cfb7440ce9b090c406ab0c1e4b7e","upgradable":true,"deprecated":true,"customerVisible":false,"capabilities":[]},{"key":"3.5.x-scala2.11","displayName":"3.5 LTS (includes Apache Spark 2.2.1, Scala 2.11)","packageLabel":"spark-image-4f5f9fb3a7177ac43f84a20f819e8ad76833e356707ed0b79812a2f837ac0a06","upgradable":true,"deprecated":false,"customerVisible":true,"capabilities":["SUPPORTS_END_TO_END_ENCRYPTION","SUPPORTS_TABLE_ACLS"]},{"key":"latest-experimental-scala2.11","displayName":"Latest experimental (4.1 snapshot, Scala 2.11)","packageLabel":"spark-image-98ea8c54b4bd5547e01ab9e32730370749d1f5a25d92904e134b74cc4931e3ef","upgradable":true,"deprecated":false,"customerVisible":false,"capabilities":["SUPPORTS_END_TO_END_ENCRYPTION","SUPPORTS_TABLE_ACLS"]},{"key":"3.2.x-scala2.11","displayName":"3.2 (includes Apache Spark 2.2.0, Scala 2.11)","packageLabel":"spark-image-5537926238bc55cb6cd76ee0f0789511349abead3781c4780721a845f34b5d4e","upgradable":true,"deprecated":false,"customerVisible":true,"capabilities":[]},{"key":"2.0.1-db1-scala2.10","displayName":"Spark 2.0.1-db1 (Scala 2.10)","packageLabel":"spark-image-5a13c2db3091986a4e7363006cc185c5b1108c7761ef5d0218506cf2e6643840","upgradable":true,"deprecated":true,"customerVisible":false,"capabilities":[]},{"key":"2.1.x-scala2.11","displayName":"Spark 2.1 (Auto-updating, Scala 2.11)","packageLabel":"spark-image-fdad9ef557700d7a8b6bde86feccbcc3c71d1acdc838b0fd299bd19956b1076e","upgradable":true,"deprecated":false,"customerVisible":true,"capabilities":["SUPPORTS_END_TO_END_ENCRYPTION"]},{"key":"2.1.0-db1-scala2.10","displayName":"Spark 2.1.0-db1 (Scala 2.10)","packageLabel":"spark-image-f0ab82a5deb7908e0d159e9af066ba05fb56e1edb35bdad41b7ad2fd62a9b546","upgradable":true,"deprecated":true,"customerVisible":false,"capabilities":[]},{"key":"3.0.x-scala2.10","displayName":"3.0 (includes Apache Spark 2.2.0, Scala 2.10)","packageLabel":"spark-image-d549f2d4a523994ecdf37e531b51d5ec7d8be51534bb0ca5322eaad28ba8f557","upgradable":true,"deprecated":false,"customerVisible":false,"capabilities":["SUPPORTS_END_TO_END_ENCRYPTION"]},{"key":"1.6.0-ubuntu15.10","displayName":"Spark 1.6.0 (Hadoop 1)","packageLabel":"spark-image-10ef758029b8c7e19cd7f4fb52fff9180d75db92ca071bd94c47f3c1171a7cb5","upgradable":true,"deprecated":true,"customerVisible":false,"capabilities":[]},{"key":"1.6.x-ubuntu15.10-hadoop2","displayName":"Spark 1.6.x (Hadoop 2)","packageLabel":"spark-image-161245e66d887cd775e23286a54bab0b146143e1289f25bd1732beac454a1561","upgradable":true,"deprecated":false,"customerVisible":false,"capabilities":[]},{"key":"2.0.0-ubuntu15.10-scala2.11","displayName":"Spark 2.0.0 (Scala 2.11)","packageLabel":"spark-image-b4ec141e751f201399f8358a82efee202560f7ed05e1a04a2ae8778f6324b909","upgradable":true,"deprecated":true,"customerVisible":false,"capabilities":[]},{"key":"2.1.0-db3-scala2.11","displayName":"Spark 2.1.0-db3 (Scala 2.11)","packageLabel":"spark-image-ccbc6b73f158e2001fc1fb8c827bfdde425d8bd6d65cb7b3269784c28bb72c16","upgradable":true,"deprecated":false,"customerVisible":false,"capabilities":["SUPPORTS_END_TO_END_ENCRYPTION"]},{"key":"latest-rc-gpu-scala2.11","displayName":"Latest RC (4.0 GPU, Scala 2.11)","packageLabel":"spark-image-26215c96fc1e7eb1a4657d345beb878d79cea7de1363a3ea12a2904dd17eaa18","upgradable":true,"deprecated":false,"customerVisible":false,"capabilities":[]},{"key":"3.4.x-scala2.10","displayName":"3.4 (includes Apache Spark 2.2.0, Scala 2.10)","packageLabel":"spark-image-b768d65de82a89fbfabff8ec1d2f279ced527c0ec05e83c3ae0c206d2e97edc0","upgradable":true,"deprecated":false,"customerVisible":true,"capabilities":["SUPPORTS_END_TO_END_ENCRYPTION"]}],"enablePresentationMode":false,"enableClearStateAndRunAll":true,"enableTableAclsByTier":false,"enableRestrictedClusterCreation":true,"enableFeedback":true,"enableClusterAutoScaling":false,"enableUserVisibleDefaultTags":true,"defaultNumWorkers":0,"serverContinuationTimeoutMillis":10000,"jobsUnreachableThresholdMillis":60000,"driverStderrFilePrefix":"stderr","enableNotebookRefresh":false,"createTableInNotebookImportedFileLink":{"url":"https://docs.databricks.com/_static/notebooks/data-import/imported-file.html","displayName":"Imported File","workspaceFileName":"Imported File Example"},"accountsOwnerUrl":"https://accounts.cloud.databricks.com/registration.html#login","tableAclsDisabledMap":{"spark.databricks.acl.dfAclsEnabled":"false"},"driverStdoutFilePrefix":"stdout","showDbuPricing":true,"databricksDocsBaseHostname":"docs.databricks.com","defaultNodeTypeToPricingUnitsMap":{"r3.2xlarge":2,"i3.4xlarge":4,"class-node":1,"m4.2xlarge":1.5,"r4.xlarge":1,"m4.4xlarge":3,"Standard_DS5_v2":3,"Standard_D2s_v3":0.5,"Standard_DS14":4,"r4.16xlarge":16,"Standard_DS11":0.5,"Standard_D64s_v3":12,"p2.8xlarge":16,"m4.10xlarge":8,"Standard_D8s_v3":1.5,"Standard_E32s_v3":8,"Standard_DS3":0.75,"Standard_DS2_v2":0.5,"r3.8xlarge":8,"r4.4xlarge":4,"dev-tier-node":1,"Standard_L8s":2,"Standard_E4s_v3":1,"Standard_D3_v2":0.75,"Standard_DS15_v2":5,"Standard_D16s_v3":3,"Standard_D5_v2":3,"Standard_E8s_v3":2,"c3.8xlarge":4,"Standard_E2s_v3":0.5,"Standard_DS3_v2":0.75,"r3.4xlarge":4,"Standard_DS4":1.5,"i2.4xlarge":6,"m4.xlarge":0.75,"r4.8xlarge":8,"Standard_H16":4,"Standard_DS14_v2":4,"r4.large":0.5,"Standard_DS12":1,"development-node":1,"i2.2xlarge":3,"g2.8xlarge":6,"i3.large":0.75,"memory-optimized":1,"m4.large":0.4,"Standard_F4s":0.5,"p2.16xlarge":24,"i3.8xlarge":8,"Standard_D32s_v3":6,"i3.16xlarge":16,"Standard_DS12_v2":1,"Standard_L32s":8,"Standard_D4s_v3":0.75,"Standard_DS13":2,"Standard_DS11_v2":0.5,"Standard_DS13_v2":2,"c3.2xlarge":1,"Standard_L4s":1,"Standard_F16s":2,"c4.2xlarge":1,"Standard_L16s":4,"i2.xlarge":1.5,"Standard_DS2":0.5,"compute-optimized":1,"c4.4xlarge":2,"Standard_D2_v2":0.5,"i3.2xlarge":2,"Standard_E16s_v3":4,"Standard_F8s":1,"c3.4xlarge":2,"g2.2xlarge":1.5,"p2.xlarge":2,"m4.16xlarge":12,"Standard_DS4_v2":1.5,"c4.8xlarge":4,"i3.xlarge":1,"r3.xlarge":1,"r4.2xlarge":2,"i2.8xlarge":12},"tableFilesBaseFolder":"/tables","enableSparkDocsSearch":true,"sparkHistoryServerEnabled":true,"enableClusterAppsUIOnServerless":false,"enableEBSVolumesUI":false,"homePageWelcomeMessage":"Welcome to ","metastoreServiceRowLimit":1000000,"enableIPythonImportExport":true,"enableClusterTagsUIForJobs":true,"enableClusterTagsUI":false,"enableNotebookHistoryDiffing":true,"branch":"2.64.930","accountsLimit":3,"enableSparkEnvironmentVariables":true,"enableX509Authentication":false,"useAADLogin":false,"enableStructuredStreamingNbOptimizations":true,"enableNotebookGitBranching":true,"local":false,"enableNotebookLazyRenderWrapper":false,"enableClusterAutoScalingForJobs":true,"enableStrongPassword":false,"showReleaseNote":true,"displayDefaultContainerMemoryGB":6,"broadenedEditPermission":false,"enableNotebookCommandMode":true,"disableS3TableImport":false,"enableArrayParamsEdit":true,"deploymentMode":"production","useSpotForWorkers":true,"removePasswordInAccountSettings":false,"preferStartTerminatedCluster":false,"enableUserInviteWorkflow":true,"createTableConnectorOptionLinks":[{"url":"https://docs.databricks.com/_static/notebooks/redshift.html","displayName":"Amazon Redshift","workspaceFileName":"Amazon Redshift Example"},{"url":"https://docs.databricks.com/_static/notebooks/structured-streaming-kinesis.html","displayName":"Amazon Kinesis","workspaceFileName":"Amazon Kinesis Example"},{"url":"https://docs.databricks.com/_static/notebooks/data-import/jdbc.html","displayName":"JDBC","workspaceFileName":"JDBC Example"},{"url":"https://docs.databricks.com/_static/notebooks/cassandra.html","displayName":"Cassandra","workspaceFileName":"Cassandra Example"},{"url":"https://docs.databricks.com/_static/notebooks/structured-streaming-etl-kafka.html","displayName":"Kafka","workspaceFileName":"Kafka Example"},{"url":"https://docs.databricks.com/_static/notebooks/redis.html","displayName":"Redis","workspaceFileName":"Redis Example"},{"url":"https://docs.databricks.com/_static/notebooks/elasticsearch.html","displayName":"Elasticsearch","workspaceFileName":"Elasticsearch Example"}],"enableStaticNotebooks":true,"sandboxForUrlSandboxFrame":"allow-scripts allow-popups allow-popups-to-escape-sandbox allow-forms","enableCssTransitions":true,"serverlessEnableElasticDisk":true,"minClusterTagKeyLength":1,"showHomepageFeaturedLinks":true,"pricingURL":"https://databricks.com/product/pricing","enableClusterEdit":true,"enableClusterAclsConfig":false,"useTempS3UrlForTableUpload":false,"notifyLastLogin":false,"enableSshKeyUIByTier":false,"enableCreateClusterOnAttach":true,"defaultAutomatedPricePerDBU":0.2,"enableNotebookGitVersioning":true,"defaultMinWorkers":2,"files":"files/","feedbackEmail":"feedback@databricks.com","enableDriverLogsUI":true,"defaultMaxWorkers":8,"enableWorkspaceAclsConfig":false,"serverlessRunPythonAsLowPrivilegeUser":false,"dropzoneMaxFileSize":2047,"enableNewClustersList":true,"enableNewDashboardViews":true,"enableJobListPermissionFilter":false,"driverLog4jFilePrefix":"log4j","enableSingleSignOn":true,"enableMavenLibraries":true,"displayRowLimit":1000,"deltaProcessingAsyncEnabled":true,"enableSparkEnvironmentVariablesUI":false,"defaultSparkVersion":{"key":"3.5.x-scala2.11","displayName":"3.5 LTS (includes Apache Spark 2.2.1, Scala 2.11)","packageLabel":"spark-image-4f5f9fb3a7177ac43f84a20f819e8ad76833e356707ed0b79812a2f837ac0a06","upgradable":true,"deprecated":false,"customerVisible":true,"capabilities":["SUPPORTS_END_TO_END_ENCRYPTION","SUPPORTS_TABLE_ACLS"]},"deprecatedEnableStructuredDataAcls":false,"enableCustomSpotPricing":false,"enableMountAclsConfig":false,"defaultAutoterminationMin":120,"useDevTierHomePage":true,"disableExportNotebook":false,"enableClusterClone":true,"enableNotebookLineNumbers":true,"enablePublishHub":false,"notebookHubUrl":"http://hub.dev.databricks.com/","showSqlEndpoints":false,"enableNotebookDatasetInfoView":true,"defaultTagKeys":{"CLUSTER_NAME":"ClusterName","VENDOR":"Vendor","CLUSTER_TYPE":"ResourceClass","CREATOR":"Creator","CLUSTER_ID":"ClusterId"},"enableClusterAclsByTier":false,"databricksDocsBaseUrl":"https://docs.databricks.com/","azurePortalLink":"https://portal.azure.com","cloud":"AWS","customSparkVersionPrefix":"custom:","disallowAddingAdmins":true,"enableSparkConfUI":true,"featureTier":"DEVELOPER_BASIC_TIER","mavenCentralSearchEndpoint":"http://search.maven.org/solrsearch/select","defaultServerlessClusterModel":{"cluster_name":"","node_type_id":"i3.2xlarge","spark_version":"latest-stable-scala2.11","num_workers":null,"enable_jdbc_auto_start":true,"custom_tags":{"ResourceClass":"Serverless"},"autoscale":{"min_workers":2,"max_workers":20},"spark_conf":{"spark.databricks.cluster.profile":"serverless","spark.databricks.repl.allowedLanguages":"sql,python","spark.databricks.acl.enabled":"false","spark.databricks.acl.sqlOnly":"false"},"aws_attributes":{"ebs_volume_count":null,"availability":"ON_DEMAND","first_on_demand":1,"ebs_volume_type":null,"spot_bid_price_percent":100,"zone_id":"us-west-2c","ebs_volume_size":null},"autotermination_minutes":0,"enable_elastic_disk":false,"default_tags":{"Vendor":"Databricks","Creator":"bhaskar.reddi@gmail.com","ClusterName":null,"ClusterId":"<Generated after creation>"}},"enableOrgSwitcherUI":true,"bitbucketCloudBaseApiV2Url":"https://api.bitbucket.org/2.0","clustersLimit":1,"enableJdbcImport":true,"enableClusterAppsUIOnNormalClusters":false,"enableElasticDisk":false,"logfiles":"logfiles/","enableRelativeNotebookLinks":true,"enableMultiSelect":true,"homePageLogo":"login/databricks_logoTM_rgb_TM.svg","enableWebappSharding":true,"enableNotebookParamsEdit":true,"enableClusterDeltaUpdates":true,"enableSingleSignOnLogin":false,"separateTableForJobClusters":true,"ebsVolumeSizeLimitGB":{"GENERAL_PURPOSE_SSD":[100,4096],"THROUGHPUT_OPTIMIZED_HDD":[500,4096]},"enableMountAcls":false,"requireEmailUserName":true,"dbcFeedbackURL":"mailto:feedback@databricks.com","enableMountAclService":true,"showVersion":true,"serverlessClustersByDefault":false,"enableWorkspaceAcls":false,"maxClusterTagKeyLength":127,"gitHash":"","clusterTagReservedPrefixes":[],"tableAclsEnabledMap":{"spark.databricks.acl.dfAclsEnabled":"true"},"showWorkspaceFeaturedLinks":true,"signupUrl":"https://databricks.com/try-databricks","databricksDocsNotebookPathPrefix":"^https://docs\\.databricks\\.com/_static/notebooks/.+$","serverlessAttachEbsVolumesByDefault":false,"enableTokensConfig":false,"allowFeedbackForumAccess":true,"enableImportFromUrl":true,"allowDisplayHtmlByUrl":true,"enableTokens":false,"enableMiniClusters":true,"enableNewJobList":true,"enableDebugUI":false,"enableStreamingMetricsDashboard":true,"allowNonAdminUsers":true,"enableSingleSignOnByTier":false,"enableJobsRetryOnTimeout":true,"loginLogo":"/login/databricks_logoTM_rgb_TM.svg","useStandardTierUpgradeTooltips":true,"staticNotebookResourceUrl":"https://databricks-prod-cloudfront.cloud.databricks.com/static/bc1c85971ad864da65b19d4f80abe81e111e7bfd8db9cac8f69dc1d94b874689/","enableSpotClusterType":true,"enableSparkPackages":true,"checkAadUserInWorkspaceTenant":false,"dynamicSparkVersions":true,"useIframeForHtmlResult":false,"enableClusterTagsUIByTier":false,"enableNotebookHistoryUI":true,"addWhitespaceAfterLastNotebookCell":true,"enableClusterLoggingUI":true,"enableDatabaseDropdownInTableUI":true,"showDebugCounters":false,"enableInstanceProfilesUI":false,"enableFolderHtmlExport":true,"homepageFeaturedLinks":[{"linkURI":"https://docs.databricks.com/_static/notebooks/gentle-introduction-to-apache-spark.html","displayName":"Introduction to Apache Spark on Databricks","icon":"img/home/Python_icon.svg"},{"linkURI":"https://docs.databricks.com/_static/notebooks/databricks-for-data-scientists.html","displayName":"Databricks for Data Scientists","icon":"img/home/Scala_icon.svg"},{"linkURI":"https://docs.databricks.com/_static/notebooks/structured-streaming-python.html","displayName":"Introduction to Structured Streaming","icon":"img/home/Python_icon.svg"}],"enableClusterStart":false,"maxImportFileVersion":5,"enableEBSVolumesUIByTier":false,"enableTableAclService":true,"removeSubCommandCodeWhenExport":true,"upgradeURL":"https://accounts.cloud.databricks.com/registration.html#login","maxAutoterminationMinutes":10000,"showResultsFromExternalSearchEngine":true,"autoterminateClustersByDefault":true,"notebookLoadingBackground":"#fff","sshContainerForwardedPort":2200,"enableServerAutoComplete":true,"enableStaticHtmlImport":true,"enableInstanceProfilesByTier":false,"showForgotPasswordLink":true,"defaultMemoryPerContainerMB":6000,"enablePresenceUI":true,"minAutoterminationMinutes":10,"accounts":true,"useOnDemandClustersByDefault":true,"useFramedStaticNotebooks":false,"enableNewProgressReportUI":true,"enableAutoCreateUserUI":true,"defaultCoresPerContainer":4,"showTerminationReason":true,"enableNewClustersGet":true,"showPricePerDBU":false,"showSqlProxyUI":true,"enableNotebookErrorHighlighting":true};</script>
<script>var __DATABRICKS_NOTEBOOK_MODEL = {"version":"NotebookV1","origId":3535249741746098,"name":"ml-classification-regression","language":"python","commands":[{"version":"CommandV1","origId":3535249741746099,"guid":"ec93d774-4c37-436d-bdfa-6b6b9c4594ca","subtype":"command","commandType":"auto","position":1.0,"command":"from pyspark.ml.classification import LogisticRegression, DecisionTreeClassifier\nfrom pyspark.ml import Pipeline\nfrom pyspark.ml.feature import StringIndexer, VectorIndexer\nimport pyspark.ml.evaluation as ev\n# Load training data\ntraining = spark.read.format(\"libsvm\").load(\"/FileStore/tables/sample_libsvm_data.txt\")\n\n#print training.show()\n\nlabelIndexer = StringIndexer(inputCol=\"label\", outputCol=\"indexedLabel\")\n\nfeatureIndexer =\\\n    VectorIndexer(inputCol=\"features\", outputCol=\"indexedFeatures\", maxCategories=4)\n\n(trainingData, testData) = training.randomSplit([0.7, 0.3])\n\nlr = LogisticRegression(maxIter=10, regParam=0.3, elasticNetParam=0.8, labelCol='label')\n\npipeline = Pipeline(stages=[\n        labelIndexer, \n        featureIndexer, \n        lr\n    ])\n\n# Fit the model\nlrModel = lr.fit(trainingData)\ntest_model = lrModel.transform(testData)\n\n#print ('display LR model', test_model.take(1))\nevaluator = ev.BinaryClassificationEvaluator(rawPredictionCol='probability', labelCol='label')\n\nprint(' BinaryClassification areaUnderROC:', evaluator.evaluate(test_model, \n     {evaluator.metricName: 'areaUnderROC'}))\nprint('BinaryClassification areaUnderPR:', evaluator.evaluate(test_model, {evaluator.metricName: 'areaUnderPR'}))\n","commandVersion":0,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\">(&apos; BinaryClassification areaUnderROC:&apos;, 1.0)\n(&apos;BinaryClassification areaUnderPR:&apos;, 1.0)\n</div>","arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[{"name":"training","typeStr":"pyspark.sql.dataframe.DataFrame","schema":{"fields":[{"metadata":{},"name":"label","nullable":true,"type":"double"},{"metadata":{"numFeatures":692},"name":"features","nullable":true,"type":{"class":"org.apache.spark.ml.linalg.VectorUDT","pyClass":"pyspark.ml.linalg.VectorUDT","sqlType":{"fields":[{"metadata":{},"name":"type","nullable":false,"type":"byte"},{"metadata":{},"name":"size","nullable":true,"type":"integer"},{"metadata":{},"name":"indices","nullable":true,"type":{"containsNull":false,"elementType":"integer","type":"array"}},{"metadata":{},"name":"values","nullable":true,"type":{"containsNull":false,"elementType":"double","type":"array"}}],"type":"struct"},"type":"udt"}}],"type":"struct"},"tableIdentifier":null},{"name":"trainingData","typeStr":"pyspark.sql.dataframe.DataFrame","schema":{"fields":[{"metadata":{},"name":"label","nullable":true,"type":"double"},{"metadata":{"numFeatures":692},"name":"features","nullable":true,"type":{"class":"org.apache.spark.ml.linalg.VectorUDT","pyClass":"pyspark.ml.linalg.VectorUDT","sqlType":{"fields":[{"metadata":{},"name":"type","nullable":false,"type":"byte"},{"metadata":{},"name":"size","nullable":true,"type":"integer"},{"metadata":{},"name":"indices","nullable":true,"type":{"containsNull":false,"elementType":"integer","type":"array"}},{"metadata":{},"name":"values","nullable":true,"type":{"containsNull":false,"elementType":"double","type":"array"}}],"type":"struct"},"type":"udt"}}],"type":"struct"},"tableIdentifier":null},{"name":"testData","typeStr":"pyspark.sql.dataframe.DataFrame","schema":{"fields":[{"metadata":{},"name":"label","nullable":true,"type":"double"},{"metadata":{"numFeatures":692},"name":"features","nullable":true,"type":{"class":"org.apache.spark.ml.linalg.VectorUDT","pyClass":"pyspark.ml.linalg.VectorUDT","sqlType":{"fields":[{"metadata":{},"name":"type","nullable":false,"type":"byte"},{"metadata":{},"name":"size","nullable":true,"type":"integer"},{"metadata":{},"name":"indices","nullable":true,"type":{"containsNull":false,"elementType":"integer","type":"array"}},{"metadata":{},"name":"values","nullable":true,"type":{"containsNull":false,"elementType":"double","type":"array"}}],"type":"struct"},"type":"udt"}}],"type":"struct"},"tableIdentifier":null},{"name":"test_model","typeStr":"pyspark.sql.dataframe.DataFrame","schema":{"fields":[{"metadata":{},"name":"label","nullable":true,"type":"double"},{"metadata":{"numFeatures":692},"name":"features","nullable":true,"type":{"class":"org.apache.spark.ml.linalg.VectorUDT","pyClass":"pyspark.ml.linalg.VectorUDT","sqlType":{"fields":[{"metadata":{},"name":"type","nullable":false,"type":"byte"},{"metadata":{},"name":"size","nullable":true,"type":"integer"},{"metadata":{},"name":"indices","nullable":true,"type":{"containsNull":false,"elementType":"integer","type":"array"}},{"metadata":{},"name":"values","nullable":true,"type":{"containsNull":false,"elementType":"double","type":"array"}}],"type":"struct"},"type":"udt"}},{"metadata":{},"name":"rawPrediction","nullable":true,"type":{"class":"org.apache.spark.ml.linalg.VectorUDT","pyClass":"pyspark.ml.linalg.VectorUDT","sqlType":{"fields":[{"metadata":{},"name":"type","nullable":false,"type":"byte"},{"metadata":{},"name":"size","nullable":true,"type":"integer"},{"metadata":{},"name":"indices","nullable":true,"type":{"containsNull":false,"elementType":"integer","type":"array"}},{"metadata":{},"name":"values","nullable":true,"type":{"containsNull":false,"elementType":"double","type":"array"}}],"type":"struct"},"type":"udt"}},{"metadata":{},"name":"probability","nullable":true,"type":{"class":"org.apache.spark.ml.linalg.VectorUDT","pyClass":"pyspark.ml.linalg.VectorUDT","sqlType":{"fields":[{"metadata":{},"name":"type","nullable":false,"type":"byte"},{"metadata":{},"name":"size","nullable":true,"type":"integer"},{"metadata":{},"name":"indices","nullable":true,"type":{"containsNull":false,"elementType":"integer","type":"array"}},{"metadata":{},"name":"values","nullable":true,"type":{"containsNull":false,"elementType":"double","type":"array"}}],"type":"struct"},"type":"udt"}},{"metadata":{},"name":"prediction","nullable":false,"type":"double"}],"type":"struct"},"tableIdentifier":null}]},"errorSummary":"org.apache.spark.SparkException: Job aborted due to stage failure: Task 0 in stage 3975.0 failed 1 times, most recent failure: Lost task 0.0 in stage 3975.0 (TID 3992, localhost, executor driver): org.apache.spark.SparkException: Failed to execute user defined function($anonfun$11: (vector) =&gt; vector)","error":"<div class=\"ansiout\"><span class=\"ansired\">---------------------------------------------------------------------------</span>\n<span class=\"ansired\">Py4JJavaError</span>                             Traceback (most recent call last)\n<span class=\"ansigreen\">&lt;command-3535249741746099&gt;</span> in <span class=\"ansicyan\">&lt;module&gt;</span><span class=\"ansiblue\">()</span>\n<span class=\"ansigreen\">     44</span> predictions <span class=\"ansiyellow\">=</span> model<span class=\"ansiyellow\">.</span>transform<span class=\"ansiyellow\">(</span>testData<span class=\"ansiyellow\">)</span><span class=\"ansiyellow\"></span>\n<span class=\"ansigreen\">     45</span> <span class=\"ansiyellow\"></span>\n<span class=\"ansigreen\">---&gt; 46</span><span class=\"ansiyellow\"> </span>predictions<span class=\"ansiyellow\">.</span>show<span class=\"ansiyellow\">(</span><span class=\"ansiyellow\">)</span><span class=\"ansiyellow\"></span>\n<span class=\"ansigreen\">     47</span> <span class=\"ansired\">#predictions.select(&quot;prediction&quot;, &quot;indexedLabel&quot;, &quot;features&quot;).show(5)</span><span class=\"ansiyellow\"></span><span class=\"ansiyellow\"></span>\n<span class=\"ansigreen\">     48</span> <span class=\"ansiyellow\"></span>\n\n<span class=\"ansigreen\">/databricks/spark/python/pyspark/sql/dataframe.py</span> in <span class=\"ansicyan\">show</span><span class=\"ansiblue\">(self, n, truncate)</span>\n<span class=\"ansigreen\">    335</span>         &quot;&quot;&quot;\n<span class=\"ansigreen\">    336</span>         <span class=\"ansigreen\">if</span> isinstance<span class=\"ansiyellow\">(</span>truncate<span class=\"ansiyellow\">,</span> bool<span class=\"ansiyellow\">)</span> <span class=\"ansigreen\">and</span> truncate<span class=\"ansiyellow\">:</span><span class=\"ansiyellow\"></span>\n<span class=\"ansigreen\">--&gt; 337</span><span class=\"ansiyellow\">             </span><span class=\"ansigreen\">print</span><span class=\"ansiyellow\">(</span>self<span class=\"ansiyellow\">.</span>_jdf<span class=\"ansiyellow\">.</span>showString<span class=\"ansiyellow\">(</span>n<span class=\"ansiyellow\">,</span> <span class=\"ansicyan\">20</span><span class=\"ansiyellow\">)</span><span class=\"ansiyellow\">)</span><span class=\"ansiyellow\"></span>\n<span class=\"ansigreen\">    338</span>         <span class=\"ansigreen\">else</span><span class=\"ansiyellow\">:</span><span class=\"ansiyellow\"></span>\n<span class=\"ansigreen\">    339</span>             <span class=\"ansigreen\">print</span><span class=\"ansiyellow\">(</span>self<span class=\"ansiyellow\">.</span>_jdf<span class=\"ansiyellow\">.</span>showString<span class=\"ansiyellow\">(</span>n<span class=\"ansiyellow\">,</span> int<span class=\"ansiyellow\">(</span>truncate<span class=\"ansiyellow\">)</span><span class=\"ansiyellow\">)</span><span class=\"ansiyellow\">)</span><span class=\"ansiyellow\"></span>\n\n<span class=\"ansigreen\">/databricks/spark/python/lib/py4j-0.10.4-src.zip/py4j/java_gateway.py</span> in <span class=\"ansicyan\">__call__</span><span class=\"ansiblue\">(self, *args)</span>\n<span class=\"ansigreen\">   1131</span>         answer <span class=\"ansiyellow\">=</span> self<span class=\"ansiyellow\">.</span>gateway_client<span class=\"ansiyellow\">.</span>send_command<span class=\"ansiyellow\">(</span>command<span class=\"ansiyellow\">)</span><span class=\"ansiyellow\"></span>\n<span class=\"ansigreen\">   1132</span>         return_value = get_return_value(\n<span class=\"ansigreen\">-&gt; 1133</span><span class=\"ansiyellow\">             answer, self.gateway_client, self.target_id, self.name)\n</span><span class=\"ansigreen\">   1134</span> <span class=\"ansiyellow\"></span>\n<span class=\"ansigreen\">   1135</span>         <span class=\"ansigreen\">for</span> temp_arg <span class=\"ansigreen\">in</span> temp_args<span class=\"ansiyellow\">:</span><span class=\"ansiyellow\"></span>\n\n<span class=\"ansigreen\">/databricks/spark/python/pyspark/sql/utils.py</span> in <span class=\"ansicyan\">deco</span><span class=\"ansiblue\">(*a, **kw)</span>\n<span class=\"ansigreen\">     61</span>     <span class=\"ansigreen\">def</span> deco<span class=\"ansiyellow\">(</span><span class=\"ansiyellow\">*</span>a<span class=\"ansiyellow\">,</span> <span class=\"ansiyellow\">**</span>kw<span class=\"ansiyellow\">)</span><span class=\"ansiyellow\">:</span><span class=\"ansiyellow\"></span>\n<span class=\"ansigreen\">     62</span>         <span class=\"ansigreen\">try</span><span class=\"ansiyellow\">:</span><span class=\"ansiyellow\"></span>\n<span class=\"ansigreen\">---&gt; 63</span><span class=\"ansiyellow\">             </span><span class=\"ansigreen\">return</span> f<span class=\"ansiyellow\">(</span><span class=\"ansiyellow\">*</span>a<span class=\"ansiyellow\">,</span> <span class=\"ansiyellow\">**</span>kw<span class=\"ansiyellow\">)</span><span class=\"ansiyellow\"></span>\n<span class=\"ansigreen\">     64</span>         <span class=\"ansigreen\">except</span> py4j<span class=\"ansiyellow\">.</span>protocol<span class=\"ansiyellow\">.</span>Py4JJavaError <span class=\"ansigreen\">as</span> e<span class=\"ansiyellow\">:</span><span class=\"ansiyellow\"></span>\n<span class=\"ansigreen\">     65</span>             s <span class=\"ansiyellow\">=</span> e<span class=\"ansiyellow\">.</span>java_exception<span class=\"ansiyellow\">.</span>toString<span class=\"ansiyellow\">(</span><span class=\"ansiyellow\">)</span><span class=\"ansiyellow\"></span>\n\n<span class=\"ansigreen\">/databricks/spark/python/lib/py4j-0.10.4-src.zip/py4j/protocol.py</span> in <span class=\"ansicyan\">get_return_value</span><span class=\"ansiblue\">(answer, gateway_client, target_id, name)</span>\n<span class=\"ansigreen\">    317</span>                 raise Py4JJavaError(\n<span class=\"ansigreen\">    318</span>                     <span class=\"ansiblue\">&quot;An error occurred while calling {0}{1}{2}.\\n&quot;</span><span class=\"ansiyellow\">.</span><span class=\"ansiyellow\"></span>\n<span class=\"ansigreen\">--&gt; 319</span><span class=\"ansiyellow\">                     format(target_id, &quot;.&quot;, name), value)\n</span><span class=\"ansigreen\">    320</span>             <span class=\"ansigreen\">else</span><span class=\"ansiyellow\">:</span><span class=\"ansiyellow\"></span>\n<span class=\"ansigreen\">    321</span>                 raise Py4JError(\n\n<span class=\"ansired\">Py4JJavaError</span>: An error occurred while calling o17502.showString.\n: org.apache.spark.SparkException: Job aborted due to stage failure: Task 0 in stage 3975.0 failed 1 times, most recent failure: Lost task 0.0 in stage 3975.0 (TID 3992, localhost, executor driver): org.apache.spark.SparkException: Failed to execute user defined function($anonfun$11: (vector) =&gt; vector)\n\tat org.apache.spark.sql.catalyst.expressions.GeneratedClass$GeneratedIterator.processNext(Unknown Source)\n\tat org.apache.spark.sql.execution.BufferedRowIterator.hasNext(BufferedRowIterator.java:43)\n\tat org.apache.spark.sql.execution.WholeStageCodegenExec$$anonfun$8$$anon$1.hasNext(WholeStageCodegenExec.scala:395)\n\tat org.apache.spark.sql.execution.SparkPlan$$anonfun$2.apply(SparkPlan.scala:249)\n\tat org.apache.spark.sql.execution.SparkPlan$$anonfun$2.apply(SparkPlan.scala:243)\n\tat org.apache.spark.rdd.RDD$$anonfun$mapPartitionsInternal$1$$anonfun$apply$25.apply(RDD.scala:827)\n\tat org.apache.spark.rdd.RDD$$anonfun$mapPartitionsInternal$1$$anonfun$apply$25.apply(RDD.scala:827)\n\tat org.apache.spark.rdd.MapPartitionsRDD.compute(MapPartitionsRDD.scala:38)\n\tat org.apache.spark.rdd.RDD.computeOrReadCheckpoint(RDD.scala:323)\n\tat org.apache.spark.rdd.RDD.iterator(RDD.scala:287)\n\tat org.apache.spark.scheduler.ResultTask.runTask(ResultTask.scala:87)\n\tat org.apache.spark.scheduler.Task.run(Task.scala:108)\n\tat org.apache.spark.executor.Executor$TaskRunner.run(Executor.scala:346)\n\tat java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)\n\tat java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)\n\tat java.lang.Thread.run(Thread.java:748)\nCaused by: java.util.NoSuchElementException: key not found: 56.0\n\tat scala.collection.MapLike$class.default(MapLike.scala:228)\n\tat scala.collection.AbstractMap.default(Map.scala:59)\n\tat scala.collection.MapLike$class.apply(MapLike.scala:141)\n\tat scala.collection.AbstractMap.apply(Map.scala:59)\n\tat org.apache.spark.ml.feature.VectorIndexerModel$$anonfun$10.apply(VectorIndexer.scala:340)\n\tat org.apache.spark.ml.feature.VectorIndexerModel$$anonfun$10.apply(VectorIndexer.scala:318)\n\tat org.apache.spark.ml.feature.VectorIndexerModel$$anonfun$11.apply(VectorIndexer.scala:363)\n\tat org.apache.spark.ml.feature.VectorIndexerModel$$anonfun$11.apply(VectorIndexer.scala:363)\n\t... 16 more\n\nDriver stacktrace:\n\tat org.apache.spark.scheduler.DAGScheduler.org$apache$spark$scheduler$DAGScheduler$$failJobAndIndependentStages(DAGScheduler.scala:1676)\n\tat org.apache.spark.scheduler.DAGScheduler$$anonfun$abortStage$1.apply(DAGScheduler.scala:1664)\n\tat org.apache.spark.scheduler.DAGScheduler$$anonfun$abortStage$1.apply(DAGScheduler.scala:1663)\n\tat scala.collection.mutable.ResizableArray$class.foreach(ResizableArray.scala:59)\n\tat scala.collection.mutable.ArrayBuffer.foreach(ArrayBuffer.scala:48)\n\tat org.apache.spark.scheduler.DAGScheduler.abortStage(DAGScheduler.scala:1663)\n\tat org.apache.spark.scheduler.DAGScheduler$$anonfun$handleTaskSetFailed$1.apply(DAGScheduler.scala:930)\n\tat org.apache.spark.scheduler.DAGScheduler$$anonfun$handleTaskSetFailed$1.apply(DAGScheduler.scala:930)\n\tat scala.Option.foreach(Option.scala:257)\n\tat org.apache.spark.scheduler.DAGScheduler.handleTaskSetFailed(DAGScheduler.scala:930)\n\tat org.apache.spark.scheduler.DAGSchedulerEventProcessLoop.doOnReceive(DAGScheduler.scala:1896)\n\tat org.apache.spark.scheduler.DAGSchedulerEventProcessLoop.onReceive(DAGScheduler.scala:1847)\n\tat org.apache.spark.scheduler.DAGSchedulerEventProcessLoop.onReceive(DAGScheduler.scala:1835)\n\tat org.apache.spark.util.EventLoop$$anon$1.run(EventLoop.scala:48)\n\tat org.apache.spark.scheduler.DAGScheduler.runJob(DAGScheduler.scala:732)\n\tat org.apache.spark.SparkContext.runJob(SparkContext.scala:2055)\n\tat org.apache.spark.SparkContext.runJob(SparkContext.scala:2076)\n\tat org.apache.spark.SparkContext.runJob(SparkContext.scala:2095)\n\tat org.apache.spark.sql.execution.SparkPlan.executeTake(SparkPlan.scala:361)\n\tat org.apache.spark.sql.execution.CollectLimitExec.executeCollect(limit.scala:38)\n\tat org.apache.spark.sql.Dataset.org$apache$spark$sql$Dataset$$collectFromPlan(Dataset.scala:2925)\n\tat org.apache.spark.sql.Dataset$$anonfun$head$1.apply(Dataset.scala:2215)\n\tat org.apache.spark.sql.Dataset$$anonfun$head$1.apply(Dataset.scala:2215)\n\tat org.apache.spark.sql.Dataset$$anonfun$56.apply(Dataset.scala:2909)\n\tat org.apache.spark.sql.execution.SQLExecution$.withCustomExecutionEnv(SQLExecution.scala:80)\n\tat org.apache.spark.sql.execution.SQLExecution$.withNewExecutionId(SQLExecution.scala:99)\n\tat org.apache.spark.sql.Dataset.withAction(Dataset.scala:2908)\n\tat org.apache.spark.sql.Dataset.head(Dataset.scala:2215)\n\tat org.apache.spark.sql.Dataset.take(Dataset.scala:2428)\n\tat org.apache.spark.sql.Dataset.showString(Dataset.scala:247)\n\tat sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)\n\tat sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)\n\tat sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)\n\tat java.lang.reflect.Method.invoke(Method.java:498)\n\tat py4j.reflection.MethodInvoker.invoke(MethodInvoker.java:244)\n\tat py4j.reflection.ReflectionEngine.invoke(ReflectionEngine.java:357)\n\tat py4j.Gateway.invoke(Gateway.java:280)\n\tat py4j.commands.AbstractCommand.invokeMethod(AbstractCommand.java:132)\n\tat py4j.commands.CallCommand.execute(CallCommand.java:79)\n\tat py4j.GatewayConnection.run(GatewayConnection.java:214)\n\tat java.lang.Thread.run(Thread.java:748)\nCaused by: org.apache.spark.SparkException: Failed to execute user defined function($anonfun$11: (vector) =&gt; vector)\n\tat org.apache.spark.sql.catalyst.expressions.GeneratedClass$GeneratedIterator.processNext(Unknown Source)\n\tat org.apache.spark.sql.execution.BufferedRowIterator.hasNext(BufferedRowIterator.java:43)\n\tat org.apache.spark.sql.execution.WholeStageCodegenExec$$anonfun$8$$anon$1.hasNext(WholeStageCodegenExec.scala:395)\n\tat org.apache.spark.sql.execution.SparkPlan$$anonfun$2.apply(SparkPlan.scala:249)\n\tat org.apache.spark.sql.execution.SparkPlan$$anonfun$2.apply(SparkPlan.scala:243)\n\tat org.apache.spark.rdd.RDD$$anonfun$mapPartitionsInternal$1$$anonfun$apply$25.apply(RDD.scala:827)\n\tat org.apache.spark.rdd.RDD$$anonfun$mapPartitionsInternal$1$$anonfun$apply$25.apply(RDD.scala:827)\n\tat org.apache.spark.rdd.MapPartitionsRDD.compute(MapPartitionsRDD.scala:38)\n\tat org.apache.spark.rdd.RDD.computeOrReadCheckpoint(RDD.scala:323)\n\tat org.apache.spark.rdd.RDD.iterator(RDD.scala:287)\n\tat org.apache.spark.scheduler.ResultTask.runTask(ResultTask.scala:87)\n\tat org.apache.spark.scheduler.Task.run(Task.scala:108)\n\tat org.apache.spark.executor.Executor$TaskRunner.run(Executor.scala:346)\n\tat java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)\n\tat java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)\n\t... 1 more\nCaused by: java.util.NoSuchElementException: key not found: 56.0\n\tat scala.collection.MapLike$class.default(MapLike.scala:228)\n\tat scala.collection.AbstractMap.default(Map.scala:59)\n\tat scala.collection.MapLike$class.apply(MapLike.scala:141)\n\tat scala.collection.AbstractMap.apply(Map.scala:59)\n\tat org.apache.spark.ml.feature.VectorIndexerModel$$anonfun$10.apply(VectorIndexer.scala:340)\n\tat org.apache.spark.ml.feature.VectorIndexerModel$$anonfun$10.apply(VectorIndexer.scala:318)\n\tat org.apache.spark.ml.feature.VectorIndexerModel$$anonfun$11.apply(VectorIndexer.scala:363)\n\tat org.apache.spark.ml.feature.VectorIndexerModel$$anonfun$11.apply(VectorIndexer.scala:363)\n\t... 16 more\n</div>","workflows":[],"startTime":1512140288816,"submitTime":1512140288804,"finishTime":1512140291681,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"8d1dfd25-c56f-441c-b5ff-0adeafef0866"},{"version":"CommandV1","origId":3535249741746103,"guid":"53ac05ce-5e32-45f8-b0cb-db069c0225c4","subtype":"command","commandType":"auto","position":2.0,"command":"import pyspark.ml.tuning as tune\nlogistic = LogisticRegression(\n    labelCol='label')\n\ngrid = tune.ParamGridBuilder() \\\n    .addGrid(logistic.maxIter,  \n             [0, 1, 2, 10, 50]) \\\n    .addGrid(logistic.regParam, \n             [0.002, 0.003, 0.001, 0.005, 0.3]) \\\n    .build()","commandVersion":0,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\"></div>","arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[]},"errorSummary":"<span class=\"ansired\">NameError</span>: name &apos;tune&apos; is not defined","error":"<div class=\"ansiout\"><span class=\"ansired\">---------------------------------------------------------------------------</span>\n<span class=\"ansired\">NameError</span>                                 Traceback (most recent call last)\n<span class=\"ansigreen\">&lt;command-3535249741746103&gt;</span> in <span class=\"ansicyan\">&lt;module&gt;</span><span class=\"ansiblue\">()</span>\n<span class=\"ansigreen\">      2</span>     labelCol=&apos;label&apos;)\n<span class=\"ansigreen\">      3</span> <span class=\"ansiyellow\"></span>\n<span class=\"ansigreen\">----&gt; 4</span><span class=\"ansiyellow\"> grid = tune.ParamGridBuilder()     .addGrid(logistic.maxIter,  \n</span><span class=\"ansigreen\">      5</span>              [2, 10, 50]) \\\n<span class=\"ansigreen\">      6</span>     .addGrid(logistic.regParam, \n\n<span class=\"ansired\">NameError</span>: name &apos;tune&apos; is not defined</div>","workflows":[],"startTime":1512139045096,"submitTime":1512139045085,"finishTime":1512139045225,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"852c9086-67b8-4277-a52d-af120f00b064"},{"version":"CommandV1","origId":3535249741746104,"guid":"b1a55d48-ad4c-4943-8866-ccce7da3998d","subtype":"command","commandType":"auto","position":3.0,"command":"cv = tune.CrossValidator(\n    estimator=logistic, \n    estimatorParamMaps=grid, \n    evaluator=evaluator\n)\npipeline = Pipeline(stages=[featureIndexer])\ndata_transformer = pipeline.fit(trainingData)\ncvModel = cv.fit(data_transformer.transform(trainingData))","commandVersion":0,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\"></div>","arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[]},"errorSummary":"<span class=\"ansired\">TypeError</span>: Invalid param value given for param &quot;maxIter&quot;. Could not convert 0.5 to int","error":"<div class=\"ansiout\"><span class=\"ansired\">---------------------------------------------------------------------------</span>\n<span class=\"ansired\">TypeError</span>                                 Traceback (most recent call last)\n<span class=\"ansigreen\">&lt;command-3535249741746104&gt;</span> in <span class=\"ansicyan\">&lt;module&gt;</span><span class=\"ansiblue\">()</span>\n<span class=\"ansigreen\">      6</span> pipeline <span class=\"ansiyellow\">=</span> Pipeline<span class=\"ansiyellow\">(</span>stages<span class=\"ansiyellow\">=</span><span class=\"ansiyellow\">[</span>featureIndexer<span class=\"ansiyellow\">]</span><span class=\"ansiyellow\">)</span><span class=\"ansiyellow\"></span>\n<span class=\"ansigreen\">      7</span> data_transformer <span class=\"ansiyellow\">=</span> pipeline<span class=\"ansiyellow\">.</span>fit<span class=\"ansiyellow\">(</span>trainingData<span class=\"ansiyellow\">)</span><span class=\"ansiyellow\"></span>\n<span class=\"ansigreen\">----&gt; 8</span><span class=\"ansiyellow\"> </span>cvModel <span class=\"ansiyellow\">=</span> cv<span class=\"ansiyellow\">.</span>fit<span class=\"ansiyellow\">(</span>data_transformer<span class=\"ansiyellow\">.</span>transform<span class=\"ansiyellow\">(</span>trainingData<span class=\"ansiyellow\">)</span><span class=\"ansiyellow\">)</span><span class=\"ansiyellow\"></span>\n\n<span class=\"ansigreen\">/databricks/spark/python/pyspark/ml/base.py</span> in <span class=\"ansicyan\">fit</span><span class=\"ansiblue\">(self, dataset, params)</span>\n<span class=\"ansigreen\">     62</span>                 <span class=\"ansigreen\">return</span> self<span class=\"ansiyellow\">.</span>copy<span class=\"ansiyellow\">(</span>params<span class=\"ansiyellow\">)</span><span class=\"ansiyellow\">.</span>_fit<span class=\"ansiyellow\">(</span>dataset<span class=\"ansiyellow\">)</span><span class=\"ansiyellow\"></span>\n<span class=\"ansigreen\">     63</span>             <span class=\"ansigreen\">else</span><span class=\"ansiyellow\">:</span><span class=\"ansiyellow\"></span>\n<span class=\"ansigreen\">---&gt; 64</span><span class=\"ansiyellow\">                 </span><span class=\"ansigreen\">return</span> self<span class=\"ansiyellow\">.</span>_fit<span class=\"ansiyellow\">(</span>dataset<span class=\"ansiyellow\">)</span><span class=\"ansiyellow\"></span>\n<span class=\"ansigreen\">     65</span>         <span class=\"ansigreen\">else</span><span class=\"ansiyellow\">:</span><span class=\"ansiyellow\"></span>\n<span class=\"ansigreen\">     66</span>             raise ValueError(&quot;Params must be either a param map or a list/tuple of param maps, &quot;\n\n<span class=\"ansigreen\">/databricks/spark/python/pyspark/ml/tuning.py</span> in <span class=\"ansicyan\">_fit</span><span class=\"ansiblue\">(self, dataset)</span>\n<span class=\"ansigreen\">    230</span>             validation <span class=\"ansiyellow\">=</span> df<span class=\"ansiyellow\">.</span>filter<span class=\"ansiyellow\">(</span>condition<span class=\"ansiyellow\">)</span><span class=\"ansiyellow\"></span>\n<span class=\"ansigreen\">    231</span>             train <span class=\"ansiyellow\">=</span> df<span class=\"ansiyellow\">.</span>filter<span class=\"ansiyellow\">(</span><span class=\"ansiyellow\">~</span>condition<span class=\"ansiyellow\">)</span><span class=\"ansiyellow\"></span>\n<span class=\"ansigreen\">--&gt; 232</span><span class=\"ansiyellow\">             </span>models <span class=\"ansiyellow\">=</span> est<span class=\"ansiyellow\">.</span>fit<span class=\"ansiyellow\">(</span>train<span class=\"ansiyellow\">,</span> epm<span class=\"ansiyellow\">)</span><span class=\"ansiyellow\"></span>\n<span class=\"ansigreen\">    233</span>             <span class=\"ansigreen\">for</span> j <span class=\"ansigreen\">in</span> range<span class=\"ansiyellow\">(</span>numModels<span class=\"ansiyellow\">)</span><span class=\"ansiyellow\">:</span><span class=\"ansiyellow\"></span>\n<span class=\"ansigreen\">    234</span>                 model <span class=\"ansiyellow\">=</span> models<span class=\"ansiyellow\">[</span>j<span class=\"ansiyellow\">]</span><span class=\"ansiyellow\"></span>\n\n<span class=\"ansigreen\">/databricks/spark/python/pyspark/ml/base.py</span> in <span class=\"ansicyan\">fit</span><span class=\"ansiblue\">(self, dataset, params)</span>\n<span class=\"ansigreen\">     57</span>             params <span class=\"ansiyellow\">=</span> dict<span class=\"ansiyellow\">(</span><span class=\"ansiyellow\">)</span><span class=\"ansiyellow\"></span>\n<span class=\"ansigreen\">     58</span>         <span class=\"ansigreen\">if</span> isinstance<span class=\"ansiyellow\">(</span>params<span class=\"ansiyellow\">,</span> <span class=\"ansiyellow\">(</span>list<span class=\"ansiyellow\">,</span> tuple<span class=\"ansiyellow\">)</span><span class=\"ansiyellow\">)</span><span class=\"ansiyellow\">:</span><span class=\"ansiyellow\"></span>\n<span class=\"ansigreen\">---&gt; 59</span><span class=\"ansiyellow\">             </span><span class=\"ansigreen\">return</span> <span class=\"ansiyellow\">[</span>self<span class=\"ansiyellow\">.</span>fit<span class=\"ansiyellow\">(</span>dataset<span class=\"ansiyellow\">,</span> paramMap<span class=\"ansiyellow\">)</span> <span class=\"ansigreen\">for</span> paramMap <span class=\"ansigreen\">in</span> params<span class=\"ansiyellow\">]</span><span class=\"ansiyellow\"></span>\n<span class=\"ansigreen\">     60</span>         <span class=\"ansigreen\">elif</span> isinstance<span class=\"ansiyellow\">(</span>params<span class=\"ansiyellow\">,</span> dict<span class=\"ansiyellow\">)</span><span class=\"ansiyellow\">:</span><span class=\"ansiyellow\"></span>\n<span class=\"ansigreen\">     61</span>             <span class=\"ansigreen\">if</span> params<span class=\"ansiyellow\">:</span><span class=\"ansiyellow\"></span>\n\n<span class=\"ansigreen\">/databricks/spark/python/pyspark/ml/base.py</span> in <span class=\"ansicyan\">fit</span><span class=\"ansiblue\">(self, dataset, params)</span>\n<span class=\"ansigreen\">     60</span>         <span class=\"ansigreen\">elif</span> isinstance<span class=\"ansiyellow\">(</span>params<span class=\"ansiyellow\">,</span> dict<span class=\"ansiyellow\">)</span><span class=\"ansiyellow\">:</span><span class=\"ansiyellow\"></span>\n<span class=\"ansigreen\">     61</span>             <span class=\"ansigreen\">if</span> params<span class=\"ansiyellow\">:</span><span class=\"ansiyellow\"></span>\n<span class=\"ansigreen\">---&gt; 62</span><span class=\"ansiyellow\">                 </span><span class=\"ansigreen\">return</span> self<span class=\"ansiyellow\">.</span>copy<span class=\"ansiyellow\">(</span>params<span class=\"ansiyellow\">)</span><span class=\"ansiyellow\">.</span>_fit<span class=\"ansiyellow\">(</span>dataset<span class=\"ansiyellow\">)</span><span class=\"ansiyellow\"></span>\n<span class=\"ansigreen\">     63</span>             <span class=\"ansigreen\">else</span><span class=\"ansiyellow\">:</span><span class=\"ansiyellow\"></span>\n<span class=\"ansigreen\">     64</span>                 <span class=\"ansigreen\">return</span> self<span class=\"ansiyellow\">.</span>_fit<span class=\"ansiyellow\">(</span>dataset<span class=\"ansiyellow\">)</span><span class=\"ansiyellow\"></span>\n\n<span class=\"ansigreen\">/databricks/spark/python/pyspark/ml/wrapper.py</span> in <span class=\"ansicyan\">copy</span><span class=\"ansiblue\">(self, extra)</span>\n<span class=\"ansigreen\">    227</span>         <span class=\"ansigreen\">if</span> extra <span class=\"ansigreen\">is</span> None<span class=\"ansiyellow\">:</span><span class=\"ansiyellow\"></span>\n<span class=\"ansigreen\">    228</span>             extra <span class=\"ansiyellow\">=</span> dict<span class=\"ansiyellow\">(</span><span class=\"ansiyellow\">)</span><span class=\"ansiyellow\"></span>\n<span class=\"ansigreen\">--&gt; 229</span><span class=\"ansiyellow\">         </span>that <span class=\"ansiyellow\">=</span> super<span class=\"ansiyellow\">(</span>JavaParams<span class=\"ansiyellow\">,</span> self<span class=\"ansiyellow\">)</span><span class=\"ansiyellow\">.</span>copy<span class=\"ansiyellow\">(</span>extra<span class=\"ansiyellow\">)</span><span class=\"ansiyellow\"></span>\n<span class=\"ansigreen\">    230</span>         <span class=\"ansigreen\">if</span> self<span class=\"ansiyellow\">.</span>_java_obj <span class=\"ansigreen\">is</span> <span class=\"ansigreen\">not</span> None<span class=\"ansiyellow\">:</span><span class=\"ansiyellow\"></span>\n<span class=\"ansigreen\">    231</span>             that<span class=\"ansiyellow\">.</span>_java_obj <span class=\"ansiyellow\">=</span> self<span class=\"ansiyellow\">.</span>_java_obj<span class=\"ansiyellow\">.</span>copy<span class=\"ansiyellow\">(</span>self<span class=\"ansiyellow\">.</span>_empty_java_param_map<span class=\"ansiyellow\">(</span><span class=\"ansiyellow\">)</span><span class=\"ansiyellow\">)</span><span class=\"ansiyellow\"></span>\n\n<span class=\"ansigreen\">/databricks/spark/python/pyspark/ml/param/__init__.py</span> in <span class=\"ansicyan\">copy</span><span class=\"ansiblue\">(self, extra)</span>\n<span class=\"ansigreen\">    374</span>         that<span class=\"ansiyellow\">.</span>_paramMap <span class=\"ansiyellow\">=</span> <span class=\"ansiyellow\">{</span><span class=\"ansiyellow\">}</span><span class=\"ansiyellow\"></span>\n<span class=\"ansigreen\">    375</span>         that<span class=\"ansiyellow\">.</span>_defaultParamMap <span class=\"ansiyellow\">=</span> <span class=\"ansiyellow\">{</span><span class=\"ansiyellow\">}</span><span class=\"ansiyellow\"></span>\n<span class=\"ansigreen\">--&gt; 376</span><span class=\"ansiyellow\">         </span><span class=\"ansigreen\">return</span> self<span class=\"ansiyellow\">.</span>_copyValues<span class=\"ansiyellow\">(</span>that<span class=\"ansiyellow\">,</span> extra<span class=\"ansiyellow\">)</span><span class=\"ansiyellow\"></span>\n<span class=\"ansigreen\">    377</span> <span class=\"ansiyellow\"></span>\n<span class=\"ansigreen\">    378</span>     <span class=\"ansigreen\">def</span> _shouldOwn<span class=\"ansiyellow\">(</span>self<span class=\"ansiyellow\">,</span> param<span class=\"ansiyellow\">)</span><span class=\"ansiyellow\">:</span><span class=\"ansiyellow\"></span>\n\n<span class=\"ansigreen\">/databricks/spark/python/pyspark/ml/param/__init__.py</span> in <span class=\"ansicyan\">_copyValues</span><span class=\"ansiblue\">(self, to, extra)</span>\n<span class=\"ansigreen\">    463</span>             <span class=\"ansired\"># copy explicitly set params</span><span class=\"ansiyellow\"></span><span class=\"ansiyellow\"></span>\n<span class=\"ansigreen\">    464</span>             <span class=\"ansigreen\">if</span> param <span class=\"ansigreen\">in</span> paramMap <span class=\"ansigreen\">and</span> to<span class=\"ansiyellow\">.</span>hasParam<span class=\"ansiyellow\">(</span>param<span class=\"ansiyellow\">.</span>name<span class=\"ansiyellow\">)</span><span class=\"ansiyellow\">:</span><span class=\"ansiyellow\"></span>\n<span class=\"ansigreen\">--&gt; 465</span><span class=\"ansiyellow\">                 </span>to<span class=\"ansiyellow\">.</span>_set<span class=\"ansiyellow\">(</span><span class=\"ansiyellow\">**</span><span class=\"ansiyellow\">{</span>param<span class=\"ansiyellow\">.</span>name<span class=\"ansiyellow\">:</span> paramMap<span class=\"ansiyellow\">[</span>param<span class=\"ansiyellow\">]</span><span class=\"ansiyellow\">}</span><span class=\"ansiyellow\">)</span><span class=\"ansiyellow\"></span>\n<span class=\"ansigreen\">    466</span>         <span class=\"ansigreen\">return</span> to<span class=\"ansiyellow\"></span>\n<span class=\"ansigreen\">    467</span> <span class=\"ansiyellow\"></span>\n\n<span class=\"ansigreen\">/databricks/spark/python/pyspark/ml/param/__init__.py</span> in <span class=\"ansicyan\">_set</span><span class=\"ansiblue\">(self, **kwargs)</span>\n<span class=\"ansigreen\">    419</span>                     value <span class=\"ansiyellow\">=</span> p<span class=\"ansiyellow\">.</span>typeConverter<span class=\"ansiyellow\">(</span>value<span class=\"ansiyellow\">)</span><span class=\"ansiyellow\"></span>\n<span class=\"ansigreen\">    420</span>                 <span class=\"ansigreen\">except</span> TypeError <span class=\"ansigreen\">as</span> e<span class=\"ansiyellow\">:</span><span class=\"ansiyellow\"></span>\n<span class=\"ansigreen\">--&gt; 421</span><span class=\"ansiyellow\">                     </span><span class=\"ansigreen\">raise</span> TypeError<span class=\"ansiyellow\">(</span><span class=\"ansiblue\">&apos;Invalid param value given for param &quot;%s&quot;. %s&apos;</span> <span class=\"ansiyellow\">%</span> <span class=\"ansiyellow\">(</span>p<span class=\"ansiyellow\">.</span>name<span class=\"ansiyellow\">,</span> e<span class=\"ansiyellow\">)</span><span class=\"ansiyellow\">)</span><span class=\"ansiyellow\"></span>\n<span class=\"ansigreen\">    422</span>             self<span class=\"ansiyellow\">.</span>_paramMap<span class=\"ansiyellow\">[</span>p<span class=\"ansiyellow\">]</span> <span class=\"ansiyellow\">=</span> value<span class=\"ansiyellow\"></span>\n<span class=\"ansigreen\">    423</span>         <span class=\"ansigreen\">return</span> self<span class=\"ansiyellow\"></span>\n\n<span class=\"ansired\">TypeError</span>: Invalid param value given for param &quot;maxIter&quot;. Could not convert 0.5 to int</div>","workflows":[],"startTime":1512139049726,"submitTime":1512139049714,"finishTime":1512139142853,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"1a5209b9-6ee7-4bd8-afa2-e5c5889c9327"},{"version":"CommandV1","origId":3535249741746105,"guid":"2acf0f5c-2d29-47e3-a25e-3870ddbd62d6","subtype":"command","commandType":"auto","position":4.0,"command":"results = [\n    (\n        [\n            {key.name: paramValue} \n            for key, paramValue \n            in zip(\n                params.keys(), \n                params.values())\n        ], metric\n    ) \n    for params, metric \n    in zip(\n        cvModel.getEstimatorParamMaps(), \n        cvModel.avgMetrics\n    )\n]\n\nsorted(results, \n       key=lambda el: el[1], \n       reverse=True)[0]","commandVersion":0,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\"><span class=\"ansired\">Out[</span><span class=\"ansired\">38</span><span class=\"ansired\">]: </span>([{&apos;regParam&apos;: 0.002}, {&apos;maxIter&apos;: 1}], 1.0)\n</div>","arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[]},"errorSummary":"<span class=\"ansired\">NameError</span>: name &apos;cvModel&apos; is not defined","error":"<div class=\"ansiout\"><span class=\"ansired\">---------------------------------------------------------------------------</span>\n<span class=\"ansired\">NameError</span>                                 Traceback (most recent call last)\n<span class=\"ansigreen\">&lt;command-3535249741746105&gt;</span> in <span class=\"ansicyan\">&lt;module&gt;</span><span class=\"ansiblue\">()</span>\n<span class=\"ansigreen\">     11</span>     <span class=\"ansigreen\">for</span> params<span class=\"ansiyellow\">,</span> metric<span class=\"ansiyellow\"></span>\n<span class=\"ansigreen\">     12</span>     in zip(\n<span class=\"ansigreen\">---&gt; 13</span><span class=\"ansiyellow\">         </span>cvModel<span class=\"ansiyellow\">.</span>getEstimatorParamMaps<span class=\"ansiyellow\">(</span><span class=\"ansiyellow\">)</span><span class=\"ansiyellow\">,</span><span class=\"ansiyellow\"></span>\n<span class=\"ansigreen\">     14</span>         cvModel<span class=\"ansiyellow\">.</span>avgMetrics<span class=\"ansiyellow\"></span>\n<span class=\"ansigreen\">     15</span>     )\n\n<span class=\"ansired\">NameError</span>: name &apos;cvModel&apos; is not defined</div>","workflows":[],"startTime":1512139268736,"submitTime":1512139268723,"finishTime":1512139268802,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"7c319ac6-4ebe-48d6-8d79-23e565ab51de"},{"version":"CommandV1","origId":3535249741746106,"guid":"c29fa295-2f7a-4bdc-b377-15aabde11810","subtype":"command","commandType":"auto","position":5.0,"command":"#The spark.ml implementation supports decision trees for binary and multiclass classification and for regression, using both continuous and categorical #features.\n#Param name\tType(s)\tDefault\tDescription\n#labelCol\tDouble\t\"label\"\tLabel to predict\n#featuresCol\tVector\t\"features\"\tFeature vector\n\n#GBTs train one tree at a time, so they can take longer to train than random forests. Random Forests can train multiple trees in parallel.\n#On the other hand, it is often reasonable to use smaller (shallower) trees with GBTs than with Random Forests, and training smaller trees takes less #time.\n#Random Forests can be less prone to overfitting. Training more trees in a Random Forest reduces the likelihood of overfitting, but training more trees #with GBTs increases the likelihood of overfitting. (In statistical language, Random Forests reduce variance by using more trees, whereas GBTs reduce #bias by using more trees.)\n#Random Forests can be easier to tune since performance improves monotonically with the number of trees (whereas performance can start to decrease for #GBTs if the number of trees grows too large).\n\n\nfrom pyspark.ml import Pipeline\nfrom pyspark.ml.classification import DecisionTreeClassifier\nfrom pyspark.ml.feature import StringIndexer, VectorIndexer\nimport pyspark.ml.evaluation as cv\n\n# Load the data stored in LIBSVM format as a DataFrame.\ndata = spark.read.format(\"libsvm\").load(\"/FileStore/tables/sample_libsvm_data.txt\")\n\n# Index labels, adding metadata to the label column.\n# Fit on whole dataset to include all labels in index.\nlabelIndexer = StringIndexer(inputCol=\"label\", outputCol=\"indexedLabel\").fit(data)\n# Automatically identify categorical features, and index them.\n# We specify maxCategories so features with > 4 distinct values are treated as continuous.\nfeatureIndexer =\\\n    VectorIndexer(inputCol=\"features\", outputCol=\"indexedFeatures\", maxCategories=4).fit(data)\n\n# Split the data into training and test sets (30% held out for testing)\n(trainingData, testData) = data.randomSplit([0.7, 0.3])\n\n# Train a DecisionTree model.\ndt = DecisionTreeClassifier(labelCol=\"indexedLabel\", featuresCol=\"indexedFeatures\")\n\n# Chain indexers and tree in a Pipeline\npipeline = Pipeline(stages=[labelIndexer, featureIndexer, dt])\n\n# Train model.  This also runs the indexers.\nmodel = pipeline.fit(trainingData)\n\n# Make predictions.\npredictions = model.transform(testData)\n\n# Select example rows to display.\npredictions.select(\"prediction\", \"indexedLabel\", \"features\").show(5)\n\n# Select (prediction, true label) and compute test error\nevaluator = ev.MulticlassClassificationEvaluator(\n    labelCol=\"indexedLabel\", predictionCol=\"prediction\", metricName=\"accuracy\")\naccuracy = evaluator.evaluate(predictions)\nprint (\"First 5:\", accuracy)\nprint(\"Test Error = %g \" % (1.0 - accuracy))\n","commandVersion":0,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\">+----------+------------+--------------------+\n|prediction|indexedLabel|            features|\n+----------+------------+--------------------+\n|       1.0|         1.0|(692,[98,99,100,1...|\n|       0.0|         1.0|(692,[100,101,102...|\n|       1.0|         1.0|(692,[122,123,148...|\n|       1.0|         1.0|(692,[123,124,125...|\n|       1.0|         1.0|(692,[124,125,126...|\n+----------+------------+--------------------+\nonly showing top 5 rows\n\n(&apos;First 5:&apos;, 0.926829268292683)\nTest Error = 0.0731707 \n</div>","arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[{"name":"data","typeStr":"pyspark.sql.dataframe.DataFrame","schema":{"fields":[{"metadata":{},"name":"label","nullable":true,"type":"double"},{"metadata":{"numFeatures":692},"name":"features","nullable":true,"type":{"class":"org.apache.spark.ml.linalg.VectorUDT","pyClass":"pyspark.ml.linalg.VectorUDT","sqlType":{"fields":[{"metadata":{},"name":"type","nullable":false,"type":"byte"},{"metadata":{},"name":"size","nullable":true,"type":"integer"},{"metadata":{},"name":"indices","nullable":true,"type":{"containsNull":false,"elementType":"integer","type":"array"}},{"metadata":{},"name":"values","nullable":true,"type":{"containsNull":false,"elementType":"double","type":"array"}}],"type":"struct"},"type":"udt"}}],"type":"struct"},"tableIdentifier":null},{"name":"trainingData","typeStr":"pyspark.sql.dataframe.DataFrame","schema":{"fields":[{"metadata":{},"name":"label","nullable":true,"type":"double"},{"metadata":{"numFeatures":692},"name":"features","nullable":true,"type":{"class":"org.apache.spark.ml.linalg.VectorUDT","pyClass":"pyspark.ml.linalg.VectorUDT","sqlType":{"fields":[{"metadata":{},"name":"type","nullable":false,"type":"byte"},{"metadata":{},"name":"size","nullable":true,"type":"integer"},{"metadata":{},"name":"indices","nullable":true,"type":{"containsNull":false,"elementType":"integer","type":"array"}},{"metadata":{},"name":"values","nullable":true,"type":{"containsNull":false,"elementType":"double","type":"array"}}],"type":"struct"},"type":"udt"}}],"type":"struct"},"tableIdentifier":null},{"name":"testData","typeStr":"pyspark.sql.dataframe.DataFrame","schema":{"fields":[{"metadata":{},"name":"label","nullable":true,"type":"double"},{"metadata":{"numFeatures":692},"name":"features","nullable":true,"type":{"class":"org.apache.spark.ml.linalg.VectorUDT","pyClass":"pyspark.ml.linalg.VectorUDT","sqlType":{"fields":[{"metadata":{},"name":"type","nullable":false,"type":"byte"},{"metadata":{},"name":"size","nullable":true,"type":"integer"},{"metadata":{},"name":"indices","nullable":true,"type":{"containsNull":false,"elementType":"integer","type":"array"}},{"metadata":{},"name":"values","nullable":true,"type":{"containsNull":false,"elementType":"double","type":"array"}}],"type":"struct"},"type":"udt"}}],"type":"struct"},"tableIdentifier":null},{"name":"predictions","typeStr":"pyspark.sql.dataframe.DataFrame","schema":{"fields":[{"metadata":{},"name":"label","nullable":true,"type":"double"},{"metadata":{"numFeatures":692},"name":"features","nullable":true,"type":{"class":"org.apache.spark.ml.linalg.VectorUDT","pyClass":"pyspark.ml.linalg.VectorUDT","sqlType":{"fields":[{"metadata":{},"name":"type","nullable":false,"type":"byte"},{"metadata":{},"name":"size","nullable":true,"type":"integer"},{"metadata":{},"name":"indices","nullable":true,"type":{"containsNull":false,"elementType":"integer","type":"array"}},{"metadata":{},"name":"values","nullable":true,"type":{"containsNull":false,"elementType":"double","type":"array"}}],"type":"struct"},"type":"udt"}},{"metadata":{"ml_attr":{"name":"indexedLabel","type":"nominal","vals":["1.0","0.0"]}},"name":"indexedLabel","nullable":false,"type":"double"},{"metadata":{"ml_attr":{"attrs":{"binary":[{"idx":95,"vals":["0.0","56.0"]},{"idx":96,"vals":["0.0","247.0"]},{"idx":119,"vals":["0.0","85.0"]},{"idx":120,"vals":["0.0","253.0"]},{"idx":146,"vals":["0.0","82.0"]},{"idx":147,"vals":["0.0","241.0"]},{"idx":163,"vals":["0.0","85.0"]},{"idx":164,"vals":["0.0","14.0"]},{"idx":174,"vals":["0.0","175.0"]},{"idx":191,"vals":["0.0","250.0"]},{"idx":192,"vals":["0.0","146.0"]},{"idx":220,"vals":["0.0","250.0"]},{"idx":229,"vals":["0.0","23.0"]},{"idx":396,"vals":["0.0","19.0"]},{"idx":592,"vals":["0.0","73.0"]},{"idx":614,"vals":["0.0","140.0"]},{"idx":620,"vals":["0.0","62.0"]},{"idx":649,"vals":["0.0","83.0"]},{"idx":666,"vals":["0.0","10.0"]}],"nominal":[{"idx":0,"ord":false,"vals":["0.0"]},{"idx":1,"ord":false,"vals":["0.0"]},{"idx":2,"ord":false,"vals":["0.0"]},{"idx":3,"ord":false,"vals":["0.0"]},{"idx":4,"ord":false,"vals":["0.0"]},{"idx":5,"ord":false,"vals":["0.0"]},{"idx":6,"ord":false,"vals":["0.0"]},{"idx":7,"ord":false,"vals":["0.0"]},{"idx":8,"ord":false,"vals":["0.0"]},{"idx":9,"ord":false,"vals":["0.0"]},{"idx":10,"ord":false,"vals":["0.0"]},{"idx":11,"ord":false,"vals":["0.0"]},{"idx":12,"ord":false,"vals":["0.0"]},{"idx":13,"ord":false,"vals":["0.0"]},{"idx":14,"ord":false,"vals":["0.0"]},{"idx":15,"ord":false,"vals":["0.0"]},{"idx":16,"ord":false,"vals":["0.0"]},{"idx":17,"ord":false,"vals":["0.0"]},{"idx":18,"ord":false,"vals":["0.0"]},{"idx":19,"ord":false,"vals":["0.0"]},{"idx":20,"ord":false,"vals":["0.0"]},{"idx":21,"ord":false,"vals":["0.0"]},{"idx":22,"ord":false,"vals":["0.0"]},{"idx":23,"ord":false,"vals":["0.0"]},{"idx":24,"ord":false,"vals":["0.0"]},{"idx":25,"ord":false,"vals":["0.0"]},{"idx":26,"ord":false,"vals":["0.0"]},{"idx":27,"ord":false,"vals":["0.0"]},{"idx":28,"ord":false,"vals":["0.0"]},{"idx":29,"ord":false,"vals":["0.0"]},{"idx":30,"ord":false,"vals":["0.0"]},{"idx":31,"ord":false,"vals":["0.0"]},{"idx":32,"ord":false,"vals":["0.0"]},{"idx":33,"ord":false,"vals":["0.0"]},{"idx":34,"ord":false,"vals":["0.0"]},{"idx":35,"ord":false,"vals":["0.0"]},{"idx":36,"ord":false,"vals":["0.0"]},{"idx":37,"ord":false,"vals":["0.0"]},{"idx":38,"ord":false,"vals":["0.0"]},{"idx":39,"ord":false,"vals":["0.0"]},{"idx":40,"ord":false,"vals":["0.0"]},{"idx":41,"ord":false,"vals":["0.0"]},{"idx":42,"ord":false,"vals":["0.0"]},{"idx":43,"ord":false,"vals":["0.0"]},{"idx":44,"ord":false,"vals":["0.0"]},{"idx":45,"ord":false,"vals":["0.0"]},{"idx":46,"ord":false,"vals":["0.0"]},{"idx":47,"ord":false,"vals":["0.0"]},{"idx":48,"ord":false,"vals":["0.0"]},{"idx":49,"ord":false,"vals":["0.0"]},{"idx":50,"ord":false,"vals":["0.0"]},{"idx":51,"ord":false,"vals":["0.0"]},{"idx":52,"ord":false,"vals":["0.0"]},{"idx":53,"ord":false,"vals":["0.0"]},{"idx":54,"ord":false,"vals":["0.0"]},{"idx":55,"ord":false,"vals":["0.0"]},{"idx":56,"ord":false,"vals":["0.0"]},{"idx":57,"ord":false,"vals":["0.0"]},{"idx":58,"ord":false,"vals":["0.0"]},{"idx":59,"ord":false,"vals":["0.0"]},{"idx":60,"ord":false,"vals":["0.0"]},{"idx":61,"ord":false,"vals":["0.0"]},{"idx":62,"ord":false,"vals":["0.0"]},{"idx":63,"ord":false,"vals":["0.0"]},{"idx":64,"ord":false,"vals":["0.0"]},{"idx":65,"ord":false,"vals":["0.0"]},{"idx":66,"ord":false,"vals":["0.0"]},{"idx":67,"ord":false,"vals":["0.0"]},{"idx":68,"ord":false,"vals":["0.0"]},{"idx":69,"ord":false,"vals":["0.0"]},{"idx":70,"ord":false,"vals":["0.0"]},{"idx":71,"ord":false,"vals":["0.0"]},{"idx":72,"ord":false,"vals":["0.0"]},{"idx":73,"ord":false,"vals":["0.0"]},{"idx":74,"ord":false,"vals":["0.0"]},{"idx":75,"ord":false,"vals":["0.0"]},{"idx":76,"ord":false,"vals":["0.0"]},{"idx":77,"ord":false,"vals":["0.0"]},{"idx":78,"ord":false,"vals":["0.0"]},{"idx":79,"ord":false,"vals":["0.0"]},{"idx":80,"ord":false,"vals":["0.0"]},{"idx":81,"ord":false,"vals":["0.0"]},{"idx":82,"ord":false,"vals":["0.0"]},{"idx":83,"ord":false,"vals":["0.0"]},{"idx":84,"ord":false,"vals":["0.0"]},{"idx":85,"ord":false,"vals":["0.0"]},{"idx":86,"ord":false,"vals":["0.0"]},{"idx":87,"ord":false,"vals":["0.0"]},{"idx":88,"ord":false,"vals":["0.0"]},{"idx":89,"ord":false,"vals":["0.0"]},{"idx":90,"ord":false,"vals":["0.0"]},{"idx":91,"ord":false,"vals":["0.0"]},{"idx":92,"ord":false,"vals":["0.0"]},{"idx":93,"ord":false,"vals":["0.0"]},{"idx":94,"ord":false,"vals":["0.0"]},{"idx":97,"ord":false,"vals":["0.0","64.0","121.0"]},{"idx":98,"ord":false,"vals":["0.0","70.0","191.0"]},{"idx":99,"ord":false,"vals":["0.0","70.0","166.0","255.0"]},{"idx":102,"ord":false,"vals":["0.0","5.0","72.0"]},{"idx":103,"ord":false,"vals":["0.0"]},{"idx":104,"ord":false,"vals":["0.0"]},{"idx":105,"ord":false,"vals":["0.0"]},{"idx":106,"ord":false,"vals":["0.0"]},{"idx":107,"ord":false,"vals":["0.0"]},{"idx":108,"ord":false,"vals":["0.0"]},{"idx":109,"ord":false,"vals":["0.0"]},{"idx":110,"ord":false,"vals":["0.0"]},{"idx":111,"ord":false,"vals":["0.0"]},{"idx":112,"ord":false,"vals":["0.0"]},{"idx":113,"ord":false,"vals":["0.0"]},{"idx":114,"ord":false,"vals":["0.0"]},{"idx":115,"ord":false,"vals":["0.0"]},{"idx":116,"ord":false,"vals":["0.0"]},{"idx":117,"ord":false,"vals":["0.0"]},{"idx":118,"ord":false,"vals":["0.0"]},{"idx":121,"ord":false,"vals":["0.0","63.0","132.0"]},{"idx":133,"ord":false,"vals":["0.0","9.0","18.0","52.0"]},{"idx":134,"ord":false,"vals":["0.0"]},{"idx":135,"ord":false,"vals":["0.0"]},{"idx":136,"ord":false,"vals":["0.0"]},{"idx":137,"ord":false,"vals":["0.0"]},{"idx":138,"ord":false,"vals":["0.0"]},{"idx":139,"ord":false,"vals":["0.0"]},{"idx":140,"ord":false,"vals":["0.0"]},{"idx":141,"ord":false,"vals":["0.0"]},{"idx":142,"ord":false,"vals":["0.0"]},{"idx":143,"ord":false,"vals":["0.0"]},{"idx":144,"ord":false,"vals":["0.0"]},{"idx":145,"ord":false,"vals":["0.0"]},{"idx":148,"ord":false,"vals":["0.0","71.0","251.0"]},{"idx":165,"ord":false,"vals":["0.0"]},{"idx":166,"ord":false,"vals":["0.0"]},{"idx":167,"ord":false,"vals":["0.0"]},{"idx":168,"ord":false,"vals":["0.0"]},{"idx":169,"ord":false,"vals":["0.0"]},{"idx":170,"ord":false,"vals":["0.0"]},{"idx":171,"ord":false,"vals":["0.0"]},{"idx":172,"ord":false,"vals":["0.0"]},{"idx":173,"ord":false,"vals":["0.0"]},{"idx":193,"ord":false,"vals":["0.0"]},{"idx":194,"ord":false,"vals":["0.0"]},{"idx":195,"ord":false,"vals":["0.0"]},{"idx":196,"ord":false,"vals":["0.0"]},{"idx":197,"ord":false,"vals":["0.0"]},{"idx":198,"ord":false,"vals":["0.0"]},{"idx":199,"ord":false,"vals":["0.0"]},{"idx":200,"ord":false,"vals":["0.0"]},{"idx":201,"ord":false,"vals":["0.0"]},{"idx":202,"ord":false,"vals":["0.0","13.0","44.0","87.0"]},{"idx":219,"ord":false,"vals":["0.0","18.0","20.0","250.0"]},{"idx":221,"ord":false,"vals":["0.0"]},{"idx":222,"ord":false,"vals":["0.0"]},{"idx":223,"ord":false,"vals":["0.0"]},{"idx":224,"ord":false,"vals":["0.0"]},{"idx":225,"ord":false,"vals":["0.0"]},{"idx":226,"ord":false,"vals":["0.0"]},{"idx":227,"ord":false,"vals":["0.0"]},{"idx":228,"ord":false,"vals":["0.0"]},{"idx":248,"ord":false,"vals":["0.0","13.0","250.0"]},{"idx":249,"ord":false,"vals":["0.0"]},{"idx":250,"ord":false,"vals":["0.0"]},{"idx":251,"ord":false,"vals":["0.0"]},{"idx":252,"ord":false,"vals":["0.0"]},{"idx":253,"ord":false,"vals":["0.0"]},{"idx":254,"ord":false,"vals":["0.0"]},{"idx":255,"ord":false,"vals":["0.0"]},{"idx":256,"ord":false,"vals":["0.0"]},{"idx":257,"ord":false,"vals":["0.0","73.0","120.0"]},{"idx":276,"ord":false,"vals":["0.0","3.0","153.0","252.0"]},{"idx":277,"ord":false,"vals":["0.0"]},{"idx":278,"ord":false,"vals":["0.0"]},{"idx":279,"ord":false,"vals":["0.0"]},{"idx":280,"ord":false,"vals":["0.0"]},{"idx":281,"ord":false,"vals":["0.0"]},{"idx":282,"ord":false,"vals":["0.0"]},{"idx":283,"ord":false,"vals":["0.0"]},{"idx":284,"ord":false,"vals":["0.0"]},{"idx":305,"ord":false,"vals":["0.0"]},{"idx":306,"ord":false,"vals":["0.0"]},{"idx":307,"ord":false,"vals":["0.0"]},{"idx":308,"ord":false,"vals":["0.0"]},{"idx":309,"ord":false,"vals":["0.0"]},{"idx":310,"ord":false,"vals":["0.0"]},{"idx":311,"ord":false,"vals":["0.0"]},{"idx":312,"ord":false,"vals":["0.0"]},{"idx":333,"ord":false,"vals":["0.0"]},{"idx":334,"ord":false,"vals":["0.0"]},{"idx":335,"ord":false,"vals":["0.0"]},{"idx":336,"ord":false,"vals":["0.0"]},{"idx":337,"ord":false,"vals":["0.0"]},{"idx":338,"ord":false,"vals":["0.0"]},{"idx":339,"ord":false,"vals":["0.0"]},{"idx":340,"ord":false,"vals":["0.0"]},{"idx":361,"ord":false,"vals":["0.0"]},{"idx":362,"ord":false,"vals":["0.0"]},{"idx":363,"ord":false,"vals":["0.0"]},{"idx":364,"ord":false,"vals":["0.0"]},{"idx":365,"ord":false,"vals":["0.0"]},{"idx":366,"ord":false,"vals":["0.0"]},{"idx":367,"ord":false,"vals":["0.0"]},{"idx":368,"ord":false,"vals":["0.0"]},{"idx":389,"ord":false,"vals":["0.0"]},{"idx":390,"ord":false,"vals":["0.0"]},{"idx":391,"ord":false,"vals":["0.0"]},{"idx":392,"ord":false,"vals":["0.0"]},{"idx":393,"ord":false,"vals":["0.0"]},{"idx":394,"ord":false,"vals":["0.0"]},{"idx":395,"ord":false,"vals":["0.0"]},{"idx":417,"ord":false,"vals":["0.0"]},{"idx":418,"ord":false,"vals":["0.0"]},{"idx":419,"ord":false,"vals":["0.0"]},{"idx":420,"ord":false,"vals":["0.0"]},{"idx":421,"ord":false,"vals":["0.0"]},{"idx":422,"ord":false,"vals":["0.0"]},{"idx":423,"ord":false,"vals":["0.0"]},{"idx":424,"ord":false,"vals":["0.0","5.0","29.0"]},{"idx":445,"ord":false,"vals":["0.0"]},{"idx":446,"ord":false,"vals":["0.0"]},{"idx":447,"ord":false,"vals":["0.0"]},{"idx":448,"ord":false,"vals":["0.0"]},{"idx":449,"ord":false,"vals":["0.0"]},{"idx":450,"ord":false,"vals":["0.0"]},{"idx":451,"ord":false,"vals":["0.0"]},{"idx":452,"ord":false,"vals":["0.0","24.0","29.0"]},{"idx":473,"ord":false,"vals":["0.0"]},{"idx":474,"ord":false,"vals":["0.0"]},{"idx":475,"ord":false,"vals":["0.0"]},{"idx":476,"ord":false,"vals":["0.0"]},{"idx":477,"ord":false,"vals":["0.0"]},{"idx":478,"ord":false,"vals":["0.0"]},{"idx":479,"ord":false,"vals":["0.0"]},{"idx":501,"ord":false,"vals":["0.0"]},{"idx":502,"ord":false,"vals":["0.0"]},{"idx":503,"ord":false,"vals":["0.0"]},{"idx":504,"ord":false,"vals":["0.0"]},{"idx":505,"ord":false,"vals":["0.0"]},{"idx":506,"ord":false,"vals":["0.0"]},{"idx":507,"ord":false,"vals":["0.0"]},{"idx":529,"ord":false,"vals":["0.0"]},{"idx":530,"ord":false,"vals":["0.0"]},{"idx":531,"ord":false,"vals":["0.0"]},{"idx":532,"ord":false,"vals":["0.0"]},{"idx":533,"ord":false,"vals":["0.0"]},{"idx":534,"ord":false,"vals":["0.0"]},{"idx":535,"ord":false,"vals":["0.0"]},{"idx":557,"ord":false,"vals":["0.0"]},{"idx":558,"ord":false,"vals":["0.0"]},{"idx":559,"ord":false,"vals":["0.0"]},{"idx":560,"ord":false,"vals":["0.0"]},{"idx":561,"ord":false,"vals":["0.0"]},{"idx":562,"ord":false,"vals":["0.0"]},{"idx":563,"ord":false,"vals":["0.0"]},{"idx":564,"ord":false,"vals":["0.0","9.0","20.0","73.0"]},{"idx":584,"ord":false,"vals":["0.0"]},{"idx":585,"ord":false,"vals":["0.0"]},{"idx":586,"ord":false,"vals":["0.0"]},{"idx":587,"ord":false,"vals":["0.0"]},{"idx":588,"ord":false,"vals":["0.0"]},{"idx":589,"ord":false,"vals":["0.0"]},{"idx":590,"ord":false,"vals":["0.0"]},{"idx":591,"ord":false,"vals":["0.0"]},{"idx":611,"ord":false,"vals":["0.0","19.0","20.0","29.0"]},{"idx":612,"ord":false,"vals":["0.0"]},{"idx":613,"ord":false,"vals":["0.0"]},{"idx":615,"ord":false,"vals":["0.0"]},{"idx":616,"ord":false,"vals":["0.0"]},{"idx":617,"ord":false,"vals":["0.0"]},{"idx":618,"ord":false,"vals":["0.0"]},{"idx":619,"ord":false,"vals":["0.0"]},{"idx":621,"ord":false,"vals":["0.0","82.0","236.0"]},{"idx":638,"ord":false,"vals":["0.0","1.0","29.0","137.0"]},{"idx":639,"ord":false,"vals":["0.0"]},{"idx":640,"ord":false,"vals":["0.0"]},{"idx":641,"ord":false,"vals":["0.0"]},{"idx":642,"ord":false,"vals":["0.0"]},{"idx":643,"ord":false,"vals":["0.0"]},{"idx":644,"ord":false,"vals":["0.0"]},{"idx":645,"ord":false,"vals":["0.0"]},{"idx":646,"ord":false,"vals":["0.0"]},{"idx":647,"ord":false,"vals":["0.0"]},{"idx":648,"ord":false,"vals":["0.0"]},{"idx":665,"ord":false,"vals":["0.0","25.0","71.0","173.0"]},{"idx":667,"ord":false,"vals":["0.0"]},{"idx":668,"ord":false,"vals":["0.0"]},{"idx":669,"ord":false,"vals":["0.0"]},{"idx":670,"ord":false,"vals":["0.0"]},{"idx":671,"ord":false,"vals":["0.0"]},{"idx":672,"ord":false,"vals":["0.0"]},{"idx":673,"ord":false,"vals":["0.0"]},{"idx":674,"ord":false,"vals":["0.0"]},{"idx":675,"ord":false,"vals":["0.0"]},{"idx":676,"ord":false,"vals":["0.0"]},{"idx":677,"ord":false,"vals":["0.0"]},{"idx":678,"ord":false,"vals":["0.0","37.0","40.0"]},{"idx":679,"ord":false,"vals":["0.0","239.0","251.0"]},{"idx":691,"ord":false,"vals":["0.0","36.0","73.0"]}]},"num_attrs":692}},"name":"indexedFeatures","nullable":true,"type":{"class":"org.apache.spark.ml.linalg.VectorUDT","pyClass":"pyspark.ml.linalg.VectorUDT","sqlType":{"fields":[{"metadata":{},"name":"type","nullable":false,"type":"byte"},{"metadata":{},"name":"size","nullable":true,"type":"integer"},{"metadata":{},"name":"indices","nullable":true,"type":{"containsNull":false,"elementType":"integer","type":"array"}},{"metadata":{},"name":"values","nullable":true,"type":{"containsNull":false,"elementType":"double","type":"array"}}],"type":"struct"},"type":"udt"}},{"metadata":{},"name":"rawPrediction","nullable":true,"type":{"class":"org.apache.spark.ml.linalg.VectorUDT","pyClass":"pyspark.ml.linalg.VectorUDT","sqlType":{"fields":[{"metadata":{},"name":"type","nullable":false,"type":"byte"},{"metadata":{},"name":"size","nullable":true,"type":"integer"},{"metadata":{},"name":"indices","nullable":true,"type":{"containsNull":false,"elementType":"integer","type":"array"}},{"metadata":{},"name":"values","nullable":true,"type":{"containsNull":false,"elementType":"double","type":"array"}}],"type":"struct"},"type":"udt"}},{"metadata":{},"name":"probability","nullable":true,"type":{"class":"org.apache.spark.ml.linalg.VectorUDT","pyClass":"pyspark.ml.linalg.VectorUDT","sqlType":{"fields":[{"metadata":{},"name":"type","nullable":false,"type":"byte"},{"metadata":{},"name":"size","nullable":true,"type":"integer"},{"metadata":{},"name":"indices","nullable":true,"type":{"containsNull":false,"elementType":"integer","type":"array"}},{"metadata":{},"name":"values","nullable":true,"type":{"containsNull":false,"elementType":"double","type":"array"}}],"type":"struct"},"type":"udt"}},{"metadata":{},"name":"prediction","nullable":false,"type":"double"}],"type":"struct"},"tableIdentifier":null}]},"errorSummary":"<span class=\"ansired\">AttributeError</span>: &apos;float&apos; object has no attribute &apos;show&apos;","error":"<div class=\"ansiout\"><span class=\"ansired\">---------------------------------------------------------------------------</span>\n<span class=\"ansired\">AttributeError</span>                            Traceback (most recent call last)\n<span class=\"ansigreen\">&lt;command-3535249741746106&gt;</span> in <span class=\"ansicyan\">&lt;module&gt;</span><span class=\"ansiblue\">()</span>\n<span class=\"ansigreen\">     36</span>     labelCol=&quot;indexedLabel&quot;, predictionCol=&quot;prediction&quot;, metricName=&quot;accuracy&quot;)\n<span class=\"ansigreen\">     37</span> accuracy <span class=\"ansiyellow\">=</span> evaluator<span class=\"ansiyellow\">.</span>evaluate<span class=\"ansiyellow\">(</span>predictions<span class=\"ansiyellow\">)</span><span class=\"ansiyellow\"></span>\n<span class=\"ansigreen\">---&gt; 38</span><span class=\"ansiyellow\"> </span><span class=\"ansigreen\">print</span> <span class=\"ansiyellow\">(</span><span class=\"ansiblue\">&quot;First 5:&quot;</span><span class=\"ansiyellow\">,</span> accuracy<span class=\"ansiyellow\">.</span>show<span class=\"ansiyellow\">(</span><span class=\"ansiyellow\">)</span><span class=\"ansiyellow\">)</span><span class=\"ansiyellow\"></span>\n<span class=\"ansigreen\">     39</span> <span class=\"ansigreen\">print</span><span class=\"ansiyellow\">(</span><span class=\"ansiblue\">&quot;Test Error = %g &quot;</span> <span class=\"ansiyellow\">%</span> <span class=\"ansiyellow\">(</span><span class=\"ansicyan\">1.0</span> <span class=\"ansiyellow\">-</span> accuracy<span class=\"ansiyellow\">)</span><span class=\"ansiyellow\">)</span><span class=\"ansiyellow\"></span>\n\n<span class=\"ansired\">AttributeError</span>: &apos;float&apos; object has no attribute &apos;show&apos;</div>","workflows":[],"startTime":1512140545809,"submitTime":1512140545799,"finishTime":1512140549678,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"c6c41553-9c23-490e-9aef-5848c1c49aa2"},{"version":"CommandV1","origId":3535249741746107,"guid":"b506fc1f-dbb2-4bcf-b16a-16d2c391c12e","subtype":"command","commandType":"auto","position":6.0,"command":"from pyspark.ml import Pipeline","commandVersion":0,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\"></div>","arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[]},"errorSummary":"<span class=\"ansired\">AttributeError</span>: &apos;module&apos; object has no attribute &apos;DecisionTreeClassifier&apos;","error":"<div class=\"ansiout\"><span class=\"ansired\">---------------------------------------------------------------------------</span>\n<span class=\"ansired\">AttributeError</span>                            Traceback (most recent call last)\n<span class=\"ansigreen\">&lt;command-3535249741746107&gt;</span> in <span class=\"ansicyan\">&lt;module&gt;</span><span class=\"ansiblue\">()</span>\n<span class=\"ansigreen\">      2</span> <span class=\"ansiyellow\"></span>\n<span class=\"ansigreen\">      3</span> parameters<span class=\"ansiyellow\">=</span><span class=\"ansiyellow\">{</span><span class=\"ansiblue\">&apos;min_samples_split&apos;</span> <span class=\"ansiyellow\">:</span> range<span class=\"ansiyellow\">(</span><span class=\"ansicyan\">10</span><span class=\"ansiyellow\">,</span><span class=\"ansicyan\">500</span><span class=\"ansiyellow\">,</span><span class=\"ansicyan\">20</span><span class=\"ansiyellow\">)</span><span class=\"ansiyellow\">,</span><span class=\"ansiblue\">&apos;max_depth&apos;</span><span class=\"ansiyellow\">:</span> range<span class=\"ansiyellow\">(</span><span class=\"ansicyan\">1</span><span class=\"ansiyellow\">,</span><span class=\"ansicyan\">20</span><span class=\"ansiyellow\">,</span><span class=\"ansicyan\">2</span><span class=\"ansiyellow\">)</span><span class=\"ansiyellow\">}</span><span class=\"ansiyellow\"></span>\n<span class=\"ansigreen\">----&gt; 4</span><span class=\"ansiyellow\"> </span>clf_tree<span class=\"ansiyellow\">=</span>tune<span class=\"ansiyellow\">.</span>DecisionTreeClassifier<span class=\"ansiyellow\">(</span><span class=\"ansiyellow\">)</span><span class=\"ansiyellow\"></span>\n<span class=\"ansigreen\">      5</span> clf<span class=\"ansiyellow\">=</span>grid_search<span class=\"ansiyellow\">.</span>GridSearchCV<span class=\"ansiyellow\">(</span>clf_tree<span class=\"ansiyellow\">,</span>parameters<span class=\"ansiyellow\">)</span><span class=\"ansiyellow\"></span>\n<span class=\"ansigreen\">      6</span> clf<span class=\"ansiyellow\">.</span>fit<span class=\"ansiyellow\">(</span>X<span class=\"ansiyellow\">,</span>Y<span class=\"ansiyellow\">)</span><span class=\"ansiyellow\"></span>\n\n<span class=\"ansired\">AttributeError</span>: &apos;module&apos; object has no attribute &apos;DecisionTreeClassifier&apos;</div>","workflows":[],"startTime":1512384327324,"submitTime":1512384286257,"finishTime":1512384327495,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"19e3f9e0-8b0a-4261-b8e5-c38da2bb576d"},{"version":"CommandV1","origId":3535249741746108,"guid":"e5190058-4f8a-44d2-98a9-dc344427d684","subtype":"command","commandType":"auto","position":7.0,"command":"from pyspark.ml import Pipeline\nfrom pyspark.ml.classification import GBTClassifier\nfrom pyspark.ml.feature import StringIndexer, VectorIndexer\nimport pyspark.ml.evaluation as ev\n\ndata = spark.read.format(\"libsvm\").load(\"/FileStore/tables/sample_libsvm_data.txt\")\n\n\nlabelIndexer = StringIndexer(inputCol=\"label\", outputCol=\"indexedLabel\").fit(data)\n\nfeatureIndexer =\\\n    VectorIndexer(inputCol=\"features\", outputCol=\"indexedFeatures\", maxCategories=4).fit(data)\n\n\n(trainingData, testData) = data.randomSplit([0.7, 0.3])\n\ngbt = GBTClassifier(labelCol=\"indexedLabel\", featuresCol=\"indexedFeatures\", maxIter=10)\npipeline = Pipeline(stages=[labelIndexer, featureIndexer, gbt])\nmodel = pipeline.fit(trainingData)\npredictions = model.transform(testData)\nevaluator = ev.MulticlassClassificationEvaluator(\n    labelCol=\"indexedLabel\", predictionCol=\"prediction\", metricName=\"accuracy\")\naccuracy = evaluator.evaluate(predictions)\nprint(\"Test Error = %g\" % (1.0 - accuracy))\n\ngbtModel = model.stages[2]\nprint(gbtModel)","commandVersion":0,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\">Test Error = 0.0571429\nGBTClassificationModel (uid=GBTClassifier_4d8497393f422febdcb7) with 10 trees\n</div>","arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[{"name":"data","typeStr":"pyspark.sql.dataframe.DataFrame","schema":{"fields":[{"metadata":{},"name":"label","nullable":true,"type":"double"},{"metadata":{"numFeatures":692},"name":"features","nullable":true,"type":{"class":"org.apache.spark.ml.linalg.VectorUDT","pyClass":"pyspark.ml.linalg.VectorUDT","sqlType":{"fields":[{"metadata":{},"name":"type","nullable":false,"type":"byte"},{"metadata":{},"name":"size","nullable":true,"type":"integer"},{"metadata":{},"name":"indices","nullable":true,"type":{"containsNull":false,"elementType":"integer","type":"array"}},{"metadata":{},"name":"values","nullable":true,"type":{"containsNull":false,"elementType":"double","type":"array"}}],"type":"struct"},"type":"udt"}}],"type":"struct"},"tableIdentifier":null},{"name":"trainingData","typeStr":"pyspark.sql.dataframe.DataFrame","schema":{"fields":[{"metadata":{},"name":"label","nullable":true,"type":"double"},{"metadata":{"numFeatures":692},"name":"features","nullable":true,"type":{"class":"org.apache.spark.ml.linalg.VectorUDT","pyClass":"pyspark.ml.linalg.VectorUDT","sqlType":{"fields":[{"metadata":{},"name":"type","nullable":false,"type":"byte"},{"metadata":{},"name":"size","nullable":true,"type":"integer"},{"metadata":{},"name":"indices","nullable":true,"type":{"containsNull":false,"elementType":"integer","type":"array"}},{"metadata":{},"name":"values","nullable":true,"type":{"containsNull":false,"elementType":"double","type":"array"}}],"type":"struct"},"type":"udt"}}],"type":"struct"},"tableIdentifier":null},{"name":"testData","typeStr":"pyspark.sql.dataframe.DataFrame","schema":{"fields":[{"metadata":{},"name":"label","nullable":true,"type":"double"},{"metadata":{"numFeatures":692},"name":"features","nullable":true,"type":{"class":"org.apache.spark.ml.linalg.VectorUDT","pyClass":"pyspark.ml.linalg.VectorUDT","sqlType":{"fields":[{"metadata":{},"name":"type","nullable":false,"type":"byte"},{"metadata":{},"name":"size","nullable":true,"type":"integer"},{"metadata":{},"name":"indices","nullable":true,"type":{"containsNull":false,"elementType":"integer","type":"array"}},{"metadata":{},"name":"values","nullable":true,"type":{"containsNull":false,"elementType":"double","type":"array"}}],"type":"struct"},"type":"udt"}}],"type":"struct"},"tableIdentifier":null},{"name":"predictions","typeStr":"pyspark.sql.dataframe.DataFrame","schema":{"fields":[{"metadata":{},"name":"label","nullable":true,"type":"double"},{"metadata":{"numFeatures":692},"name":"features","nullable":true,"type":{"class":"org.apache.spark.ml.linalg.VectorUDT","pyClass":"pyspark.ml.linalg.VectorUDT","sqlType":{"fields":[{"metadata":{},"name":"type","nullable":false,"type":"byte"},{"metadata":{},"name":"size","nullable":true,"type":"integer"},{"metadata":{},"name":"indices","nullable":true,"type":{"containsNull":false,"elementType":"integer","type":"array"}},{"metadata":{},"name":"values","nullable":true,"type":{"containsNull":false,"elementType":"double","type":"array"}}],"type":"struct"},"type":"udt"}},{"metadata":{"ml_attr":{"name":"indexedLabel","type":"nominal","vals":["1.0","0.0"]}},"name":"indexedLabel","nullable":false,"type":"double"},{"metadata":{"ml_attr":{"attrs":{"binary":[{"idx":95,"vals":["0.0","56.0"]},{"idx":96,"vals":["0.0","247.0"]},{"idx":119,"vals":["0.0","85.0"]},{"idx":120,"vals":["0.0","253.0"]},{"idx":146,"vals":["0.0","82.0"]},{"idx":147,"vals":["0.0","241.0"]},{"idx":163,"vals":["0.0","85.0"]},{"idx":164,"vals":["0.0","14.0"]},{"idx":174,"vals":["0.0","175.0"]},{"idx":191,"vals":["0.0","250.0"]},{"idx":192,"vals":["0.0","146.0"]},{"idx":220,"vals":["0.0","250.0"]},{"idx":229,"vals":["0.0","23.0"]},{"idx":396,"vals":["0.0","19.0"]},{"idx":592,"vals":["0.0","73.0"]},{"idx":614,"vals":["0.0","140.0"]},{"idx":620,"vals":["0.0","62.0"]},{"idx":649,"vals":["0.0","83.0"]},{"idx":666,"vals":["0.0","10.0"]}],"nominal":[{"idx":0,"ord":false,"vals":["0.0"]},{"idx":1,"ord":false,"vals":["0.0"]},{"idx":2,"ord":false,"vals":["0.0"]},{"idx":3,"ord":false,"vals":["0.0"]},{"idx":4,"ord":false,"vals":["0.0"]},{"idx":5,"ord":false,"vals":["0.0"]},{"idx":6,"ord":false,"vals":["0.0"]},{"idx":7,"ord":false,"vals":["0.0"]},{"idx":8,"ord":false,"vals":["0.0"]},{"idx":9,"ord":false,"vals":["0.0"]},{"idx":10,"ord":false,"vals":["0.0"]},{"idx":11,"ord":false,"vals":["0.0"]},{"idx":12,"ord":false,"vals":["0.0"]},{"idx":13,"ord":false,"vals":["0.0"]},{"idx":14,"ord":false,"vals":["0.0"]},{"idx":15,"ord":false,"vals":["0.0"]},{"idx":16,"ord":false,"vals":["0.0"]},{"idx":17,"ord":false,"vals":["0.0"]},{"idx":18,"ord":false,"vals":["0.0"]},{"idx":19,"ord":false,"vals":["0.0"]},{"idx":20,"ord":false,"vals":["0.0"]},{"idx":21,"ord":false,"vals":["0.0"]},{"idx":22,"ord":false,"vals":["0.0"]},{"idx":23,"ord":false,"vals":["0.0"]},{"idx":24,"ord":false,"vals":["0.0"]},{"idx":25,"ord":false,"vals":["0.0"]},{"idx":26,"ord":false,"vals":["0.0"]},{"idx":27,"ord":false,"vals":["0.0"]},{"idx":28,"ord":false,"vals":["0.0"]},{"idx":29,"ord":false,"vals":["0.0"]},{"idx":30,"ord":false,"vals":["0.0"]},{"idx":31,"ord":false,"vals":["0.0"]},{"idx":32,"ord":false,"vals":["0.0"]},{"idx":33,"ord":false,"vals":["0.0"]},{"idx":34,"ord":false,"vals":["0.0"]},{"idx":35,"ord":false,"vals":["0.0"]},{"idx":36,"ord":false,"vals":["0.0"]},{"idx":37,"ord":false,"vals":["0.0"]},{"idx":38,"ord":false,"vals":["0.0"]},{"idx":39,"ord":false,"vals":["0.0"]},{"idx":40,"ord":false,"vals":["0.0"]},{"idx":41,"ord":false,"vals":["0.0"]},{"idx":42,"ord":false,"vals":["0.0"]},{"idx":43,"ord":false,"vals":["0.0"]},{"idx":44,"ord":false,"vals":["0.0"]},{"idx":45,"ord":false,"vals":["0.0"]},{"idx":46,"ord":false,"vals":["0.0"]},{"idx":47,"ord":false,"vals":["0.0"]},{"idx":48,"ord":false,"vals":["0.0"]},{"idx":49,"ord":false,"vals":["0.0"]},{"idx":50,"ord":false,"vals":["0.0"]},{"idx":51,"ord":false,"vals":["0.0"]},{"idx":52,"ord":false,"vals":["0.0"]},{"idx":53,"ord":false,"vals":["0.0"]},{"idx":54,"ord":false,"vals":["0.0"]},{"idx":55,"ord":false,"vals":["0.0"]},{"idx":56,"ord":false,"vals":["0.0"]},{"idx":57,"ord":false,"vals":["0.0"]},{"idx":58,"ord":false,"vals":["0.0"]},{"idx":59,"ord":false,"vals":["0.0"]},{"idx":60,"ord":false,"vals":["0.0"]},{"idx":61,"ord":false,"vals":["0.0"]},{"idx":62,"ord":false,"vals":["0.0"]},{"idx":63,"ord":false,"vals":["0.0"]},{"idx":64,"ord":false,"vals":["0.0"]},{"idx":65,"ord":false,"vals":["0.0"]},{"idx":66,"ord":false,"vals":["0.0"]},{"idx":67,"ord":false,"vals":["0.0"]},{"idx":68,"ord":false,"vals":["0.0"]},{"idx":69,"ord":false,"vals":["0.0"]},{"idx":70,"ord":false,"vals":["0.0"]},{"idx":71,"ord":false,"vals":["0.0"]},{"idx":72,"ord":false,"vals":["0.0"]},{"idx":73,"ord":false,"vals":["0.0"]},{"idx":74,"ord":false,"vals":["0.0"]},{"idx":75,"ord":false,"vals":["0.0"]},{"idx":76,"ord":false,"vals":["0.0"]},{"idx":77,"ord":false,"vals":["0.0"]},{"idx":78,"ord":false,"vals":["0.0"]},{"idx":79,"ord":false,"vals":["0.0"]},{"idx":80,"ord":false,"vals":["0.0"]},{"idx":81,"ord":false,"vals":["0.0"]},{"idx":82,"ord":false,"vals":["0.0"]},{"idx":83,"ord":false,"vals":["0.0"]},{"idx":84,"ord":false,"vals":["0.0"]},{"idx":85,"ord":false,"vals":["0.0"]},{"idx":86,"ord":false,"vals":["0.0"]},{"idx":87,"ord":false,"vals":["0.0"]},{"idx":88,"ord":false,"vals":["0.0"]},{"idx":89,"ord":false,"vals":["0.0"]},{"idx":90,"ord":false,"vals":["0.0"]},{"idx":91,"ord":false,"vals":["0.0"]},{"idx":92,"ord":false,"vals":["0.0"]},{"idx":93,"ord":false,"vals":["0.0"]},{"idx":94,"ord":false,"vals":["0.0"]},{"idx":97,"ord":false,"vals":["0.0","64.0","121.0"]},{"idx":98,"ord":false,"vals":["0.0","70.0","191.0"]},{"idx":99,"ord":false,"vals":["0.0","70.0","166.0","255.0"]},{"idx":102,"ord":false,"vals":["0.0","5.0","72.0"]},{"idx":103,"ord":false,"vals":["0.0"]},{"idx":104,"ord":false,"vals":["0.0"]},{"idx":105,"ord":false,"vals":["0.0"]},{"idx":106,"ord":false,"vals":["0.0"]},{"idx":107,"ord":false,"vals":["0.0"]},{"idx":108,"ord":false,"vals":["0.0"]},{"idx":109,"ord":false,"vals":["0.0"]},{"idx":110,"ord":false,"vals":["0.0"]},{"idx":111,"ord":false,"vals":["0.0"]},{"idx":112,"ord":false,"vals":["0.0"]},{"idx":113,"ord":false,"vals":["0.0"]},{"idx":114,"ord":false,"vals":["0.0"]},{"idx":115,"ord":false,"vals":["0.0"]},{"idx":116,"ord":false,"vals":["0.0"]},{"idx":117,"ord":false,"vals":["0.0"]},{"idx":118,"ord":false,"vals":["0.0"]},{"idx":121,"ord":false,"vals":["0.0","63.0","132.0"]},{"idx":133,"ord":false,"vals":["0.0","9.0","18.0","52.0"]},{"idx":134,"ord":false,"vals":["0.0"]},{"idx":135,"ord":false,"vals":["0.0"]},{"idx":136,"ord":false,"vals":["0.0"]},{"idx":137,"ord":false,"vals":["0.0"]},{"idx":138,"ord":false,"vals":["0.0"]},{"idx":139,"ord":false,"vals":["0.0"]},{"idx":140,"ord":false,"vals":["0.0"]},{"idx":141,"ord":false,"vals":["0.0"]},{"idx":142,"ord":false,"vals":["0.0"]},{"idx":143,"ord":false,"vals":["0.0"]},{"idx":144,"ord":false,"vals":["0.0"]},{"idx":145,"ord":false,"vals":["0.0"]},{"idx":148,"ord":false,"vals":["0.0","71.0","251.0"]},{"idx":165,"ord":false,"vals":["0.0"]},{"idx":166,"ord":false,"vals":["0.0"]},{"idx":167,"ord":false,"vals":["0.0"]},{"idx":168,"ord":false,"vals":["0.0"]},{"idx":169,"ord":false,"vals":["0.0"]},{"idx":170,"ord":false,"vals":["0.0"]},{"idx":171,"ord":false,"vals":["0.0"]},{"idx":172,"ord":false,"vals":["0.0"]},{"idx":173,"ord":false,"vals":["0.0"]},{"idx":193,"ord":false,"vals":["0.0"]},{"idx":194,"ord":false,"vals":["0.0"]},{"idx":195,"ord":false,"vals":["0.0"]},{"idx":196,"ord":false,"vals":["0.0"]},{"idx":197,"ord":false,"vals":["0.0"]},{"idx":198,"ord":false,"vals":["0.0"]},{"idx":199,"ord":false,"vals":["0.0"]},{"idx":200,"ord":false,"vals":["0.0"]},{"idx":201,"ord":false,"vals":["0.0"]},{"idx":202,"ord":false,"vals":["0.0","13.0","44.0","87.0"]},{"idx":219,"ord":false,"vals":["0.0","18.0","20.0","250.0"]},{"idx":221,"ord":false,"vals":["0.0"]},{"idx":222,"ord":false,"vals":["0.0"]},{"idx":223,"ord":false,"vals":["0.0"]},{"idx":224,"ord":false,"vals":["0.0"]},{"idx":225,"ord":false,"vals":["0.0"]},{"idx":226,"ord":false,"vals":["0.0"]},{"idx":227,"ord":false,"vals":["0.0"]},{"idx":228,"ord":false,"vals":["0.0"]},{"idx":248,"ord":false,"vals":["0.0","13.0","250.0"]},{"idx":249,"ord":false,"vals":["0.0"]},{"idx":250,"ord":false,"vals":["0.0"]},{"idx":251,"ord":false,"vals":["0.0"]},{"idx":252,"ord":false,"vals":["0.0"]},{"idx":253,"ord":false,"vals":["0.0"]},{"idx":254,"ord":false,"vals":["0.0"]},{"idx":255,"ord":false,"vals":["0.0"]},{"idx":256,"ord":false,"vals":["0.0"]},{"idx":257,"ord":false,"vals":["0.0","73.0","120.0"]},{"idx":276,"ord":false,"vals":["0.0","3.0","153.0","252.0"]},{"idx":277,"ord":false,"vals":["0.0"]},{"idx":278,"ord":false,"vals":["0.0"]},{"idx":279,"ord":false,"vals":["0.0"]},{"idx":280,"ord":false,"vals":["0.0"]},{"idx":281,"ord":false,"vals":["0.0"]},{"idx":282,"ord":false,"vals":["0.0"]},{"idx":283,"ord":false,"vals":["0.0"]},{"idx":284,"ord":false,"vals":["0.0"]},{"idx":305,"ord":false,"vals":["0.0"]},{"idx":306,"ord":false,"vals":["0.0"]},{"idx":307,"ord":false,"vals":["0.0"]},{"idx":308,"ord":false,"vals":["0.0"]},{"idx":309,"ord":false,"vals":["0.0"]},{"idx":310,"ord":false,"vals":["0.0"]},{"idx":311,"ord":false,"vals":["0.0"]},{"idx":312,"ord":false,"vals":["0.0"]},{"idx":333,"ord":false,"vals":["0.0"]},{"idx":334,"ord":false,"vals":["0.0"]},{"idx":335,"ord":false,"vals":["0.0"]},{"idx":336,"ord":false,"vals":["0.0"]},{"idx":337,"ord":false,"vals":["0.0"]},{"idx":338,"ord":false,"vals":["0.0"]},{"idx":339,"ord":false,"vals":["0.0"]},{"idx":340,"ord":false,"vals":["0.0"]},{"idx":361,"ord":false,"vals":["0.0"]},{"idx":362,"ord":false,"vals":["0.0"]},{"idx":363,"ord":false,"vals":["0.0"]},{"idx":364,"ord":false,"vals":["0.0"]},{"idx":365,"ord":false,"vals":["0.0"]},{"idx":366,"ord":false,"vals":["0.0"]},{"idx":367,"ord":false,"vals":["0.0"]},{"idx":368,"ord":false,"vals":["0.0"]},{"idx":389,"ord":false,"vals":["0.0"]},{"idx":390,"ord":false,"vals":["0.0"]},{"idx":391,"ord":false,"vals":["0.0"]},{"idx":392,"ord":false,"vals":["0.0"]},{"idx":393,"ord":false,"vals":["0.0"]},{"idx":394,"ord":false,"vals":["0.0"]},{"idx":395,"ord":false,"vals":["0.0"]},{"idx":417,"ord":false,"vals":["0.0"]},{"idx":418,"ord":false,"vals":["0.0"]},{"idx":419,"ord":false,"vals":["0.0"]},{"idx":420,"ord":false,"vals":["0.0"]},{"idx":421,"ord":false,"vals":["0.0"]},{"idx":422,"ord":false,"vals":["0.0"]},{"idx":423,"ord":false,"vals":["0.0"]},{"idx":424,"ord":false,"vals":["0.0","5.0","29.0"]},{"idx":445,"ord":false,"vals":["0.0"]},{"idx":446,"ord":false,"vals":["0.0"]},{"idx":447,"ord":false,"vals":["0.0"]},{"idx":448,"ord":false,"vals":["0.0"]},{"idx":449,"ord":false,"vals":["0.0"]},{"idx":450,"ord":false,"vals":["0.0"]},{"idx":451,"ord":false,"vals":["0.0"]},{"idx":452,"ord":false,"vals":["0.0","24.0","29.0"]},{"idx":473,"ord":false,"vals":["0.0"]},{"idx":474,"ord":false,"vals":["0.0"]},{"idx":475,"ord":false,"vals":["0.0"]},{"idx":476,"ord":false,"vals":["0.0"]},{"idx":477,"ord":false,"vals":["0.0"]},{"idx":478,"ord":false,"vals":["0.0"]},{"idx":479,"ord":false,"vals":["0.0"]},{"idx":501,"ord":false,"vals":["0.0"]},{"idx":502,"ord":false,"vals":["0.0"]},{"idx":503,"ord":false,"vals":["0.0"]},{"idx":504,"ord":false,"vals":["0.0"]},{"idx":505,"ord":false,"vals":["0.0"]},{"idx":506,"ord":false,"vals":["0.0"]},{"idx":507,"ord":false,"vals":["0.0"]},{"idx":529,"ord":false,"vals":["0.0"]},{"idx":530,"ord":false,"vals":["0.0"]},{"idx":531,"ord":false,"vals":["0.0"]},{"idx":532,"ord":false,"vals":["0.0"]},{"idx":533,"ord":false,"vals":["0.0"]},{"idx":534,"ord":false,"vals":["0.0"]},{"idx":535,"ord":false,"vals":["0.0"]},{"idx":557,"ord":false,"vals":["0.0"]},{"idx":558,"ord":false,"vals":["0.0"]},{"idx":559,"ord":false,"vals":["0.0"]},{"idx":560,"ord":false,"vals":["0.0"]},{"idx":561,"ord":false,"vals":["0.0"]},{"idx":562,"ord":false,"vals":["0.0"]},{"idx":563,"ord":false,"vals":["0.0"]},{"idx":564,"ord":false,"vals":["0.0","9.0","20.0","73.0"]},{"idx":584,"ord":false,"vals":["0.0"]},{"idx":585,"ord":false,"vals":["0.0"]},{"idx":586,"ord":false,"vals":["0.0"]},{"idx":587,"ord":false,"vals":["0.0"]},{"idx":588,"ord":false,"vals":["0.0"]},{"idx":589,"ord":false,"vals":["0.0"]},{"idx":590,"ord":false,"vals":["0.0"]},{"idx":591,"ord":false,"vals":["0.0"]},{"idx":611,"ord":false,"vals":["0.0","19.0","20.0","29.0"]},{"idx":612,"ord":false,"vals":["0.0"]},{"idx":613,"ord":false,"vals":["0.0"]},{"idx":615,"ord":false,"vals":["0.0"]},{"idx":616,"ord":false,"vals":["0.0"]},{"idx":617,"ord":false,"vals":["0.0"]},{"idx":618,"ord":false,"vals":["0.0"]},{"idx":619,"ord":false,"vals":["0.0"]},{"idx":621,"ord":false,"vals":["0.0","82.0","236.0"]},{"idx":638,"ord":false,"vals":["0.0","1.0","29.0","137.0"]},{"idx":639,"ord":false,"vals":["0.0"]},{"idx":640,"ord":false,"vals":["0.0"]},{"idx":641,"ord":false,"vals":["0.0"]},{"idx":642,"ord":false,"vals":["0.0"]},{"idx":643,"ord":false,"vals":["0.0"]},{"idx":644,"ord":false,"vals":["0.0"]},{"idx":645,"ord":false,"vals":["0.0"]},{"idx":646,"ord":false,"vals":["0.0"]},{"idx":647,"ord":false,"vals":["0.0"]},{"idx":648,"ord":false,"vals":["0.0"]},{"idx":665,"ord":false,"vals":["0.0","25.0","71.0","173.0"]},{"idx":667,"ord":false,"vals":["0.0"]},{"idx":668,"ord":false,"vals":["0.0"]},{"idx":669,"ord":false,"vals":["0.0"]},{"idx":670,"ord":false,"vals":["0.0"]},{"idx":671,"ord":false,"vals":["0.0"]},{"idx":672,"ord":false,"vals":["0.0"]},{"idx":673,"ord":false,"vals":["0.0"]},{"idx":674,"ord":false,"vals":["0.0"]},{"idx":675,"ord":false,"vals":["0.0"]},{"idx":676,"ord":false,"vals":["0.0"]},{"idx":677,"ord":false,"vals":["0.0"]},{"idx":678,"ord":false,"vals":["0.0","37.0","40.0"]},{"idx":679,"ord":false,"vals":["0.0","239.0","251.0"]},{"idx":691,"ord":false,"vals":["0.0","36.0","73.0"]}]},"num_attrs":692}},"name":"indexedFeatures","nullable":true,"type":{"class":"org.apache.spark.ml.linalg.VectorUDT","pyClass":"pyspark.ml.linalg.VectorUDT","sqlType":{"fields":[{"metadata":{},"name":"type","nullable":false,"type":"byte"},{"metadata":{},"name":"size","nullable":true,"type":"integer"},{"metadata":{},"name":"indices","nullable":true,"type":{"containsNull":false,"elementType":"integer","type":"array"}},{"metadata":{},"name":"values","nullable":true,"type":{"containsNull":false,"elementType":"double","type":"array"}}],"type":"struct"},"type":"udt"}},{"metadata":{},"name":"rawPrediction","nullable":true,"type":{"class":"org.apache.spark.ml.linalg.VectorUDT","pyClass":"pyspark.ml.linalg.VectorUDT","sqlType":{"fields":[{"metadata":{},"name":"type","nullable":false,"type":"byte"},{"metadata":{},"name":"size","nullable":true,"type":"integer"},{"metadata":{},"name":"indices","nullable":true,"type":{"containsNull":false,"elementType":"integer","type":"array"}},{"metadata":{},"name":"values","nullable":true,"type":{"containsNull":false,"elementType":"double","type":"array"}}],"type":"struct"},"type":"udt"}},{"metadata":{},"name":"probability","nullable":true,"type":{"class":"org.apache.spark.ml.linalg.VectorUDT","pyClass":"pyspark.ml.linalg.VectorUDT","sqlType":{"fields":[{"metadata":{},"name":"type","nullable":false,"type":"byte"},{"metadata":{},"name":"size","nullable":true,"type":"integer"},{"metadata":{},"name":"indices","nullable":true,"type":{"containsNull":false,"elementType":"integer","type":"array"}},{"metadata":{},"name":"values","nullable":true,"type":{"containsNull":false,"elementType":"double","type":"array"}}],"type":"struct"},"type":"udt"}},{"metadata":{},"name":"prediction","nullable":false,"type":"double"}],"type":"struct"},"tableIdentifier":null}]},"errorSummary":"<span class=\"ansired\">IndexError</span>: list index out of range","error":"<div class=\"ansiout\"><span class=\"ansired\">---------------------------------------------------------------------------</span>\n<span class=\"ansired\">IndexError</span>                                Traceback (most recent call last)\n<span class=\"ansigreen\">&lt;command-3535249741746108&gt;</span> in <span class=\"ansicyan\">&lt;module&gt;</span><span class=\"ansiblue\">()</span>\n<span class=\"ansigreen\">     23</span> <span class=\"ansigreen\">print</span><span class=\"ansiyellow\">(</span><span class=\"ansiblue\">&quot;Test Error = %g&quot;</span> <span class=\"ansiyellow\">%</span> <span class=\"ansiyellow\">(</span><span class=\"ansicyan\">1.0</span> <span class=\"ansiyellow\">-</span> accuracy<span class=\"ansiyellow\">)</span><span class=\"ansiyellow\">)</span><span class=\"ansiyellow\"></span>\n<span class=\"ansigreen\">     24</span> <span class=\"ansiyellow\"></span>\n<span class=\"ansigreen\">---&gt; 25</span><span class=\"ansiyellow\"> </span>gbtModel <span class=\"ansiyellow\">=</span> model<span class=\"ansiyellow\">.</span>stages<span class=\"ansiyellow\">[</span><span class=\"ansicyan\">3</span><span class=\"ansiyellow\">]</span><span class=\"ansiyellow\"></span>\n<span class=\"ansigreen\">     26</span> <span class=\"ansigreen\">print</span><span class=\"ansiyellow\">(</span>gbtModel<span class=\"ansiyellow\">)</span><span class=\"ansiyellow\"></span>\n\n<span class=\"ansired\">IndexError</span>: list index out of range</div>","workflows":[],"startTime":1512384468865,"submitTime":1512384468851,"finishTime":1512384476185,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"0d3d078f-79d9-4472-9c2d-3b9ed1c56def"}],"dashboards":[],"guid":"fed3cd3d-82ae-4742-bd1c-147c1f86869c","globalVars":{},"iPythonMetadata":null,"inputWidgets":{}};</script>
<script
 src="https://databricks-prod-cloudfront.cloud.databricks.com/static/bc1c85971ad864da65b19d4f80abe81e111e7bfd8db9cac8f69dc1d94b874689/js/notebook-main.js"
 onerror="window.mainJsLoadError = true;"></script>
<script>var tableOfContentsCell = {"version":"CommandV1","origId":0,"guid":"2e789bf6-37bf-4749-8cf5-23522a6be7fe","subtype":"command","commandType":"auto","position":0.0,"command":"%md [&lsaquo; Back to Table of Contents](index.html)","commandVersion":1,"state":"finished","results":{"type":"raw","data":"","arguments":{}},"errorSummary":null,"error":null,"workflows":[],"startTime":0,"submitTime":0,"finishTime":0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{}};</script>
</head>
<body>
  <script>
if (window.mainJsLoadError) {
  var u = 'https://databricks-prod-cloudfront.cloud.databricks.com/static/bc1c85971ad864da65b19d4f80abe81e111e7bfd8db9cac8f69dc1d94b874689/js/notebook-main.js';
  var b = document.getElementsByTagName('body')[0];
  var c = document.createElement('div');
  c.innerHTML = ('<h1>Network Error</h1>' +
    '<p><b>Please check your network connection and try again.</b></p>' +
    '<p>Could not load a required resource: ' + u + '</p>');
  c.style.margin = '30px';
  c.style.padding = '20px 50px';
  c.style.backgroundColor = '#f5f5f5';
  c.style.borderRadius = '5px';
  b.appendChild(c);
}
</script>
</body>
</html>